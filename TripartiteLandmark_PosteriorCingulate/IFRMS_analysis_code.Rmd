---
title: "A new tripartite landmark in human posterior cingulate cortex"
output:
  word_document: default
  html_document:
    df_print: paged
  pdf_document: default
header-includes:
- \usepackage{caption}
- \captionsetup[table]{textfont={it}, labelfont={bf}, singlelinecheck=false, labelsep=newline}
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Analysis Notebook

This notebook contains analysis pipeline and figures for the manuscript: Willbrand et al. (2021): *A new tripartite landmark in human posterior cingulate cortex.* All data is available in the repository (*INSERT GITHUB LINK*). If you have any questions about data cleaning process, storage, or would like access to raw data please contact: Ethan Willbrand (ewillbrand@berkeley.edu) and/or Benjamin Parker (benparker@berkeley.edu).

## Software Requirements
* software: Please consult README.txt

## Data
* All data necessary for the analyses and figures is included in this repository
* Morphological data was extracted with FreeSurfer (see manuscript methods). A sample function to extract the sulcal metrics of interest from cortical surface reconstructions is included in a separate jupyter notebook in the github repository. Testing this requires access to a FreeSurfer directory. Please contact Ethan Willbrand (ewillbrand@berkeley.edu) and/or Benjamin Parker (benparker@berkeley.edu).

## Setup
### Relevant Libraries
```{r packages, echo = FALSE, warning = FALSE}
# data visualization 
library(ggplot2)
library(gt)
library(ggpubr)
library(reshape2)
library(tidyverse)
library(plot.matrix)

# colors for plots
library(RColorBrewer)
library(colorspace)
library(colorRamps)

# stats
library(psych)
library(RVAideMemoire)
library(car)
library(ggExtra)
library(afex)
library(emmeans)
library(rstatix)
```


```{r, echo=FALSE, warning = FALSE} 
# Extra features for data visualization
dodge <- position_dodge(width = .9)
theme_set(theme_classic())

# alter scientific notation
options(scipen=999) #turn off
#options(scipen=0) #turn on
```

# Morphological Analyses 
### Q1: Does the *ifrms* appear more consistently than other tertiary sulci in posterior cingulate cortex? 
* Chi squared tests to compare the incidence rates of the three tertiary sulci

#### Discovery sample
```{r, warning = FALSE}
# Discovery dataset
chi_discovery <- read.csv("~/Desktop/RMD_csvs/PCC_chisqrd_discovery.csv")
chi_discovery_tertiary <- chi_discovery %>% subset(sulcus %in% c("ifrms", "sspls", "icgs.p"))
chi_discovery_tertiary.ct <- xtabs(hemi~presence+sulcus, data = chi_discovery_tertiary)

## Run chi squared test
chi_discovery_tertiary.ct
chisq.test(chi_discovery_tertiary.ct) %>% broom::tidy(chisq.test(chi_discovery_tertiary.ct)) 

### post hoc pairwise comparisons
chisq.multcomp(chi_discovery_tertiary.ct) %>% broom::tidy(chisq.multcomp(chi_discovery_tertiary.ct))
```

##### Results for morphological analyses Q1 (discovery) 
Interestingly, even though the *ifrms* was present in all hemispheres, the incidence rates of the *icgs-p* and *sspls* significantly varied by hemisphere (X2 = 42.54, df = 2, p < 0.001). Post hoc pairwise comparisons revealed that there were specific differences between the *ifrms* and *sspls* (hemispheres with: p = 0.007, FDR correction), and the *ifrms* and *icgs-p* (hemispheres with: p = 0.008, FDR correction). See Figure 3b in the main text or in the plot below. 

#### Replication Sample 
```{r, warning = FALSE}
# Replication dataset
chi_replication <- read.csv("~/Desktop/RMD_csvs/PCC_chisqrd_replication.csv")
chi_replication_tertiary <- chi_replication %>% subset(sulcus %in% c("ifrms", "sspls", "icgs.p"))
chi_replication_tertiary.ct <- xtabs(hemi~presence+sulcus, data = chi_replication_tertiary)

# Chi squared test
chi_replication_tertiary.ct
chisq.test(chi_replication_tertiary.ct) %>% broom::tidy(chisq.test(chi_replication_tertiary.ct)) 

# Post hoc pairwise comparisons
chisq.multcomp(chi_replication_tertiary.ct) %>% broom::tidy(chisq.multcomp(chi_replication_tertiary.ct))
```

##### Results for morphological analyses Q1 (replication) 
Once again, the incidence rates of the *icgs-p* and *sspls* significantly varied by hemisphere (X2 = 45, df = 2, p < 0.001). Post hoc pairwise comparisons revealed that there were once more specific differences between the *ifrms* and *sspls* (hemispheres with: p = 0.003, FDR correction), and the *ifrms* and *icgs-p* (hemispheres with: p = 0.033, FDR correction). See Figure 3d in the main text or in the plot below.

### Figure 2b and 2d: Number of hemispheres with each PCC sulcus
```{r, warning = FALSE}
# Dataset - all
HCP_count_all <- read.csv("~/Desktop/RMD_csvs/HCP_count_all.csv")

# Discovery dataset 
HCP_count_disc <- HCP_count_all %>% subset(dataset == "discovery")
HCP_count_disc$Type <- factor(HCP_count_disc$Type, levels = c("none", "lh", "rh"))

# Plot
HCP_count_disc.plot <- ggplot(HCP_count_disc, aes(x = Sulcus)) +
  geom_col(data = HCP_count_disc, 
           aes(y = Amount, fill = Type),
           color = 'black',) + 
  xlim("pos", "spls", "mcgs", "sspls", "ifrms", "icgs-p") +
  scale_y_continuous(name = "number of hemispheres", seq(0,72,6), limits = c(0,72)) +
  labs(x = "PCC sulci", 
       y = "# of hemispheres") + 
  scale_fill_manual(breaks = c("lh", "rh", "none"),
                    values = c("#404040", "#bababa", "#ffffff")
                    ) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=18, face = "bold", vjust = .70), # was 20
        axis.title.y = element_text(size=18, face = "bold"), # was 20
        axis.text.x = element_text(size = 10, face = "bold", vjust = .70), # was 20
        axis.text.y = element_text(size = 10, face = "bold"), # was 20
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        legend.position="bottom", 
        strip.text.x = element_text(size = 10),
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) + 
  guides() 
HCP_count_disc.plot

# ggplot2::ggsave(filename = "sulc_count_disc.png",
#                 plot = HCP_count_disc.plot,
#                 device = "png",
#                 width = 10,
#                 height = 5,
#                 units = "in",
#                 dpi = "retina")


# Replication dataset
HCP_count_rep <- HCP_count_all %>% subset(dataset == "replication")
HCP_count_rep$Type <- factor(HCP_count_rep$Type, levels = c("none", "lh", "rh"))

# Plot
HCP_count_rep.plot <- ggplot(HCP_count_rep, aes(x = Sulcus)) +
  geom_col(data = HCP_count_rep, 
           aes(y = Amount, fill = Type),
           color = 'black') + 
  xlim("pos", "spls", "mcgs", "sspls", "ifrms", "icgs-p") +
  scale_y_continuous(name = "number of hemispheres", seq(0,72,6), limits = c(0,72)) +
  labs(x = "PCC sulci", 
       y = "# of hemispheres") + 
  scale_fill_manual(breaks = c("lh", "rh", "none"),
                    values = c("#404040", "#bababa", "#ffffff")
                    ) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=18, face = "bold", vjust = .70),  # was 20
        axis.title.y = element_text(size=18, face = "bold"), # was 20
        axis.text.x = element_text(size = 10, face = "bold", vjust = .70), # was 20
        axis.text.y = element_text(size = 10, face = "bold"), # was 20
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        legend.position="bottom", 
        strip.text.x = element_text(size = 10),
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) + 
  guides() 
HCP_count_rep.plot

# ggplot2::ggsave(filename = "sulc_count_rep.png",
#                 plot = HCP_count_rep.plot,
#                 device = "png",
#                 width = 10,
#                 height = 5,
#                 units = "in",
#                 dpi = "retina")
```

### Q2: Do the depths of the posterior cingulate cortex sulci differ from one another? 
* 2-way (sulcal label x hemi) ANOVA to test for differences in depth (mm)
* sulcal label: six PCC sulci (see Methods for description)
* hemi: lh, rh

#### Discovery Sample
```{r, warning = FALSE}
# Dataset - all
HCP_all_sulci_depth <- read.csv("~/Desktop/RMD_csvs/HCP_all_sulci_depth.csv")

# Filter for PCC sulci
HCP_tot_depth <- HCP_all_sulci_depth %>% subset(label 
                                                %in% c("pos", "spls", "mcgs", "sspls", "ifrms", "icgs-p"))

# Discovery dataset
HCP_disc_depth_PCC <- subset(HCP_tot_depth, subset = HCP_tot_depth$dataset == "HCP_discovery")

# ANOVA
discovery_depth2.aov <- aov(sulcal_depth_mm ~ hemi*label, data = HCP_disc_depth_PCC)
summary(discovery_depth2.aov)
rstatix::anova_summary(discovery_depth2.aov, effect.size = "ges") #Eta-squared

# Post hoc tests 
disc_depth.m1 <- emmeans::emmeans(discovery_depth2.aov,'label')
emmeans::contrast(disc_depth.m1, method='pairwise')

disc_depth.m2 <- emmeans::emmeans(discovery_depth2.aov, 'hemi')
emmeans::contrast(disc_depth.m2, method='pairwise')

disc_depth.i1 <- emmeans::emmeans(discovery_depth2.aov, ~ hemi | label)
emmeans::contrast(disc_depth.i1, method='pairwise')
```

##### Results for morphological analyses Q2 (discovery)
We observed a main effect of sulcus (F(5, 359) = 1323.08, p < 0.001, η2G = 0.95) and a main effect of hemisphere (F(1, 359) = 8.72, p = 0.003, η2G = 0.001), in which sulci were deeper in the left hemisphere (collapsing across sulci). Post hoc tests showed that, across hemispheres, the three tertiary sulci were all shallower than the primary/secondary sulci (p-values < 0.001, Tukey’s adjustment). Lastly, there was a sulcus x hemisphere interaction (F(1, 359) = 2.62, p = 0.024, η2G = 0.002). Here, post hoc tests revealed that the *spls* (p < 0.001, Tukey’s adjustment) and *mcgs* (p = 0.025, Tukey’s adjustment) were significantly deeper in the left hemisphere; this relationship was marginal for the *sspls* (p = 0.062, Tukey’s adjustment). Due to the fact that the consistent *ifrms* and two other less-consistent tertiary sulci are considerably shallower than the surrounding deeper and known primary/secondary sulci, we tentatively conclude that these newly defined, smaller indentations are tertiary sulci. See Figure 3c in the main text or in the plot below.

#### Replication Sample 
```{r, warning = FALSE}
# Replication dataset
HCP_rep_depth_PCC <- subset(HCP_tot_depth, subset = HCP_tot_depth$dataset == "HCP_replication")

# ANOVA
depth_replication2.aov <- aov(sulcal_depth_mm ~ hemi*label, data = HCP_rep_depth_PCC)
summary(depth_replication2.aov)
rstatix::anova_summary(depth_replication2.aov, effect.size = "ges") #Eta-squared


# Post hoc tests 
rep_depth.m1 <- emmeans::emmeans(depth_replication2.aov,'hemi')
emmeans::contrast(rep_depth.m1, method='pairwise')

rep_depth.m2 <- emmeans::emmeans(depth_replication2.aov,'label')
emmeans::contrast(rep_depth.m2, method='pairwise')

rep_depth.i1 <- emmeans::emmeans(depth_replication2.aov,'hemi','label')
emmeans::contrast(rep_depth.i1, method='pairwise')
```

##### Results for morphological analyses Q2 (replication)
Similar main effects of sulcus (F(1, 360) = 936.44, p < 0.001, η2G = 0.92) and hemisphere (F(1, 360) = 11.2, p < 0.001, η2G = 0.002) were observed in the replication sample. Once again, when collapsing across sulci, sulci in the left hemisphere were deeper. Post hoc tests confirmed again that the tertiary sulci were much shallower than the surrounding non-tertiary sulci (p-values < 0.001, Tukey’s adjustment). Furthermore, there was a sulcus x hemisphere interaction (F(1, 360) = 3.94, p = 0.002, η2G = 0.004). Here, post hoc tests showed that the *pos* was significantly deeper in the right hemisphere than left (p = 0.017, Tukey’s adjustment), while the *mcgs* and *spls* were again significantly deeper in the left than right hemisphere (*mcgs*: p = 0.001; *spls*: p = 0.021, Tukey’s adjustment). For the *sspls*, this relationship was marginally significant (p = 0.055, Tukey’s adjustment). All in all, the main findings in the discovery dataset were replicated in this second sample. See Figure 3e in the main text or in the plot below.

### Figure 2c & 2e: Depth of PCC Sulci
```{r, warning = FALSE}
# Discovery (Figure 2c)

# Plot features - mean & other aspects
HCP_tot_depth_tert_disc <- HCP_disc_depth_PCC %>% subset(label %in% c("sspls", "ifrms", "icgs-p"))

HCP_tert_depth_means_disc <- HCP_tot_depth_tert_disc %>% 
  group_by(label, label2) %>% 
  summarise(sulcal_depth_mm = mean(sulcal_depth_mm))
HCP_tert_depth_sd_disc <- HCP_tot_depth_tert_disc %>% 
  group_by(label, label2) %>% 
  summarise(sd = sd(sulcal_depth_mm),
            n = n(),
            se = sd/sqrt(n))
HCP_tert_stats_disc <- merge(HCP_tert_depth_means_disc, HCP_tert_depth_sd_disc, by = c("label", "label2"))

HCP_tot_depth_ntert_disc <- HCP_disc_depth_PCC %>% subset(label %in% c("pos", "spls", "mcgs"))

HCP_n_depth_means_disc <- HCP_tot_depth_ntert_disc %>% 
  group_by(label, label2) %>% 
  summarise(sulcal_depth_mm = mean(sulcal_depth_mm))
HCP_n_depth_sd_disc <- HCP_tot_depth_ntert_disc %>% 
  group_by(label, label2) %>% 
  summarise(sd = sd(sulcal_depth_mm),
            n = n(),
            se = sd/sqrt(n))

HCP_n_stats_disc <- merge(HCP_n_depth_means_disc, HCP_n_depth_sd_disc, by = c("label", "label2"))

# Plot
depth_y <- expression(paste(bold("sulcal depth "), italic("(mm)")))

PCC_depth_disc.plot <- ggplot() +
  geom_violin(data = HCP_tot_depth_tert_disc, 
              aes(x = label, y = sulcal_depth_mm, fill = label2), 
              alpha = .6, position = dodge, width = 1.2) + 
  geom_jitter(data = HCP_tot_depth_tert_disc, 
              aes(x = label, y = sulcal_depth_mm, fill = label2, color = label2), 
              alpha = .8, shape = 21,
              position=position_jitterdodge(jitter.width = .3, dodge.width = .9, jitter.height = 0)) +
  geom_pointrange(data = HCP_tert_stats_disc, 
                  aes(label, sulcal_depth_mm, ymin=sulcal_depth_mm-sd, ymax=sulcal_depth_mm+sd, fill = label2), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
  
  geom_violin(data = HCP_tot_depth_ntert_disc, 
              aes(x = label, y = sulcal_depth_mm, fill = label2), 
              alpha = .6, position = dodge, width = 1.1) + 
  geom_jitter(data = HCP_tot_depth_ntert_disc, 
              aes(x = label, y = sulcal_depth_mm, fill = label2, color = label2), 
              alpha = .8, shape = 21,
              position=position_jitterdodge(jitter.width = .3, 
                                            dodge.width = .9, 
                                            jitter.height = 0)) +
  geom_pointrange(data = HCP_n_stats_disc, 
                  aes(label, sulcal_depth_mm, ymin=sulcal_depth_mm-sd, ymax=sulcal_depth_mm+sd, fill = label2), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
  xlim("pos","spls", "mcgs", "sspls", "ifrms", "icgs-p") +
  guides(fill = FALSE, color = FALSE) +
  scale_color_manual(breaks = 
                       c("POS LH", "POS RH",
                         "spls LH", "spls RH",
                         "MCGS LH", "MCGS RH",
                         "sspls LH", "sspls RH",
                         "ifrms LH", "ifrms RH",
                         "icgs-p LH", "icgs-p RH"),
                     values = c( "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363")) + 
  scale_fill_manual(breaks = c("POS LH", "POS RH",
                               "spls LH", "spls RH",
                               "MCGS LH", "MCGS RH",
    "sspls LH", "sspls RH",
    "ifrms LH", "ifrms RH",
    "icgs-p LH", "icgs-p RH"),
    values = c("#6a51a3", "#807dba", #POS
               "#238b45", "#74c476", #spls
               "#2c7fb8", "#41b6c4", #mcgs
      "chartreuse4", "chartreuse", #sspls
      "firebrick", "#ef3b2c", #ifrms
      "cadetblue", "cadetblue1")) + #icgs-p
  labs(x = "PCC sulci",
       y = depth_y) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=20, face = "bold"),
        axis.text.x = element_text(size = 12, face = "bold", vjust = .70), # was 20
        axis.text.y = element_text(size = 15, face = "bold"), # was 20
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        strip.text.x = element_text(size = 10),
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  scale_y_continuous(breaks=seq(0,26,2), limits = c(0,26))
PCC_depth_disc.plot

# ggplot2::ggsave(filename = "PCC_depth_disc_plot.png",
#                 plot = PCC_depth_disc.plot,
#                 device = "png",
#                 width = 10,
#                 height = 5, 
#                 units = "in",
#                 dpi = "retina")


# Replication (Figure 2e)

# Plot features - mean & other aspects
HCP_tot_depth_tert_rep <- HCP_rep_depth_PCC %>% subset(label %in% c("sspls", "ifrms", "icgs-p"))

HCP_tert_depth_means_rep <- HCP_tot_depth_tert_rep %>% 
  group_by(label, label2) %>% 
  summarise(sulcal_depth_mm = mean(sulcal_depth_mm))
HCP_tert_depth_sd_rep <- HCP_tot_depth_tert_rep %>% 
  group_by(label, label2) %>% 
  summarise(sd = sd(sulcal_depth_mm),
            n = n(),
            se = sd/sqrt(n))

HCP_tert_stats_rep <- merge(HCP_tert_depth_means_rep, HCP_tert_depth_sd_rep, by = c("label", "label2"))

HCP_tot_depth_ntert_rep <- HCP_rep_depth_PCC %>% subset(label %in% c("pos", "spls", "mcgs"))

HCP_n_depth_means_rep <- HCP_tot_depth_ntert_rep %>% 
  group_by(label, label2) %>% 
  summarise(sulcal_depth_mm = mean(sulcal_depth_mm))
HCP_n_depth_sd_rep <- HCP_tot_depth_ntert_rep %>% 
  group_by(label, label2) %>% 
  summarise(sd = sd(sulcal_depth_mm),
            n = n(),
            se = sd/sqrt(n))

HCP_n_stats_rep <- merge(HCP_n_depth_means_rep, HCP_n_depth_sd_rep, by = c("label", "label2"))

# Plot
depth_y <- expression(paste(bold("sulcal depth "), italic("(mm)")))

PCC_depth_rep.plot <- ggplot() +
  geom_violin(data = HCP_tot_depth_tert_rep, 
              aes(x = label, y = sulcal_depth_mm, fill = label2), 
              alpha = .6, position = dodge, width = 1.2) + 
  geom_jitter(data = HCP_tot_depth_tert_rep, 
              aes(x = label, y = sulcal_depth_mm, fill = label2, color = label2), 
              alpha = .8, shape = 21,
              position=position_jitterdodge(jitter.width = .3, dodge.width = .9, jitter.height = 0)) +
  geom_pointrange(data = HCP_tert_stats_rep, 
                  aes(label, sulcal_depth_mm, ymin=sulcal_depth_mm-sd, ymax=sulcal_depth_mm+sd, fill = label2), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
  
  geom_violin(data = HCP_tot_depth_ntert_rep, 
              aes(x = label, y = sulcal_depth_mm, fill = label2), 
              alpha = .6, position = dodge, width = 1) + 
  geom_jitter(data = HCP_tot_depth_ntert_rep, 
              aes(x = label, y = sulcal_depth_mm, fill = label2, color = label2), 
              alpha = .8, shape = 21,
              position=position_jitterdodge(jitter.width = .3, 
                                            dodge.width = .9, 
                                            jitter.height = 0)) +
  geom_pointrange(data = HCP_n_stats_rep, 
                  aes(label, sulcal_depth_mm, ymin=sulcal_depth_mm-sd, ymax=sulcal_depth_mm+sd, fill = label2), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
  xlim("pos","spls", "mcgs", "sspls", "ifrms", "icgs-p") +
  guides(fill = FALSE, color = FALSE) +
  scale_color_manual(breaks = 
                       c("POS LH", "POS RH",
                         "spls LH", "spls RH",
                         "MCGS LH", "MCGS RH",
                         "sspls LH", "sspls RH",
                         "ifrms LH", "ifrms RH",
                         "icgs-p LH", "icgs-p RH"),
                     values = c( "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363")) + 
  scale_fill_manual(breaks = c("POS LH", "POS RH",
                               "spls LH", "spls RH",
                               "MCGS LH", "MCGS RH",
    "sspls LH", "sspls RH",
    "ifrms LH", "ifrms RH",
    "icgs-p LH", "icgs-p RH"),
    values = c("#6a51a3", "#807dba", #POS
               "#238b45", "#74c476", #spls
               "#2c7fb8", "#41b6c4", #mcgs
      "chartreuse4", "chartreuse", #sspls
      "firebrick", "#ef3b2c", #ifrms
      "cadetblue", "cadetblue1")) + #icgs-p
  labs(x = "PCC sulci",
       y = depth_y) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=20, face = "bold"),
        axis.text.x = element_text(size = 12, face = "bold", vjust = .70), # was 20
        axis.text.y = element_text(size = 15, face = "bold"), # was 20
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        strip.text.x = element_text(size = 10),
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  scale_y_continuous(breaks=seq(0,26,2), limits = c(0,26))
PCC_depth_rep.plot

# ggplot2::ggsave(filename = "PCC_depth_disc_plot.png",
#                 plot = PCC_depth_disc.plot,
#                 device = "png",
#                 width = 10,
#                 height = 5, 
#                 units = "in",
#                 dpi = "retina")
```

### Q3: Does the ratio between cortical thickness and myelination (C/M) differ between the *ifrms* and other tertiary or primary sulci?
* 3-way (sulc_type x ant_post x hemi) ANOVA to test for differences in the C/M ratio
* sulc_type: primary (*mcgs*/*spls*), tertiary (*ifrms*/*sspls*) 
* ant_post: anterior (*mcgs*/*ifrms*), posterior (*spls*/*sspls*) - note: identifies whether sulcus is in anterior PCC or posterior PCC
* hemi: lh, rh

#### Discovery Sample
```{r, warning = FALSE}
# Dataset - all
HCP_tot_analysis <- read.csv("~/Desktop/RMD_csvs/HCP_PCC_ctmy_analysis.csv")

# Discovery dataset
discovery_PCC_analysis <- HCP_tot_analysis %>% subset(dataset=="HCP_discovery")

# ANOVA
discovery_ratio_loc.aov <- aov(ratio ~ sulc_type * ant_post * hemi, data = discovery_PCC_analysis)
summary(discovery_ratio_loc.aov) #p-values
rstatix::anova_summary(discovery_ratio_loc.aov, effect.size = "ges") #Eta-squared

# Post hoc tests
disc_ratio.m1 <- emmeans::emmeans(discovery_ratio_loc.aov, ~ sulc_type)
emmeans::contrast(disc_ratio.m1, method='pairwise')

disc_ratio.i1 <- emmeans::emmeans(discovery_ratio_loc.aov, ~ sulc_type | ant_post)
emmeans::contrast(disc_ratio.i1, method='pairwise')
```

##### Results for morphological analyses Q3 (discovery)
We observed a main effect of sulcal type (F(1, 249) = 526.4, p < 0.001, η2G = 0.57), in which the tertiary sulci (*sspls* and *ifrms*) had a larger thickness/myelination ratio (i.e., were thicker and less myelinated) than the primary/secondary sulci (*spls* and *mcgs*) regardless of the hemisphere. Building on this difference, there was a sulcal type x position interaction (F(1, 249) = 142.14, p < 0.001, η2G = 0.15). Here, post hoc analyses showed that the difference in the ratio was much greater (p-values < 0.001, Tukey’s adjustment) between the primary/secondary and tertiary sulci in anterior PCC (*mcgs* and *ifrms*) compared to the primary/secondary and tertiary sulci in posterior PCC (*spls* and *sspls*) across hemispheres. See Figure 4b in the main text or in the plot below.

#### Replication Sample
```{r, warning = FALSE}
# Replication dataset
replication_PCC_analysis <- HCP_tot_analysis %>% subset(dataset=="HCP_replication")

# ANOVA
replication_ratio_loc.aov <- aov(ratio ~ sulc_type * ant_post * hemi, data = replication_PCC_analysis)
summary(replication_ratio_loc.aov) #p-values
rstatix::anova_summary(replication_ratio_loc.aov, effect.size = "ges") #Eta-squared

# Post hoc tests
rep_ratio.m1 <- emmeans::emmeans(replication_ratio_loc.aov, ~ sulc_type)
emmeans::contrast(rep_ratio.m1, method='pairwise')

rep_ratio.i1 <- emmeans::emmeans(replication_ratio_loc.aov, ~ sulc_type | ant_post)
emmeans::contrast(rep_ratio.i1, method='pairwise')
```

##### Results for morphological analyses Q3 (replication)
The effects observed in the discovery sample were confirmed in the replication sample. There was a main effect of sulcal type (F(1, 245) = 682.92, p < 0.001, η2G = 0.61) - in which the tertiary sulci had a larger thickness/myelination ratio than the primary/secondary sulci - and a sulcal type x position interaction (F(1, 245) = 186.6, p < 0.001, η2G = 0.17). There were also similar post hoc results for the latter effect (p-values < 0.001, Tukey’s adjustment), in which the differences in the thickness/myelination ratio between the primary/secondary and tertiary sulci based on their position along an anterior-posterior axis were also present. Across both samples and hemispheres, the ifrms had the greatest thickness/myelination ratio in PCC. See Figure 4b in the main text or in the plot below.

#### Discovery - separate statistical analysis of the cortical thickness and myelination of PCC sulci
```{r, warning = FALSE}
# Discovery dataset

# compare cortical thickness and myelination of sulci separate (not as ratio)

# ANOVA - cortical thickness
discovery_ct_alone.aov <- aov(cortical_thickness_mean ~ hemi*label, data = discovery_PCC_analysis)
summary(discovery_ct_alone.aov) #p-values
rstatix::anova_summary(discovery_ct_alone.aov, effect.size = "ges") #Eta-squared

# Post hoc test
disc_ct.m1 <- emmeans::emmeans(discovery_ct_alone.aov, ~ label)
emmeans::contrast(disc_ct.m1, method='pairwise')

# ANOVA - myelination
discovery_my_alone.aov <- aov(myelin ~ hemi*label, data = discovery_PCC_analysis)
summary(discovery_my_alone.aov) #p-values
rstatix::anova_summary(discovery_my_alone.aov, effect.size = "ges") #Eta-squared

# Post hoc tests
disc_my.m1 <- emmeans::emmeans(discovery_my_alone.aov, ~ label)
emmeans::contrast(disc_my.m1, method='pairwise')

disc_my.i1 <- emmeans::emmeans(discovery_my_alone.aov, ~ hemi | label)
emmeans::contrast(disc_my.i1, method='pairwise')
```
Running separate ANOVAs for cortical thickness and myelination confirmed the C/M ratio findings - the *ifrms* is the thickest and one of the lesser myelinated sulci in PCC. 

#### Replication - separate statistical analysis of cortical thickness and myelination of PCC sulci
```{r, warning = FALSE}
# Replication dataset

# compare cortical thickness and myelination of sulci separate (not as ratio)

# ANOVA - cortical thickness
replication_ct_alone.aov <- aov(cortical_thickness_mean ~ hemi*label, data = replication_PCC_analysis)
summary(replication_ct_alone.aov) #p-values
rstatix::anova_summary(replication_ct_alone.aov, effect.size = "ges") #Eta-squared

# Post hoc test
rep_ct.m1 <- emmeans::emmeans(replication_ct_alone.aov, ~ label)
emmeans::contrast(rep_ct.m1, method='pairwise')

# ANOVA - myelination
replication_my_alone.aov <- aov(myelin ~ hemi*label, data = replication_PCC_analysis)
summary(replication_my_alone.aov) #p-values
rstatix::anova_summary(replication_my_alone.aov, effect.size = "ges") #Eta-squared

# Post hoc tests
rep_my.m1 <- emmeans::emmeans(replication_my_alone.aov, ~ label)
emmeans::contrast(rep_my.m1, method='pairwise')

rep_my.i1 <- emmeans::emmeans(replication_my_alone.aov, ~ hemi | label)
emmeans::contrast(rep_my.i1, method='pairwise')

```
The findings in the discovery sample are confirmed in the replication sample. 

#### Correlations between the depth of the ifrms and C/M ratio, as well as cortical thickness and myelation
```{r}
# Discovery
cor.d <- merge(discovery_PCC_analysis, HCP_disc_depth_PCC, by = c('sub', 'hemi', 'label', 'dataset'))

test.d.ifrms.lh <- cor.d %>% subset(dataset == "HCP_discovery" & label == "ifrms" & hemi == "lh")
test.d.ifrms.rh <- cor.d %>% subset(dataset == "HCP_discovery" & label == "ifrms" & hemi == "rh")

## Correlations between ifrms sulcal depth ~ ratio & cortical thickness ~ myelination
cor.test(x = test.d.ifrms.lh$sulcal_depth_mm, y = test.d.ifrms.lh$ratio) 
cor.test(x = test.d.ifrms.lh$myelin, y = test.d.ifrms.lh$cortical_thickness_mean) 

## Correlations between ifrms cortical thickness ~ myelination 
cor.test(x = test.d.ifrms.rh$sulcal_depth_mm, y = test.d.ifrms.rh$ratio) 
cor.test(x = test.d.ifrms.rh$myelin, y = test.d.ifrms.rh$cortical_thickness_mean) 

# Replication
cor.r <- merge(replication_PCC_analysis, HCP_rep_depth_PCC, by = c('sub', 'hemi', 'label', 'dataset'))

## Correlations between ifrms sulcal depth ~ ratio 
test.r.ifrms.lh <- cor.r %>% subset(dataset == "HCP_replication" & label == "ifrms" & hemi == "lh")
test.r.ifrms.rh <- cor.r %>% subset(dataset == "HCP_replication" & label == "ifrms" & hemi == "rh")

cor.test(x = test.r.ifrms.lh$sulcal_depth_mm, y = test.r.ifrms.lh$ratio) 
cor.test(x = test.r.ifrms.rh$sulcal_depth_mm, y = test.r.ifrms.rh$ratio) 

## Correlations between ifrms cortical thickness ~ myelination 
cor.test(x = test.r.ifrms.lh$myelin, y = test.r.ifrms.lh$cortical_thickness_mean) 
cor.test(x = test.r.ifrms.rh$myelin, y = test.r.ifrms.rh$cortical_thickness_mean)

### FDR correction for multiple comparisons
p.vales <- c(0.5015, 0.06028, 0.04378, 0.2393, 0.7098, 0.3353, 0.0003473, 0.06233)
p.adjust(p = p.vales,
  method = "fdr")
```
Only the correlation between depth and ratio in the right hemisphere of the replication sample remained significant. 

#### Figure 3b: C/M ratio of PCC sulci
```{r, warning = FALSE}
# Feature for plot
HCP_tot_analysis <- HCP_tot_analysis %>% mutate(label_dataset = 
                              case_when(label == "pos" & dataset == "HCP_discovery" ~ "POS d", 
                              label == "pos" & dataset == "HCP_replication" ~ "POS r",
                              label == "spls" & dataset == "HCP_discovery" ~ "spls d", 
                              label == "spls" & dataset == "HCP_replication" ~ "spls r",
                              label == "mcgs" & dataset == "HCP_discovery" ~ "MCGS d", 
                              label == "mcgs" & dataset == "HCP_replication" ~ "MCGS r",
                              label == "sspls" & dataset == "HCP_discovery" ~ "sspls d", 
                              label == "sspls" & dataset == "HCP_replication" ~ "sspls r",
                              label == "ifrms" & dataset == "HCP_discovery" ~ "ifrms d", 
                              label == "ifrms" & dataset == "HCP_replication" ~ "ifrms r",                                       
                              label == "icgs-p" & dataset == "HCP_discovery" ~ "icgs-p d",
                              label == "icgs-p" & dataset == "HCP_replication" ~ "icgs-p r"))

# Left hemisphere C/M plot

# Means for plot
HCP_tot_analysis_lh <- HCP_tot_analysis %>% subset(hemi == "lh")
HCP_tot_analysis_rh <- HCP_tot_analysis %>% subset(hemi == "rh")

HCP_tot_analysis_lh_mean <- HCP_tot_analysis_lh %>% 
  group_by(label, label_dataset) %>% 
  summarise(ratio = mean(ratio))
HCP_tot_analysis_lh_sd <- HCP_tot_analysis_lh %>% 
  group_by(label, label_dataset) %>% 
  summarise(sd = sd(ratio))
HCP_tot_analysis_lh_stats <- merge(HCP_tot_analysis_lh_mean, HCP_tot_analysis_lh_sd, by = c("label", "label_dataset"))

# Features for plot
HCP_tot_analysis_lh_stats$label <- factor(HCP_tot_analysis_lh_stats$label, levels = c("spls", "sspls", "mcgs", "ifrms"))

HCP_tot_analysis_lh_stats$label_dataset <- factor(HCP_tot_analysis_lh_stats$label_dataset, levels = c("sspls d", "sspls r", "MCGS d", "MCGS r", "spls d", "spls r", "ifrms d", "ifrms r"))

HCP_tot_analysis_lh$label <- factor(HCP_tot_analysis_lh$label, levels = c("spls", "sspls", "mcgs", "ifrms"))

HCP_tot_analysis_lh$label_dataset <- factor(HCP_tot_analysis_lh$label_dataset, levels = c("sspls d", "sspls r", "MCGS d", "MCGS r", "spls d", "spls r", "ifrms d", "ifrms r"))

# Plot
ratio_axis <- expression(paste(bold("thickness/myelination ratio")))

ctmy_lh.plot <- ggplot(HCP_tot_analysis_lh, aes(x = label_dataset, fill = label_dataset)) + 
  geom_violin(aes(y = ratio), size = .8, alpha = 0.6) + 
  geom_jitter(aes(y = ratio), 
              shape = 21, color = 'black', alpha = .8,
              position=position_jitterdodge(jitter.width = 1.5, 
                                            dodge.width = .5, jitter.height = 0)) + 
  geom_pointrange(data = HCP_tot_analysis_lh_stats, 
                  aes(label_dataset, ratio, ymin=ratio-sd, ymax=ratio+sd, 
                      fill = label_dataset), 
                  shape = 21, size = 1, fatten = 4) +
  scale_x_discrete(breaks = c("spls d", "spls r", 
                              "sspls d", "sspls r", 
                              "MCGS d", "MCGS r", 
                              "ifrms d", "ifrms r"), 
                   labels = c(
                              "disc", "repl",
                              "disc", "repl", 
                              "disc", "repl",
                              "disc", "repl")) +
  scale_fill_manual(breaks = c("spls d", "spls r", 
                               "sspls d", "sspls r", 
                               "MCGS d", "MCGS r", 
                               "ifrms d", "ifrms r"),
                    values = c( "#238b45", "#74c476", 
      "chartreuse4", "chartreuse", 
      "#2c7fb8", "#41b6c4",
      "firebrick", "#ef3b2c")) +
  scale_color_manual(breaks = c("spls d", "spls r", 
                                "sspls d", "sspls r", 
                                "MCGS d", "MCGS r", 
                                "ifrms d", "ifrms r"),
                    values = c("#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363")) +
  labs(x = "PCC sulci",
       y = ratio_axis) + 
  guides(fill = F, color = F, alpha = F) +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
          plot.subtitle = element_text(size = 12),
          plot.caption = element_text(size = 12, hjust = 1),
          axis.title.x = element_text(size=18, face = "bold", vjust = .9),
          axis.title.y = element_text(size=18, face = "bold", vjust = .9), # was 20
          axis.title.y.right = element_text(size=20, face = "bold", vjust = 1),
          axis.text.x = element_text(size = 11, face = "bold", vjust = .70), # was 20
          axis.text.y = element_text(size = 11, face = "bold"), # was 20
          legend.title = element_text(size=14), 
          legend.text = element_text(size=12),
          strip.text.x = element_text(size = 18, face = "bold"), # was 20
          strip.background = element_blank(),
          strip.placement = "outside",
          axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  facet_wrap( ~ label, strip.position = "bottom", scales = "free_x", ncol = 4)
ctmy_lh.plot

# ggplot2::ggsave(filename = "ctmy_lh_plot.png",
#                  plot = ctmy_lh.plot,
#                  device = "png",
#                  width = 12,
#                  height = 5, 
#                  units = "in",
#                  dpi = "retina")


# Left hemisphere C/M plot

# Means for plot
HCP_tot_analysis_rh_mean <- HCP_tot_analysis_rh %>% 
  group_by(label, label_dataset) %>% 
  summarise(ratio = mean(ratio))
HCP_tot_analysis_rh_sd <- HCP_tot_analysis_rh %>% 
  group_by(label, label_dataset) %>% 
  summarise(sd = sd(ratio))
HCP_tot_analysis_rh_stats <- merge(HCP_tot_analysis_rh_mean, HCP_tot_analysis_rh_sd, by = c("label", "label_dataset"))

# Features for plot
HCP_tot_analysis_rh_stats$label <- factor(HCP_tot_analysis_rh_stats$label, levels = c("spls", "sspls", "mcgs", "ifrms"))

HCP_tot_analysis_rh_stats$label_dataset <- factor(HCP_tot_analysis_rh_stats$label_dataset, levels = c("sspls d", "sspls r", "MCGS d", "MCGS r", "spls d", "spls r", "ifrms d", "ifrms r"))

HCP_tot_analysis_rh$label <- factor(HCP_tot_analysis_rh$label, levels = c("spls", "sspls", "mcgs", "ifrms"))

HCP_tot_analysis_rh$label_dataset <- factor(HCP_tot_analysis_rh$label_dataset, levels = c("sspls d", "sspls r", "MCGS d", "MCGS r", "spls d", "spls r", "ifrms d", "ifrms r"))

# Plot
ctmy_rh.plot <- ggplot(HCP_tot_analysis_rh, aes(x = label_dataset, fill = label_dataset)) + 
  geom_violin(aes(y = ratio), size = .8, alpha = 0.6) + 
  geom_jitter(aes(y = ratio), 
              shape = 21, color = 'black', alpha = .8,
              position=position_jitterdodge(jitter.width = 1.5, 
                                            dodge.width = .5, jitter.height = 0)) + 
  geom_pointrange(data = HCP_tot_analysis_rh_stats, 
                  aes(label_dataset, ratio, ymin=ratio-sd, ymax=ratio+sd, 
                      fill = label_dataset), 
                  shape = 21, size = 1, fatten = 4) +
  scale_x_discrete(breaks = c("spls d", "spls r", 
                              "sspls d", "sspls r", 
                              "MCGS d", "MCGS r", 
                              "ifrms d", "ifrms r"), 
                   labels = c(
                              "disc", "repl",
                              "disc", "repl", 
                              "disc", "repl",
                              "disc", "repl")) +
  scale_fill_manual(breaks = c("spls d", "spls r", 
                               "sspls d", "sspls r", 
                               "MCGS d", "MCGS r", 
                               "ifrms d", "ifrms r"),
                    values = c( "#238b45", "#74c476", 
      "chartreuse4", "chartreuse", 
      "#2c7fb8", "#41b6c4",
      "firebrick", "#ef3b2c")) +
  scale_color_manual(breaks = c("spls d", "spls r", 
                                "sspls d", "sspls r", 
                                "MCGS d", "MCGS r", 
                                "ifrms d", "ifrms r"),
                    values = c("#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363")) +
  labs(x = "PCC sulci",
       y = ratio_axis) + 
  guides(fill = F, color = F, alpha = F) +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
          plot.subtitle = element_text(size = 12),
          plot.caption = element_text(size = 12, hjust = 1),
          axis.title.x = element_text(size=18, face = "bold", vjust = .9),
          axis.title.y = element_text(size=18, face = "bold", vjust = .9), # was 20
          axis.title.y.right = element_text(size=20, face = "bold", vjust = 1),
          axis.text.x = element_text(size = 11, face = "bold", vjust = .70), # was 15
          axis.text.y = element_text(size = 11, face = "bold"), # was 20
          legend.title = element_text(size=14), 
          legend.text = element_text(size=12),
          strip.text.x = element_text(size = 18, face = "bold"), # was 20
          strip.background = element_blank(),
          strip.placement = "outside",
          axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  facet_wrap( ~ label, strip.position = "bottom", scales = "free_x", ncol = 4)
ctmy_rh.plot

# ggplot2::ggsave(filename = "ctmy_rh_plot.png",
#                  plot = ctmy_rh.plot,
#                  device = "png",
#                  width = 12,
#                  height = 5, 
#                  units = "in",
#                  dpi = "retina")
```

# Functional Analyses

### Q1: Does the overlap between PCC functional networks differ between the *ifrms* and the *spls*? 
* 3-way (network x sulcal label x hemi) repeated measures ANOVA to test for differences in overlap (DICE coefficient; see Methods)
* network: cognitive control (CCN; A,B,C), default mode (DMN; A,B,C)
* sulcal label: *ifrms*, *spls* 
* hemi: lh, rh

#### Discovery Sample
```{r, warning = FALSE}
# Dataset - all
networks_dice_ifrms_spls <- read.csv("~/Desktop/RMD_csvs/networks_dice_ifrms_spls.csv")
networks_dice_ifrms_spls$TRG_sub <- as.factor(networks_dice_ifrms_spls$TRG_sub)

# Discovery dataset
networks_ifrms_spls_discovery <- networks_dice_ifrms_spls %>% subset(dataset == "HCP_discovery")

# Subset networks since only looking at these six networks
six_networks_ifrms_spls_discovery <- networks_ifrms_spls_discovery %>% 
  subset(network_name %in% c('ControlA', 'ControlB','ControlC', 'DefaultA','DefaultB', 'DefaultC')) 

# ANOVA
network_disc.rmaov <- aov(dice_coeff ~ hemi*label_name*network_name + 
                           Error(TRG_sub/(hemi*label_name*network_name)), 
                         data = six_networks_ifrms_spls_discovery)

summary(network_disc.rmaov) #p-values
rstatix::anova_summary(network_disc.rmaov, effect.size = "ges") #Eta-squared

# Post hoc tests
network_aov.i1 <- emmeans::emmeans(network_disc.rmaov, ~ label_name | network_name)
emmeans::contrast(network_aov.i1, method='pairwise')

network_aov.i2 <- emmeans::emmeans(network_disc.rmaov, ~ hemi | label_name | network_name)
emmeans::contrast(network_aov.i2, method='pairwise')
```

##### Results for functional analyses Q1 (discovery)
This approach demonstrated that the *ifrms* shows a unique connectivity profile compared to the *spls*. The 3-way ANOVA yielded a sulcus x network interaction (F(5, 840) = 118.32, p < 0.001, η2G = 0.29) and a sulcus x network x hemisphere interaction (F(5, 840) = 3.43, p = 0.004, η2G = 0.008). Post hoc analyses showed that the *ifrms* overlapped significantly more with CCN-b and CCN-c (p-values < 0.001, Tukey’s adjustment) than the *spls*. On the other hand, the *spls* overlapped significantly more with DMN-a and DMN-b (p-values < 0.001, Tukey’s adjustment) than the *ifrms*. Further post hoc tests revealed that the latter interaction was driven by i) the *ifrms* overlapping more with DMN-a in the left hemisphere than the right (p = 0.004, Tukey’s adjustment), ii) the *spls* overlapping more with the CCN-b in the right hemisphere than the left (p = 0.004, Tukey’s adjustment), and iii) the *spls* overlapping more with the DMN-b in the left hemisphere than the right (p < 0.001, Tukey’s adjustment). These results highlight that, compared to the more posterior *spls*, which showed larger overlap with the DMNs, the more anterior *ifrms* displayed a diverging profile: on average, it overlapped more with the CCNs - in particular, CCN-b. See Figure 6b and 6c in the main text or in the plot below 

#### Replication Sample
```{r, warning = FALSE}
# Replication dataset
networks_ifrms_spls_replication <- networks_dice_ifrms_spls %>% subset(dataset == "HCP_replication")

# Filter for networks
six_networks_ifrms_spls_replication <- networks_ifrms_spls_replication %>% subset(network_name %in% 
                                                   c('ControlA', 'ControlB','ControlC',
                                                              'DefaultA','DefaultB', 'DefaultC'))

# ANOVA
network_rep.rmaov <- aov(dice_coeff ~ hemi*label_name*network_name + 
                          + Error(TRG_sub/(hemi*label_name*network_name)), 
                                  data = six_networks_ifrms_spls_replication)
                        
summary(network_rep.rmaov) #p-values
rstatix::anova_summary(network_rep.rmaov, effect.size = "ges") #Eta-squared

# Post hoc tests
network_aov_rep.i1 <- emmeans::emmeans(network_rep.rmaov, ~ label_name | network_name)
emmeans::contrast(network_aov_rep.i1, method='pairwise')

network_aov_rep.i2 <- emmeans::emmeans(network_rep.rmaov, ~ hemi | label_name | network_name)
emmeans::contrast(network_aov_rep.i2, method='pairwise')
```

##### Results for functional analyses Q1 (replication)
The results observed in the discovery sample were confirmed in the replication sample. Once more, there was a sulcus x network interaction (F(5, 792) = 71.13, p < 0.001, η2G = 0.19) and a sulcus x network x hemisphere interaction (F(5, 792) = 7.21, p = 0.003, η2G = 0.019). Post hoc analyses on the former effect completely replicated those in the discovery sample (p-values < 0.001, Tukey’s adjustment). Additional post hoc tests on the latter interaction confirmed the three findings observed in the discovery sample (p-values < 0.001, Tukey’s adjustment). However, in the replication sample, the *ifrms* also overlapped more with CCN-c in the right hemisphere than in the left (p = 0.001, Tukey’s adjustment). There was no hemispheric difference in CCN-c overlap observed in the discovery sample (p > 0.05, Tukey’s adjustment). See Supplementary Figure 6 in the supplementary material or in the plot below. 

#### Figure 4b: Mean *ifrms* and *spls* connectivity fingerprints - discovery
```{r, warning = FALSE}
# Necessary function to make radar plot
coord_radar <- function (theta = "x", start = 0, direction = 1) 
{
  theta <- match.arg(theta, c("x", "y"))
  r <- if (theta == "x") 
    "y"
  else "x"
  ggproto("CordRadar", CoordPolar, theta = theta, r = r, start = start, 
          direction = sign(direction),
          is_linear = function(coord) TRUE)
}

# ifrms
df.dice <- six_networks_ifrms_spls_discovery %>% subset(label_name == "ifrms")

df.dice$network_name <- gsub("ControlA", "Control A", df.dice$network_name)
df.dice$network_name <- gsub("ControlB", "Control B", df.dice$network_name)
df.dice$network_name <- gsub("ControlC", "Control C", df.dice$network_name)
df.dice$network_name <- gsub("DefaultA", "Default A", df.dice$network_name)
df.dice$network_name <- gsub("DefaultB", "Default B", df.dice$network_name)
df.dice$network_name <- gsub("DefaultC", "Default C", df.dice$network_name)

df.dice.lh <- df.dice %>% subset(hemi == 'lh')
df.dice.rh <- df.dice %>% subset(hemi == 'rh')

# Get mean values for network-sulcus overlap 
df.dice.avg <- df.dice %>% 
  group_by(network_name, hemi, label_name) %>% 
  summarise(dice_coefficient = mean(dice_coeff))

# Rename dfs and add "ifrms.?h" column for color coding
df.dice.avg.lh <- df.dice.avg %>% subset(hemi == 'lh')
df.dice.avg.lh ['label_hemi']='ifrms.lh'

df.dice.avg.rh <- df.dice.avg %>% subset(hemi == 'rh')
df.dice.avg.rh ['label_hemi']='ifrms.rh'

# Std error calculation for plot
ifrms.dice.se <- df.dice %>% 
  group_by(network_name, hemi) %>%
  summarise(n=n(), 
            sd=sd(dice_coeff), 
            se=sd/sqrt(n))

ifrms.dice.se.lh <- ifrms.dice.se %>% subset(hemi %in% c('lh')) 
ifrms.dice.se.rh <- ifrms.dice.se %>% subset(hemi %in% c('rh')) 
names(ifrms.dice.se.lh)[names(ifrms.dice.se.lh) == 'dice_coeff'] <- "se"
names(ifrms.dice.se.rh)[names(ifrms.dice.se.rh) == 'dice_coeff'] <- "se"

ifrms.dice.se.lh = ifrms.dice.se.lh %>% subset(select = -c(hemi))
ifrms.dice.se.rh = ifrms.dice.se.rh %>% subset(select = -c(hemi))

# Merge together + get upper and lower bounds
ifrms.dice.se.lh <- merge(ifrms.dice.se.lh, df.dice.avg.lh,
                          by=c("network_name"))
ifrms.dice.se.rh <- merge(ifrms.dice.se.rh, df.dice.avg.rh,
                          by=c("network_name"))

ifrms.dice.se.lh <- ifrms.dice.se.lh %>% 
  group_by(network_name) %>%
  mutate(upper = dice_coefficient + se, 
         lower = dice_coefficient - se)

ifrms.dice.se.rh <- ifrms.dice.se.rh %>% 
  group_by(network_name) %>%
  mutate(upper = dice_coefficient + se, 
         lower = dice_coefficient - se)

ifrms.dice.se.lh.u <- ifrms.dice.se.lh %>% subset(select = -c(lower, dice_coefficient))
names(ifrms.dice.se.lh.u)[names(ifrms.dice.se.lh.u) == 'upper'] <- "dice_coefficient"
ifrms.dice.se.lh.l <- ifrms.dice.se.lh %>% subset(select = -c(upper, dice_coefficient))
names(ifrms.dice.se.lh.l)[names(ifrms.dice.se.lh.l) == 'lower'] <- "dice_coefficient"

ifrms.dice.se.rh.u <- ifrms.dice.se.rh %>% subset(select = -c(lower, dice_coefficient))
names(ifrms.dice.se.rh.u)[names(ifrms.dice.se.rh.u) == 'upper'] <- "dice_coefficient"
ifrms.dice.se.rh.l <- ifrms.dice.se.rh %>% subset(select = -c(upper, dice_coefficient ))
names(ifrms.dice.se.rh.l)[names(ifrms.dice.se.rh.l) == 'lower'] <- "dice_coefficient"

# More renaming for plot aesthetics 
df.dice.avg.lh$hemi <- gsub("lh", "Left Hemisphere", df.dice.avg.lh$hemi)
df.dice.avg.rh$hemi <- gsub("rh", "Right Hemisphere", df.dice.avg.rh$hemi)
ifrms.dice.se.lh.l$hemi <- gsub("lh", "Left Hemisphere", ifrms.dice.se.lh.l$hemi)
ifrms.dice.se.lh.u$hemi <- gsub("lh", "Left Hemisphere", ifrms.dice.se.lh.u$hemi)
ifrms.dice.se.rh.l$hemi <- gsub("rh", "Right Hemisphere", ifrms.dice.se.rh.l$hemi)
ifrms.dice.se.rh.u$hemi <- gsub("rh", "Right Hemisphere", ifrms.dice.se.rh.u$hemi)

# spls
spls.dice <- six_networks_ifrms_spls_discovery %>% subset(label_name == "spls")

spls.dice$network_name <- gsub("ControlA", "Control A", spls.dice$network_name)
spls.dice$network_name <- gsub("ControlB", "Control B", spls.dice$network_name)
spls.dice$network_name <- gsub("ControlC", "Control C", spls.dice$network_name)
spls.dice$network_name <- gsub("DefaultA", "Default A", spls.dice$network_name)
spls.dice$network_name <- gsub("DefaultB", "Default B", spls.dice$network_name)
spls.dice$network_name <- gsub("DefaultC", "Default C", spls.dice$network_name)

spls.dice.lh <- spls.dice %>% subset(hemi == 'lh')
spls.dice.rh <- spls.dice %>% subset(hemi == 'rh')

# Get mean values for network-sulcus overlap 
spls.dice.avg <- spls.dice %>% 
  group_by(network_name, hemi, label_name) %>% 
  summarise(dice_coefficient = mean(dice_coeff))

# Rename dfs and add "ifrms.?h" column for color coding
spls.dice.avg.lh <- spls.dice.avg %>% subset(hemi == 'lh')
spls.dice.avg.lh['label_hemi']='spls.lh'

spls.dice.avg.rh <- spls.dice.avg %>% subset(hemi == 'rh')
spls.dice.avg.rh['label_hemi']='spls.rh'

# Std error calculation for plot
spls.dice.se <- spls.dice %>% 
  group_by(hemi, label_name, network_name) %>%
  summarise(n=n(), 
            sd=sd(dice_coeff), 
            se=sd/sqrt(n))

spls.dice.se.lh <- spls.dice.se %>% subset(hemi %in% c('lh')) 
spls.dice.se.rh <- spls.dice.se %>% subset(hemi %in% c('rh')) 

names(spls.dice.se.lh)[names(spls.dice.se.lh) == 'dice_coeff'] <- "se"
names(spls.dice.se.rh)[names(spls.dice.se.rh) == 'dice_coeff'] <- "se"

spls.dice.se.lh = spls.dice.se.lh %>% subset(select = -c(hemi, label_name))
spls.dice.se.rh = spls.dice.se.rh %>% subset(select = -c(hemi, label_name))

# Merge together + get upper and lower bounds
spls.dice.se.lh <- merge(spls.dice.se.lh, spls.dice.avg.lh,
                         by=c("network_name"))
spls.dice.se.rh <- merge(spls.dice.se.rh, spls.dice.avg.rh,
                         by=c("network_name"))

spls.dice.se.lh <- spls.dice.se.lh %>% 
  group_by(network_name) %>%
  mutate(upper = dice_coefficient + se, 
         lower = dice_coefficient - se)

spls.dice.se.rh <- spls.dice.se.rh %>% 
  group_by(network_name) %>%
  mutate(upper = dice_coefficient + se, 
         lower = dice_coefficient - se)

spls.dice.se.lh.u <- spls.dice.se.lh %>% subset(select = -c(lower, dice_coefficient))
names(spls.dice.se.lh.u)[names(spls.dice.se.lh.u) == 'upper'] <- "dice_coefficient"
spls.dice.se.lh.l <- spls.dice.se.lh %>% subset(select = -c(upper, dice_coefficient))
names(spls.dice.se.lh.l)[names(spls.dice.se.lh.l) == 'lower'] <- "dice_coefficient"

spls.dice.se.rh.u <- spls.dice.se.rh %>% subset(select = -c(lower, dice_coefficient))
names(spls.dice.se.rh.u)[names(spls.dice.se.rh.u) == 'upper'] <- "dice_coefficient"
spls.dice.se.rh.l <- spls.dice.se.rh %>% subset(select = -c(upper, dice_coefficient ))
names(spls.dice.se.rh.l)[names(spls.dice.se.rh.l) == 'lower'] <- "dice_coefficient"

# More renaming for plot aesthetics 
spls.dice.avg.lh$hemi <- gsub("lh", "Left Hemisphere", spls.dice.avg.lh$hemi)
spls.dice.avg.rh$hemi <- gsub("rh", "Right Hemisphere", spls.dice.avg.rh$hemi)
spls.dice.se.lh.l$hemi <- gsub("lh", "Left Hemisphere", spls.dice.se.lh.l$hemi)
spls.dice.se.lh.u$hemi <- gsub("lh", "Left Hemisphere", spls.dice.se.lh.u$hemi)
spls.dice.se.rh.l$hemi <- gsub("rh", "Right Hemisphere", spls.dice.se.rh.l$hemi)
spls.dice.se.rh.u$hemi <- gsub("rh", "Right Hemisphere", spls.dice.se.rh.u$hemi)

# Plot
network_dice_discovery.plot <- ggplot() +  
  geom_polygon(data = ifrms.dice.se.lh.l, 
               aes(x = network_name, y = dice_coefficient, fill = NA, group = label_hemi, color = label_hemi), 
               linetype = 2, size = .4) + 
  geom_polygon(data = ifrms.dice.se.lh.u, 
               aes(x = network_name, y = dice_coefficient, fill = NA, group = label_hemi, color = label_hemi), 
               linetype = 2, size = .4) +
  geom_polygon(data = df.dice.avg.lh, 
               aes(x = network_name, y = dice_coefficient, 
                   fill = label_hemi, group = label_hemi, color = label_hemi), 
               size = .9, alpha = .1) +
  geom_point(data = df.dice.avg.lh, 
             aes(x = network_name, y = dice_coefficient, color = label_hemi), 
             size = 2) + 
  
  
  geom_polygon(data = ifrms.dice.se.rh.l, 
               aes(x = network_name, y = dice_coefficient, fill = NA, group = label_hemi, color = label_hemi), 
               linetype = 2, size = .4) + 
  geom_polygon(data = ifrms.dice.se.rh.u, 
               aes(x = network_name, y = dice_coefficient, fill = NA, group = label_hemi, color = label_hemi), 
               linetype = 2, size = .4) + 
  geom_polygon(data = df.dice.avg.rh, 
               aes(x = network_name, y = dice_coefficient, 
                   fill = label_hemi, group = label_hemi, color = label_hemi), 
               size = .9, alpha = .1) +
  geom_point(data = df.dice.avg.rh, 
             aes(x = network_name, y = dice_coefficient, color = label_hemi), 
             size = 2) +
  
  
  geom_polygon(data = spls.dice.se.lh.l, 
               aes(x = network_name, y = dice_coefficient, fill = NA, group = label_hemi, color = label_hemi), 
               linetype = 2, size = .4) + 
  geom_polygon(data = spls.dice.se.lh.u, 
               aes(x = network_name, y = dice_coefficient, fill = NA, group = label_hemi, color = label_hemi), 
               linetype = 2, size = .4) + 
  geom_polygon(data = spls.dice.avg.lh, 
               aes(x = network_name, y = dice_coefficient, 
                   fill = label_hemi, group = label_hemi, color = label_hemi), 
               size = .9, alpha = .1) +
  geom_point(data = spls.dice.avg.lh, 
             aes(x = network_name, y = dice_coefficient, color = label_hemi), 
             size = 2) + 
  
  
  geom_polygon(data = spls.dice.se.rh.l, 
               aes(x = network_name, y = dice_coefficient, fill = NA, group = label_hemi, color = label_hemi), 
               linetype = 2, size = .4) + 
  geom_polygon(data = spls.dice.se.rh.u, 
               aes(x = network_name, y = dice_coefficient, fill = NA, group = label_hemi, color = label_hemi), 
               linetype = 2, size = .4) + 
  geom_polygon(data = spls.dice.avg.rh, 
               aes(x = network_name, y = dice_coefficient, 
                   fill = label_hemi, group = label_hemi, color = label_hemi), 
               size = .9, alpha = .1) +
  geom_point(data = spls.dice.avg.rh, 
             aes(x = network_name, y = dice_coefficient, color = label_hemi), 
             size = 2) +
  
  coord_radar(start = -pi/2) +
  labs(x = "Network Name",
       y = "Dice Coefficient", 
       title = "",
       subtitle = "",
       color = "Label & Hemisphere",
       fill = "Label & Hemisphere") +  
  scale_fill_manual(limit = c("ifrms.lh", "ifrms.rh", "spls.lh", "spls.rh"), 
                    labels = c("ifrms lh", "ifrms rh", "spls lh", "spls rh"),
                    values = c("firebrick", "#ef3b2c", "#238b45", "#74c476")) +
  scale_color_manual(limit = c("ifrms.lh", "ifrms.rh", "spls.lh", "spls.rh"), 
                     labels = c("ifrms lh", "ifrms rh", "spls lh", "spls rh"),
                     values = c("firebrick", "#ef3b2c", "#238b45", "#74c476")) + 
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(hjust = 0, size = 14),
        plot.caption = element_text(size = 12),
        axis.text=element_text(size=14),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 5, face = "bold", color = "black", vjust = .50), # was 12
        axis.text.y = element_text(size = 10, face = "bold"), # was 12
        strip.text.x = element_text(size = 10, face = "bold"), # was 12
        legend.title = element_text(size=10, face = "bold"), # was 14
        legend.text = element_text(size=8), # was 12
        legend.position="bottom", 
        axis.line = element_line(colour = "black", 
                                 size = 0, linetype = "solid", lineend = "round"),
        panel.grid.minor = element_line(size = 0.5, color = "gray"), 
        panel.grid.major = element_line(size = .75, color = "gray")) + 
  guides(fill = F) + 
  ylim(0,1) + 
 facet_grid(. ~ hemi)
network_dice_discovery.plot

# ggplot2::ggsave(filename = "network_dice_discovery_plot.png",
#                 plot = network_dice_discovery.plot,
#                 device = "png",
#                 width = 8,
#                 height = 6, 
#                 units = "in",
#                 dpi = "retina")

```

#### Supplementary Figure 5.2: Mean *ifrms* and *spls* connectivity fingerprints - replication
```{r, warning = FALSE}
# ifrms
ifrms_networks_rep <- six_networks_ifrms_spls_replication %>% subset(label_name == "ifrms")

ifrms_networks_rep$network_name <- gsub("ControlA", "Control A", ifrms_networks_rep$network_name)
ifrms_networks_rep$network_name <- gsub("ControlB", "Control B", ifrms_networks_rep$network_name)
ifrms_networks_rep$network_name <- gsub("ControlC", "Control C", ifrms_networks_rep$network_name)
ifrms_networks_rep$network_name <- gsub("DefaultA", "Default A", ifrms_networks_rep$network_name)
ifrms_networks_rep$network_name <- gsub("DefaultB", "Default B", ifrms_networks_rep$network_name)
ifrms_networks_rep$network_name <- gsub("DefaultC", "Default C", ifrms_networks_rep$network_name)

ifrms_networks_rep_lh <- ifrms_networks_rep %>% subset(hemi == 'lh')
ifrms_networks_rep_rh <- ifrms_networks_rep %>% subset(hemi == 'rh')

# Get mean values for network-sulcus overlap 
ifrms_networks_rep.avg <- ifrms_networks_rep %>% 
  group_by(network_name, hemi, label_name) %>% 
  summarise(dice_coefficient = mean(dice_coeff))

# Rename dfs and add "ifrms.?h" column for color coding
ifrms_networks_rep.avg.lh <- subset(x = ifrms_networks_rep.avg, subset = ifrms_networks_rep.avg$hemi == 'lh')
ifrms_networks_rep.avg.lh['label_hemi']='ifrms.lh'

ifrms_networks_rep.avg.rh<- subset(x = ifrms_networks_rep.avg, subset = ifrms_networks_rep.avg$hemi == 'rh')
ifrms_networks_rep.avg.rh['label_hemi']='ifrms.rh'

# Std error calculation for plot
ifrms_networks_rep.se <- ifrms_networks_rep %>% 
  group_by(hemi, label_name, network_name) %>%
  summarise(n=n(), 
            sd=sd(dice_coeff), 
            se=sd/sqrt(n))

ifrms_networks_rep.se.lh <- ifrms_networks_rep.se %>% subset(hemi %in% c('lh')) 
ifrms_networks_rep.se.rh <- ifrms_networks_rep.se %>% subset(hemi %in% c('rh')) 
names(ifrms_networks_rep.se.lh)[names(ifrms_networks_rep.se.lh) == 'dice_coeff'] <- "se"
names(ifrms_networks_rep.se.rh)[names(ifrms_networks_rep.se.rh) == 'dice_coeff'] <- "se"

ifrms_networks_rep.se.lh = ifrms_networks_rep.se.lh %>% subset(select = -c(hemi, label_name))
ifrms_networks_rep.se.rh = ifrms_networks_rep.se.rh %>% subset(select = -c(hemi, label_name))

# merge together + get upper and lower bounds
ifrms_networks_rep.se.lh <- merge(ifrms_networks_rep.se.lh, ifrms_networks_rep.avg.lh,
                          by=c("network_name"))
ifrms_networks_rep.se.rh <- merge(ifrms_networks_rep.se.rh, ifrms_networks_rep.avg.rh,
                          by=c("network_name"))

ifrms_networks_rep.se.lh <- ifrms_networks_rep.se.lh %>% 
  group_by(network_name) %>%
  mutate(upper = dice_coefficient + se, 
         lower = dice_coefficient - se)

ifrms_networks_rep.se.rh <- ifrms_networks_rep.se.rh %>% 
  group_by(network_name) %>%
  mutate(upper = dice_coefficient + se, 
         lower = dice_coefficient - se)

ifrms_networks_rep.se.lh.u <- ifrms_networks_rep.se.lh %>% subset(select = -c(lower, dice_coefficient))
names(ifrms_networks_rep.se.lh.u)[names(ifrms_networks_rep.se.lh.u) == 'upper'] <- "dice_coefficient"
ifrms_networks_rep.se.lh.l <- ifrms_networks_rep.se.lh %>% subset(select = -c(upper, dice_coefficient))
names(ifrms_networks_rep.se.lh.l)[names(ifrms_networks_rep.se.lh.l) == 'lower'] <- "dice_coefficient"

ifrms_networks_rep.se.rh.u <- ifrms_networks_rep.se.rh %>% subset(select = -c(lower, dice_coefficient))
names(ifrms_networks_rep.se.rh.u)[names(ifrms_networks_rep.se.rh.u) == 'upper'] <- "dice_coefficient"
ifrms_networks_rep.se.rh.l <- ifrms_networks_rep.se.rh %>% subset(select = -c(upper, dice_coefficient ))
names(ifrms_networks_rep.se.rh.l)[names(ifrms_networks_rep.se.rh.l) == 'lower'] <- "dice_coefficient"

# more renaming to make plot better 
ifrms_networks_rep.avg.lh$hemi <- gsub("lh", "Left Hemisphere", ifrms_networks_rep.avg.lh$hemi)
ifrms_networks_rep.avg.rh$hemi <- gsub("rh", "Right Hemisphere", ifrms_networks_rep.avg.rh$hemi)
ifrms_networks_rep.se.lh.l$hemi <- gsub("lh", "Left Hemisphere", ifrms_networks_rep.se.lh.l$hemi)
ifrms_networks_rep.se.lh.u$hemi <- gsub("lh", "Left Hemisphere", ifrms_networks_rep.se.lh.u$hemi)
ifrms_networks_rep.se.rh.l$hemi <- gsub("rh", "Right Hemisphere", ifrms_networks_rep.se.rh.l$hemi)
ifrms_networks_rep.se.rh.u$hemi <- gsub("rh", "Right Hemisphere", ifrms_networks_rep.se.rh.u$hemi)

# spls
spls_networks_rep <- six_networks_ifrms_spls_replication %>% subset(label_name == "spls")

spls_networks_rep$network_name <- gsub("ControlA", "Control A", spls_networks_rep$network_name)
spls_networks_rep$network_name <- gsub("ControlB", "Control B", spls_networks_rep$network_name)
spls_networks_rep$network_name <- gsub("ControlC", "Control C", spls_networks_rep$network_name)
spls_networks_rep$network_name <- gsub("DefaultA", "Default A", spls_networks_rep$network_name)
spls_networks_rep$network_name <- gsub("DefaultB", "Default B", spls_networks_rep$network_name)
spls_networks_rep$network_name <- gsub("DefaultC", "Default C", spls_networks_rep$network_name)

spls_networks_rep.lh <- spls_networks_rep %>% subset(hemi == 'lh')
spls_networks_rep.rh <- spls_networks_rep %>% subset(hemi == 'rh')

# get mean values for network-sulcus overlap 
spls_networks_rep.avg <- spls_networks_rep %>% 
  group_by(network_name, hemi, label_name) %>% 
  summarise(dice_coefficient = mean(dice_coeff))

# Rename dfs and add "ifrms.?h" column for color coding
spls_networks_rep.avg.lh <- spls_networks_rep.avg %>% subset(hemi == 'lh')
spls_networks_rep.avg.lh['label_hemi']='spls.lh'

spls_networks_rep.avg.rh <- spls_networks_rep.avg %>% subset(hemi == 'rh')
spls_networks_rep.avg.rh['label_hemi']='spls.rh'

# Std error calculation for plot
spls_networks_rep.se <- spls_networks_rep %>% 
  group_by(hemi, label_name, network_name) %>%
  summarise(n=n(), 
            sd=sd(dice_coeff), 
            se=sd/sqrt(n))

spls_networks_rep.se.lh <- spls_networks_rep.se %>% subset(hemi %in% c('lh')) 
spls_networks_rep.se.rh <- spls_networks_rep.se %>% subset(hemi %in% c('rh')) 

names(spls_networks_rep.se.lh)[names(spls_networks_rep.se.lh) == 'dice_coeff'] <- "se"
names(spls_networks_rep.se.rh)[names(spls_networks_rep.se.rh) == 'dice_coeff'] <- "se"

spls_networks_rep.se.lh = spls_networks_rep.se.lh %>% subset(select = -c(hemi, label_name))
spls_networks_rep.se.rh = spls_networks_rep.se.rh %>% subset(select = -c(hemi, label_name))

# Merge together + get upper and lower bounds
spls_networks_rep.se.lh <- merge(spls_networks_rep.se.lh, spls_networks_rep.avg.lh,
                         by=c("network_name"))
spls_networks_rep.se.rh <- merge(spls_networks_rep.se.rh, spls_networks_rep.avg.rh,
                         by=c("network_name"))

spls_networks_rep.se.lh <- spls_networks_rep.se.lh %>% 
  group_by(network_name) %>%
  mutate(upper = dice_coefficient + se, 
         lower = dice_coefficient - se)
spls_networks_rep.se.rh <- spls_networks_rep.se.rh %>% 
  group_by(network_name) %>%
  mutate(upper = dice_coefficient + se, 
         lower = dice_coefficient - se)

spls_networks_rep.se.lh.u <- spls_networks_rep.se.lh %>% subset(select = -c(lower, dice_coefficient))
names(spls_networks_rep.se.lh.u)[names(spls_networks_rep.se.lh.u) == 'upper'] <- "dice_coefficient"
spls_networks_rep.se.lh.l <- spls_networks_rep.se.lh %>% subset(select = -c(upper, dice_coefficient))
names(spls_networks_rep.se.lh.l)[names(spls_networks_rep.se.lh.l) == 'lower'] <- "dice_coefficient"

spls_networks_rep.se.rh.u <- spls_networks_rep.se.rh %>% subset(select = -c(lower, dice_coefficient))
names(spls_networks_rep.se.rh.u)[names(spls_networks_rep.se.rh.u) == 'upper'] <- "dice_coefficient"
spls_networks_rep.se.rh.l <- spls_networks_rep.se.rh %>% subset(select = -c(upper, dice_coefficient ))
names(spls_networks_rep.se.rh.l)[names(spls_networks_rep.se.rh.l) == 'lower'] <- "dice_coefficient"

# more renaming to make plot better 
spls_networks_rep.avg.lh$hemi <- gsub("lh", "Left Hemisphere", spls_networks_rep.avg.lh$hemi)
spls_networks_rep.avg.rh$hemi <- gsub("rh", "Right Hemisphere", spls_networks_rep.avg.rh$hemi)
spls_networks_rep.se.lh.l$hemi <- gsub("lh", "Left Hemisphere", spls_networks_rep.se.lh.l$hemi)
spls_networks_rep.se.lh.u$hemi <- gsub("lh", "Left Hemisphere", spls_networks_rep.se.lh.u$hemi)
spls_networks_rep.se.rh.l$hemi <- gsub("rh", "Right Hemisphere", spls_networks_rep.se.rh.l$hemi)
spls_networks_rep.se.rh.u$hemi <- gsub("rh", "Right Hemisphere", spls_networks_rep.se.rh.u$hemi)

network_dice_replication.plot <- ggplot() +  
  geom_polygon(data = ifrms_networks_rep.se.lh.l, 
               aes(x = network_name, y = dice_coefficient, fill = NA, group = label_hemi, color = label_hemi), 
               linetype = 2, size = .4) + 
  geom_polygon(data = ifrms_networks_rep.se.lh.u, 
               aes(x = network_name, y = dice_coefficient, fill = NA, group = label_hemi, color = label_hemi), 
               linetype = 2, size = .4) +
  geom_polygon(data = ifrms_networks_rep.avg.lh, 
               aes(x = network_name, y = dice_coefficient, fill = label_hemi, group = label_hemi, 
                   color = label_hemi), 
               size = .9, alpha = .1) +
  geom_point(data = ifrms_networks_rep.avg.lh, 
             aes(x = network_name, y = dice_coefficient, color = label_hemi), 
             size = 2) + 
  
  
  geom_polygon(data = ifrms_networks_rep.se.rh.l, 
               aes(x = network_name, y = dice_coefficient, fill = NA, group = label_hemi, color = label_hemi), 
               linetype = 2, size = .4) + 
  geom_polygon(data = ifrms_networks_rep.se.rh.u, 
               aes(x = network_name, y = dice_coefficient, fill = NA, group = label_hemi, color = label_hemi), 
               linetype = 2, size = .4) + 
  geom_polygon(data = ifrms_networks_rep.avg.rh, 
               aes(x = network_name, y = dice_coefficient, fill = label_hemi, group = label_hemi, 
                   color = label_hemi), 
               size = .9, alpha = .1) +
  geom_point(data = ifrms_networks_rep.avg.rh, 
             aes(x = network_name, y = dice_coefficient, color = label_hemi), 
             size = 2) +
  
  
  geom_polygon(data = spls_networks_rep.se.lh.l, 
               aes(x = network_name, y = dice_coefficient, fill = NA, group = label_hemi, color = label_hemi), 
               linetype = 2, size = .4) + 
  geom_polygon(data = spls_networks_rep.se.lh.u, 
               aes(x = network_name, y = dice_coefficient, fill = NA, group = label_hemi, color = label_hemi), 
               linetype = 2, size = .4) + 
  geom_polygon(data = spls_networks_rep.avg.lh, 
               aes(x = network_name, y = dice_coefficient, fill = label_hemi, group = label_hemi, 
                   color = label_hemi), 
               size = .9, alpha = .1) +
  geom_point(data = spls_networks_rep.avg.lh, 
             aes(x = network_name, y = dice_coefficient, color = label_hemi), 
             size = 2) + 
  
  
  geom_polygon(data = spls_networks_rep.se.rh.l, 
               aes(x = network_name, y = dice_coefficient, fill = NA, group = label_hemi, color = label_hemi), 
               linetype = 2, size = .4) + 
  geom_polygon(data = spls_networks_rep.se.rh.u, 
               aes(x = network_name, y = dice_coefficient, fill = NA, group = label_hemi, color = label_hemi), 
               linetype = 2, size = .4) + 
  geom_polygon(data = spls_networks_rep.avg.rh, 
               aes(x = network_name, y = dice_coefficient, fill = label_hemi, group = label_hemi, 
                   color = label_hemi), 
               size = .9, alpha = .1) +
  geom_point(data = spls_networks_rep.avg.rh, 
             aes(x = network_name, y = dice_coefficient, color = label_hemi), 
             size = 2) +
  
  coord_radar(start = -pi/2) +
  labs(x = "Network Name",
       y = "Dice Coefficient", 
       title = "",
       subtitle = "",
       color = "Label & Hemisphere",
       fill = "Label & Hemisphere") +  
  scale_fill_manual(limit = c("ifrms.lh", "ifrms.rh", "spls.lh", "spls.rh"), 
                    labels = c("ifrms lh", "ifrms rh", "spls lh", "spls rh"),
                    values = c("firebrick", "#ef3b2c", "#238b45", "#74c476")) +
  scale_color_manual(limit = c("ifrms.lh", "ifrms.rh", "spls.lh", "spls.rh"), 
                     labels = c("ifrms lh", "ifrms rh", "spls lh", "spls rh"),
                     values = c("firebrick", "#ef3b2c", "#238b45", "#74c476")) + 
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(hjust = 0, size = 14),
        plot.caption = element_text(size = 12),
        axis.text=element_text(size=14),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 5, face = "bold", color = "black", vjust = .50), # was 12
        axis.text.y = element_text(size = 10, face = "bold"), # was 12
        strip.text.x = element_text(size = 10, face = "bold"), # was 12
        legend.title = element_text(size=10, face = "bold"), # was 14
        legend.text = element_text(size=8), # was 12
        legend.position = "bottom",
        axis.line = element_line(colour = "black", 
                                 size = 0, linetype = "solid", lineend = "round"),
        panel.grid.minor = element_line(size = 0.5, color = "gray"), 
        panel.grid.major = element_line(size = .75, color = "gray")) + 
  guides(fill = F) + 
  ylim(0,1) + 
  facet_grid(. ~ hemi)
network_dice_replication.plot

# ggplot2::ggsave(filename = "network_dice_replication_plot.png",
#                 plot = network_dice_replication.plot,
#                 device = "png",
#                 width = 8,
#                 height = 6, 
#                 units = "in",
#                 dpi = "retina")
```

#### Figure 4c: Four individual subjects' radar plots
```{r, warning = FALSE}
# Four individual radar plots - from the discovery sample
six_networks_ifrms_spls_discovery$label_hemi[six_networks_ifrms_spls_discovery$label_name == "ifrms" & six_networks_ifrms_spls_discovery$hemi == "lh"] <- "ifrms.lh"

six_networks_ifrms_spls_discovery$label_hemi[six_networks_ifrms_spls_discovery$label_name == "ifrms" & six_networks_ifrms_spls_discovery$hemi == "rh"] <- "ifrms.rh"

six_networks_ifrms_spls_discovery$label_hemi[six_networks_ifrms_spls_discovery$label_name == "spls" & six_networks_ifrms_spls_discovery$hemi == "lh"] <- "spls.lh"

six_networks_ifrms_spls_discovery$label_hemi[six_networks_ifrms_spls_discovery$label_name == "spls" & six_networks_ifrms_spls_discovery$hemi == "rh"] <- "spls.rh"

six_networks_ifrms_spls_discovery$network_name <- gsub("ControlA", "Control A", six_networks_ifrms_spls_discovery$network_name)

six_networks_ifrms_spls_discovery$network_name <- gsub("ControlB", "Control B", six_networks_ifrms_spls_discovery$network_name)

six_networks_ifrms_spls_discovery$network_name <- gsub("ControlC", "Control C", six_networks_ifrms_spls_discovery$network_name)

six_networks_ifrms_spls_discovery$network_name <- gsub("DefaultA", "Default A", six_networks_ifrms_spls_discovery$network_name)

six_networks_ifrms_spls_discovery$network_name <- gsub("DefaultB", "Default B", six_networks_ifrms_spls_discovery$network_name)

six_networks_ifrms_spls_discovery$network_name <- gsub("DefaultC", "Default C", six_networks_ifrms_spls_discovery$network_name)

dice.100206 <- six_networks_ifrms_spls_discovery %>% subset(TRG_sub == "100206")
dice.100206.lh <- dice.100206 %>% subset(hemi == "lh")
dice.100206.rh <- dice.100206 %>% subset(hemi == "rh")

dice.101107 <- six_networks_ifrms_spls_discovery %>% subset(TRG_sub == "101107")
dice.101107.lh <- dice.101107 %>% subset(hemi == "lh")
dice.101107.rh <- dice.101107 %>% subset(hemi == "rh")

dice.109830 <- six_networks_ifrms_spls_discovery %>% subset(TRG_sub == "109830")
dice.109830.lh <- dice.109830 %>% subset(hemi == "lh")
dice.109830.rh <- dice.109830 %>% subset(hemi == "rh")

dice.214019 <- six_networks_ifrms_spls_discovery %>% subset(TRG_sub == "214019")
dice.214019.lh <- dice.214019 %>% subset(hemi == "lh")
dice.214019.rh <- dice.214019 %>% subset(hemi == "rh")

overlap_100206.plot <- ggplot() +  
  geom_polygon(data = dice.100206.lh , aes(x = network_name, y = dice_coeff, fill = label_hemi, group =
  label_hemi, color = label_hemi), size = .9, alpha = .1) +
  geom_point(data = dice.100206.lh, aes(x = network_name, y = dice_coeff, color = label_hemi), size = 2) + 
  
  geom_polygon(data = dice.100206.rh , aes(x = network_name, y = dice_coeff, fill = label_hemi,
  group = label_hemi, color = label_hemi), size = .9, alpha = .1) +
  geom_point(data = dice.100206.rh, aes(x = network_name, y = dice_coeff, color = label_hemi), 
             size = 2) + 
  coord_radar(start = -pi/2) +
  labs(x = "Network Name",
       y = "Dice Coefficient", 
       title = "",
       subtitle = "",
       color = "Label & Hemisphere",
       fill = "Label & Hemisphere") +  
  scale_fill_manual(limit = c("ifrms.lh", "ifrms.rh", "spls.lh", "spls.rh"), 
                    labels = c("ifrms lh", "ifrms rh", "spls lh", "spls rh"),
                    values = c("firebrick", "#ef3b2c", "#238b45", "#4daf4a")) +
  scale_color_manual(limit = c("ifrms.lh", "ifrms.rh", "spls.lh", "spls.rh"), 
                     labels = c("ifrms lh", "ifrms rh", "spls lh", "spls rh"),
                     values = c("firebrick", "#ef3b2c", "#238b45", "#4daf4a")) +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(hjust = 0, size = 14),
        plot.caption = element_text(size = 12),
        axis.text=element_text(size=14),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 8, face = "bold", color = "black", vjust = .50), # was 12
        axis.text.y = element_text(size = 12, face = "bold"),
        strip.text.y = element_text(size = 12, face = "bold"),
        legend.title = element_text(size=10, face = "bold"), # was 14
        legend.text = element_text(size=8), # was 12
        legend.position = "bottom",
        axis.line = element_line(colour = "black", 
                                 size = 0, linetype = "solid", lineend = "round"),
        panel.grid.minor = element_line(size = 0.5, color = "gray"), 
        panel.grid.major = element_line(size = .75, color = "gray")) + 
  guides(fill = F) + 
  ylim(0,1) 
overlap_100206.plot

# ggplot2::ggsave(filename = "overlap_100206_plot.png",
#                 plot = overlap_100206.plot,
#                 device = "png",
#                 width = 4,
#                 height = 4, 
#                 units = "in",
#                 dpi = "retina")


overlap_101107.plot <- ggplot() +  
  geom_polygon(data = dice.101107.lh, aes(x = network_name, y = dice_coeff, fill = label_hemi, group =
                                            label_hemi, color = label_hemi), size = .9, alpha = .1) +
  geom_point(data = dice.101107.lh, aes(x = network_name, y = dice_coeff, color = label_hemi), size = 2) + 
  geom_polygon(data = dice.101107.rh, aes(x = network_name, y = dice_coeff, fill = label_hemi, group =
                                            label_hemi, color = label_hemi), size = .9, alpha = .1) +
  geom_point(data = dice.101107.rh, aes(x = network_name, y = dice_coeff, color = label_hemi), size = 2) + 
  coord_radar(start = -pi/2) +
  labs(x = "Network Name",
       y = "Dice Coefficient", 
       title = "",
       subtitle = "",
       color = "Label & Hemisphere",
       fill = "Label & Hemisphere") +  
  scale_fill_manual(limit = c("ifrms.lh", "ifrms.rh", "spls.lh", "spls.rh"), 
                    labels = c("ifrms lh", "ifrms rh", "spls lh", "spls rh"),
                    values = c("firebrick", "#ef3b2c", "#238b45", "#4daf4a")) +
  scale_color_manual(limit = c("ifrms.lh", "ifrms.rh", "spls.lh", "spls.rh"), 
                     labels = c("ifrms lh", "ifrms rh", "spls lh", "spls rh"),
                     values = c("firebrick", "#ef3b2c", "#238b45", "#4daf4a")) + 
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(hjust = 0, size = 14),
        plot.caption = element_text(size = 12),
        axis.text=element_text(size=14),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 8, face = "bold", color = "black", vjust = .50), # was 12
        axis.text.y = element_text(size = 12, face = "bold"),
        strip.text.y = element_text(size = 12, face = "bold"),
        legend.title = element_text(size=10, face = "bold"), # was 14
        legend.text = element_text(size=8), # was 12
        legend.position = "bottom",
        axis.line = element_line(colour = "black", 
                                 size = 0, linetype = "solid", lineend = "round"),
        panel.grid.minor = element_line(size = 0.5, color = "gray"), 
        panel.grid.major = element_line(size = .75, color = "gray")) + 
  guides(fill = F) + 
  ylim(0,1) 
overlap_101107.plot

# ggplot2::ggsave(filename = "overlap_101107_plot.png",
#                 plot = overlap_101107.plot,
#                 device = "png",
#                 width = 4,
#                 height = 4, 
#                 units = "in",
#                 dpi = "retina")


overlap_109830.plot <- ggplot() +  
  geom_polygon(data = dice.109830.lh, aes(x = network_name, y = dice_coeff, fill = label_hemi, group =
                                            label_hemi, color = label_hemi), size = .9, alpha = .1) +
  geom_point(data = dice.109830.lh, aes(x = network_name, y = dice_coeff, color = label_hemi), size = 2) + 
  geom_polygon(data = dice.109830.rh, aes(x = network_name, y = dice_coeff, fill = label_hemi, group =
                                            label_hemi, color = label_hemi), size = .9, alpha = .1) +
  geom_point(data = dice.109830.rh, aes(x = network_name, y = dice_coeff, color = label_hemi), size = 2) + 
  
  coord_radar(start = -pi/2) +
  labs(x = "Network Name",
       y = "Dice Coefficient", 
       title = "",
       subtitle = "",
       color = "Label & Hemisphere",
       fill = "Label & Hemisphere") +  
  scale_fill_manual(limit = c("ifrms.lh", "ifrms.rh", "spls.lh", "spls.rh"), 
                    labels = c("ifrms lh", "ifrms rh", "spls lh", "spls rh"),
                    values = c("firebrick", "#ef3b2c", "#238b45", "#4daf4a")) +
  scale_color_manual(limit = c("ifrms.lh", "ifrms.rh", "spls.lh", "spls.rh"), 
                     labels = c("ifrms lh", "ifrms rh", "spls lh", "spls rh"),
                     values = c("firebrick", "#ef3b2c", "#238b45", "#4daf4a")) + 
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(hjust = 0, size = 14),
        plot.caption = element_text(size = 12),
        axis.text=element_text(size=14),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 8, face = "bold", 
                                   color = "black", vjust = .50), # was 12
        axis.text.y = element_text(size = 12, face = "bold"),
        strip.text.y = element_text(size = 12, face = "bold"),
        legend.title = element_text(size=10, face = "bold"), # was 14
        legend.text = element_text(size=8), # was 12
        legend.position = "bottom",
        axis.line = element_line(colour = "black", 
                                 size = 0, linetype = "solid", lineend = "round"),
        panel.grid.minor = element_line(size = 0.5, color = "gray"), 
        panel.grid.major = element_line(size = .75, color = "gray")) + 
  guides(fill = F) + 
  ylim(0,1) 
overlap_109830.plot

# ggplot2::ggsave(filename = "overlap_109830_plot.png",
#                 plot = overlap_109830.plot,
#                 device = "png",
#                 width = 4,
#                 height = 4, 
#                 units = "in",
#                 dpi = "retina")


overlap_214019.plot <- ggplot() +  
  geom_polygon(data = dice.214019.lh, aes(x = network_name, y = dice_coeff, fill = label_hemi, group =
                                           label_hemi, color = label_hemi), size = .9, alpha = .1) +
  geom_point(data = dice.214019.lh, aes(x = network_name, y = dice_coeff, color = label_hemi), size = 2) + 
  
  geom_polygon(data = dice.214019.rh, aes(x = network_name, y = dice_coeff, fill = label_hemi, group =
                                           label_hemi, color = label_hemi), size = .9, alpha = .1) +
  geom_point(data = dice.214019.rh, aes(x = network_name, y = dice_coeff, color = label_hemi), size = 2) + 
  
  coord_radar(start = -pi/2) +
  labs(x = "Network Name",
       y = "Dice Coefficient", 
       title = "",
       subtitle = "",
       color = "Label & Hemisphere",
       fill = "Label & Hemisphere") +  
  scale_fill_manual(limit = c("ifrms.lh", "ifrms.rh", "spls.lh", "spls.rh"), 
                    labels = c("ifrms lh", "ifrms rh", "spls lh", "spls rh"),
                    values = c("firebrick", "#ef3b2c", "#238b45", "#4daf4a")) +
  scale_color_manual(limit = c("ifrms.lh", "ifrms.rh", "spls.lh", "spls.rh"), 
                     labels = c("ifrms lh", "ifrms rh", "spls lh", "spls rh"),
                     values = c("firebrick", "#ef3b2c", "#238b45", "#4daf4a")) + 
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(hjust = 0, size = 14),
        plot.caption = element_text(size = 12),
        axis.text=element_text(size=14),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 8, face = "bold", color = "black", vjust = .50), # was 12
        axis.text.y = element_text(size = 12, face = "bold"),
        strip.text.y = element_text(size = 12, face = "bold"),
        legend.title = element_text(size=10, face = "bold"), # was 14
        legend.text = element_text(size=8), # was 12
        legend.position = "bottom",
        axis.line = element_line(colour = "black", 
                                 size = 0, linetype = "solid", lineend = "round"),
        panel.grid.minor = element_line(size = 0.5, color = "gray"), 
        panel.grid.major = element_line(size = .75, color = "gray")) + 
  guides(fill = F) + 
  ylim(0,1) 
overlap_214019.plot

# ggplot2::ggsave(filename = "overlap_214019_plot.png",
#                 plot = overlap_214019.plot,
#                 device = "png",
#                 width = 4,
#                 height = 4, 
#                 units = "in",
#                 dpi = "retina")

```

### Q2: Is the location of the ifrms predictive of the location of control network B and/or control network C?
Linear regressions run with the right, anterior, and superior (RAS) coordinates of the ifrms predicting the RAS coordinates of Control B and Control C
* Predictor variable: RAS coordinates of the ifrms (see Methods for data acquisition procedure)
* Outcome variable: RAS coordinates of either control network B or control network C (see Methods for data acquisition procedure)
* Separate analyses were run for each coordinate (RAS), sample (discovery, replication), and hemisphere (lh, rh)
* FDR adjustment used to correct for multiple comparisons 

#### Discovery Sample
```{r, warning = FALSE}
# Dataset - all
RAS_analysis_all <- read.csv("~/Desktop/RMD_csvs/RAS_analysis_all.csv")

# Discovery dataset
RAS_analysis_all_disc <- RAS_analysis_all %>% subset(dataset == "HCP_discovery")

# Separate by hemisphere to analyze separately 
RAS_analysis_all_disc_lh <- RAS_analysis_all_disc %>% subset(hemi == "lh")
RAS_analysis_all_disc_rh <- RAS_analysis_all_disc %>% subset(hemi == "rh")

# Linear models

## Control B

### Right coordinate 
right_cb_disc_lh.lm <- lm(ControlB_R_coord ~ R_coord, data = RAS_analysis_all_disc_lh)
right_cb_disc_rh.lm <- lm(ControlB_R_coord ~ R_coord, data = RAS_analysis_all_disc_rh)
summary(right_cb_disc_lh.lm) # significant relationship, p<0.001
summary(right_cb_disc_rh.lm) # significant relationship, p<0.001

## Anterior coordinate
ant_cb_disc_lh.lm <- lm(ControlB_A_coord ~ A_coord, data = RAS_analysis_all_disc_lh)
ant_cb_disc_rh.lm <- lm(ControlB_A_coord ~ A_coord, data = RAS_analysis_all_disc_rh)
summary(ant_cb_disc_lh.lm) # significant relationship, p<0.001
summary(ant_cb_disc_rh.lm) # significant relationship, p<0.001

## Superior coordinate
sup_cb_disc_lh.lm <- lm(ControlB_S_coord ~ S_coord, data = RAS_analysis_all_disc_lh)
sup_cb_disc_rh.lm <- lm(ControlB_S_coord ~ S_coord, data = RAS_analysis_all_disc_rh)
summary(sup_cb_disc_lh.lm) # significant relationship, p<0.001
summary(sup_cb_disc_rh.lm) # significant relationship, p<0.001

## Control C 

### Right coordinate
right_cc_discovery_lh.mod <- lm(ControlC_R_coord ~ R_coord, data = RAS_analysis_all_disc_lh)
right_cc_discovery_rh.mod <- lm(ControlC_R_coord ~ R_coord, data = RAS_analysis_all_disc_rh)
summary(right_cc_discovery_lh.mod) # significant relationship, p<0.001
summary(right_cc_discovery_rh.mod) # significant relationship, p<0.001

### Anterior coordinate
ant_cc_disc_lh.lm <- lm(ControlC_A_coord ~ A_coord, data = RAS_analysis_all_disc_lh)
ant_cc_disc_rh.lm <- lm(ControlC_A_coord ~ A_coord, data = RAS_analysis_all_disc_rh)
summary(ant_cc_disc_lh.lm) # significant relationship, p<0.001
summary(ant_cc_disc_rh.lm) # significant relationship, p<0.001

### Superior coordinate
sup_cc_disc_lh.lm <- lm(ControlC_S_coord ~ S_coord, data = RAS_analysis_all_disc_lh)
sup_cc_disc_rh.lm <- lm(ControlC_S_coord ~ S_coord, data = RAS_analysis_all_disc_rh)
summary(sup_cc_disc_lh.lm) # significant relationship, p<0.001
summary(sup_cc_disc_rh.lm) # significant relationship, p<0.001
```

#### Replication Sample
```{r, warning = FALSE}
# Replication dataset
RAS_analysis_all_repl <- RAS_analysis_all %>% subset(dataset == "HCP_replication")

# Separate by hemisphere to analyze separately 
RAS_analysis_all_repl_lh <- RAS_analysis_all_repl %>% subset(hemi == "lh")
RAS_analysis_all_repl_rh <- RAS_analysis_all_repl %>% subset(hemi == "rh")

# Linear models

## Control B

### Right coordinate 
right_cb_repl_lh.lm <- lm(ControlB_R_coord ~ R_coord, data = RAS_analysis_all_repl_lh)
right_cb_repl_rh.lm <- lm(ControlB_R_coord ~ R_coord, data = RAS_analysis_all_repl_rh)
summary(right_cb_repl_lh.lm) # significant relationship, p<0.001
summary(right_cb_repl_rh.lm) # significant relationship, p<0.001

### Anterior coordinate
ant_cb_repl_lh.lm <- lm(ControlB_A_coord ~ A_coord, data = RAS_analysis_all_repl_lh)
ant_cb_repl_rh.lm <- lm(ControlB_A_coord ~ A_coord, data = RAS_analysis_all_repl_rh)
summary(ant_cb_repl_lh.lm) # significant relationship, p<0.001
summary(ant_cb_repl_rh.lm) # significant relationship, p<0.001

### Superior coordinate
sup_cb_repl_lh.lm <- lm(ControlB_S_coord ~ S_coord, data = RAS_analysis_all_repl_lh)
sup_cb_repl_rh.lm <- lm(ControlB_S_coord ~ S_coord, data = RAS_analysis_all_repl_rh)
summary(sup_cb_repl_lh.lm) # significant relationship, p<0.001
summary(sup_cb_repl_rh.lm) # significant relationship, p<0.001

## Control C

### Right coordinate 
right_cc_repl_lh.lm <- lm(ControlC_R_coord ~ R_coord, data = RAS_analysis_all_repl_lh)
right_cc_repl_rh.lm <- lm(ControlC_R_coord ~ R_coord, data = RAS_analysis_all_repl_rh)
summary(right_cc_repl_lh.lm) # significant relationship, p<0.001
summary(right_cc_repl_rh.lm) # significant relationship, p<0.001

### Anterior coordinate
ant_cc_repl_lh.lm <- lm(ControlC_A_coord ~ A_coord, data = RAS_analysis_all_repl_lh)
ant_cc_repl_rh.lm <- lm(ControlC_A_coord ~ A_coord, data = RAS_analysis_all_repl_rh)
summary(ant_cc_repl_lh.lm) # significant relationship, p<0.001
summary(ant_cc_repl_rh.lm) # significant relationship, p<0.001

### Superior coordinate
sup_cc_repl_lh.lm <- lm(ControlC_S_coord ~ S_coord, data = RAS_analysis_all_repl_lh)
sup_cc_repl_rh.lm <- lm(ControlC_S_coord ~ S_coord, data = RAS_analysis_all_repl_rh)
summary(sup_cc_repl_lh.lm) # significant relationship, p<0.001
summary(sup_cc_repl_rh.lm) # significant relationship, p<0.001
```

#### FDR adjustment for LMs
```{r, warning = FALSE}
# Adjust p-values for multiple comparisons

lg_p_values <- c(0.000638, 0.0006382, # right, lh CCNb
                 0.00703, 0.007029, # right, rh CCNb
                 0.00000618, 0.000006184, # anterior, lh CCNb
                 0.000084683827, 0.00008468, # anterior, rh CCNb
                 0.0000000000363, 0.00000000003629, # superior, lh CCNb
                 0.0000000000291, 0.00000000002915, # superior, rh CCNb
                 
                 0.0000138, 0.00001377, # right, lh CCNc
                 0.00162, 0.001617, # right, rh CCNc
                 0.000475, 0.0004753, # anterior, lh CCNc
                 0.00183, 0.001829, # anterior, rh CCNc
                 0.000000000376, 0.0000000003764, # superior, lh CCNc
                 0.000000000071, 0.000000000071, # superior, rh CCNc
                 
              
                 0.000024, 0.00002401, # right, lh CCNb
                 0.00662, 0.006616, # right, rh CCNb
                 0.000811, 0.0008115, # anterior, lh CCNb
                 0.00582, 0.005817, # anterior, rh CCNb
                 0.00000000228, 0.000000002278, # superior, lh CCNb
                 0.0000000000484, 0.00000000004838, # superior, rh CCNb
                 
                 0.00000103, 0.000001032, # right, lh CCNc
                 0.000573, 0.0005731, # right, rh CCNc
                 0.003919, 0.003919, # right, lh CCNc
                 0.000328, 0.0003281, # right, rh CCNc
                 0.000000000309, 0.0000000003095, # superior, lh CCNb
                 0.0000000000126, 0.00000000001258 # superior, rh CCNb
)

p.adjust(p = lg_p_values,
  method = "fdr")
```

##### Results for functional analyses Q2
Altogether, as indicated by the linear regression results presented in Table 4 for CCN-b and Table 5 for CCN-c, the topographical location of the *ifrms* was predictive of the location of both control networks in both samples. The more rightward, anterior, and superior the coordinates of the *ifrms* were, the more rightward, anterior, and superior the nearby CCN-b and CCN-c components were. See Figure 7 in the main text or in the plots below. 

#### Figure 5b: Locational coupling between the *ifrms* and CCN-b network
```{r, warning = FALSE}
# Discovery Sample

## Figure 5B (left): Discovery and replication anterior coordinate 
Ant_CB.plot <- ggplot(RAS_analysis_all,
           aes(x = A_coord, y = ControlB_A_coord)) + 
   geom_jitter(aes(fill = dataset), shape = 21) + #, fill = '#ff7f00') 
   geom_smooth(method = "lm", aes(color = dataset, fill = dataset)) + #, color = "black") + 
   facet_grid(~ hemi) +
   labs(x = "ifrms anterior coordinate",
        y = "control b anterior coordinate") + 
   theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
         plot.subtitle = element_text(size = 12),
         plot.caption = element_text(size = 12, hjust = 1),
         axis.title.x = element_text(size=14, face = "bold"),
         axis.title.y = element_text(size=14, face = "bold"),
         axis.text.x = element_text(size = 12, face = "bold"),
         axis.text.y = element_text(size = 12, face = "bold"),
         legend.title = element_text(size=14), 
         legend.text = element_text(size=12),
         strip.text.x = element_text(size = 14, face = "bold"), # was 12
         strip.background = element_blank(),
         axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
   guides(fill = F, color = F) + 
   scale_fill_manual(breaks = c("HCP_discovery", "HCP_replication"),
                    values = c('#d95f02', '#fdb863')) +
   scale_color_manual(breaks = c("HCP_discovery", "HCP_replication"),
                     values = c('#d95f02', '#fdb863')) + 
   scale_x_continuous(breaks = seq(-27, 4, 6)) + 
   scale_y_continuous(breaks = seq(-27, 0, 4))
Ant_CB.plot

# ggplot2::ggsave(filename = "Ant_CB_all_plot.png",
#                  plot = Ant_CB.plot,
#                  device = "png",
#                  width = 8,
#                  height = 4, 
#                  units = "in",
#                  dpi = "retina") 

## Figure 5B (right): Discovery and replication superior coordinate 
Sup_CB.plot <- ggplot(RAS_analysis_all,
   aes(x = S_coord, y = ControlB_S_coord)) + 
   geom_jitter(aes(fill = dataset), shape = 21) + #fill = '#ff7f00', shape = 21) + 
   geom_smooth(method = "lm", aes(color = dataset, fill = dataset)) + #color = "black") +
   facet_grid(~ hemi) +
   labs(x = "ifrms superior coordinate",
        y = "control b superior coordinate") + 
   theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
         plot.subtitle = element_text(size = 12),
         plot.caption = element_text(size = 12, hjust = 1),
         axis.title.x = element_text(size=14, face = "bold"),
         axis.title.y = element_text(size=14, face = "bold"),
         axis.text.x = element_text(size = 12, face = "bold"),
         axis.text.y = element_text(size = 12, face = "bold"),
         legend.title = element_text(size=14), 
         legend.text = element_text(size=12),
         strip.text.x = element_text(size = 14, face = "bold"), # was 12
         strip.background = element_blank(),
         axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
   guides(fill = F, color = F) +
   scale_fill_manual(breaks = c("HCP_discovery", "HCP_replication"),
                    values = c('#d95f02', '#fdb863')) +
   scale_color_manual(breaks = c("HCP_discovery", "HCP_replication"),
                     values = c('#d95f02', '#fdb863')) +
   scale_x_continuous(breaks = seq(0, 30, 5)) + 
   scale_y_continuous(breaks = seq(0, 30, 5))

Sup_CB.plot

# ggplot2::ggsave(filename = "Sup_CB_all_plot.png",
#                  plot = Sup_CB.plot,
#                  device = "png",
#                  width = 8,
#                  height = 4, 
#                  units = "in",
#                  dpi = "retina") 
```

#### Figure 5c: Locational coupling between the *ifrms* and CCN-c network
```{r, warning = FALSE}
# Discovery Sample

## Figure 5C (left): Discovery and replication anterior coordinate 
Ant_CC.plot <- ggplot(RAS_analysis_all,
           aes(x = A_coord, y = ControlC_A_coord)) + 
   geom_jitter(aes(fill = dataset), shape = 21) + #, fill = '#ff7f00') 
   geom_smooth(method = "lm", aes(color = dataset, fill = dataset)) + #, color = "black") + 
   facet_grid(~ hemi) +
   labs(x = "ifrms anterior coordinate",
        y = "control c anterior coordinate") + 
   theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
         plot.subtitle = element_text(size = 12),
         plot.caption = element_text(size = 12, hjust = 1),
         axis.title.x = element_text(size=14, face = "bold"),
         axis.title.y = element_text(size=14, face = "bold"),
         axis.text.x = element_text(size = 12, face = "bold"),
         axis.text.y = element_text(size = 12, face = "bold"),
         legend.title = element_text(size=14), 
         legend.text = element_text(size=12),
         strip.text.x = element_text(size = 14, face = "bold"), # was 12
         strip.background = element_blank(),
         axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
   guides(fill = F, color = F) + 
   scale_fill_manual(breaks = c("HCP_discovery", "HCP_replication"),
                    values = c('#386cb0', '#6baed6')) +
   scale_color_manual(breaks = c("HCP_discovery", "HCP_replication"),
                     values = c('#386cb0', '#6baed6')) + 
   scale_x_continuous(breaks = seq(-25, 5, 5)) + 
   scale_y_continuous(breaks = seq(-25, 5, 5))
Ant_CC.plot

# ggplot2::ggsave(filename = "Ant_CC_all_plot.png",
#                  plot = Ant_CC.plot,
#                  device = "png",
#                  width = 8,
#                  height = 4, 
#                  units = "in",
#                  dpi = "retina") 

# Figure 5C (right): Discovery and replication superior coordinate 
Sup_CC.plot <- ggplot(RAS_analysis_all,
   aes(x = S_coord, y = ControlC_S_coord)) + 
   geom_jitter(aes(fill = dataset), shape = 21) + #fill = '#ff7f00', shape = 21) + 
   geom_smooth(method = "lm", aes(color = dataset, fill = dataset)) + #color = "black") +
   facet_grid(~ hemi) +
   labs(x = "ifrms superior coordinate",
        y = "control c superior coordinate") + 
   theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
         plot.subtitle = element_text(size = 12),
         plot.caption = element_text(size = 12, hjust = 1),
         axis.title.x = element_text(size=14, face = "bold"),
         axis.title.y = element_text(size=14, face = "bold"),
         axis.text.x = element_text(size = 12, face = "bold"),
         axis.text.y = element_text(size = 12, face = "bold"),
         legend.title = element_text(size=14), 
         legend.text = element_text(size=12),
         strip.text.x = element_text(size = 14, face = "bold"), # was 12
         strip.background = element_blank(),
         axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
   guides(fill = F, color = F) +
   scale_fill_manual(breaks = c("HCP_discovery", "HCP_replication"),
                    values = c('#386cb0', '#6baed6')) +
   scale_color_manual(breaks = c("HCP_discovery", "HCP_replication"),
                     values = c('#386cb0', '#6baed6')) + 
   scale_x_continuous(breaks = seq(0, 25, 5)) + 
   scale_y_continuous(breaks = seq(0, 25, 5))

Sup_CC.plot

# ggplot2::ggsave(filename = "Sup_CC_all_plot.png",
#                  plot = Sup_CC.plot,
#                  device = "png",
#                  width = 8,
#                  height = 4, 
#                  units = "in",
#                  dpi = "retina") 
```

# Comparative and Developmental Analyses

### Q1: Can the *ifrms* be identified across the lifespan in both humans and chimpanzees? 

#### Figure 6b: Presence comparison
```{r, warning = FALSE}
# Dataset
perc2 <- read.csv("~/Desktop/RMD_csvs/percent_present_age.csv")

# Features for the plot
perc2$age_species <- factor(perc2$age_species, 
                            levels = c("young_human", "young_chimp", 
                                       "young_adult_human", "young_adult_chimp", 
                                       "older_adult_human", "older_adult_chimp")) 

per2_total <- perc2 %>% subset(hemisphere == "total")
perc2_other <- perc2 %>% subset(hemisphere %in% c("lh", "rh", "none"))
perc2_other$hemisphere <- factor(perc2_other$hemisphere, levels = c("none", "lh", "rh"))

xticks_label <- c("juvenile \nhuman", "juvenile \nchimp", 
                  "young adult \nhuman", "young adult \nchimp", 
                  "older \nhuman", "older \nchimp")

# Plot

## raw hemi 
compdev_count.plot <- ggplot(perc2_other, aes(x = age_species)) +
  geom_col(data = perc2_other, aes(y = Amount, fill = hemisphere),
           color = 'black') + 
  scale_y_continuous(name = "number of hemispheres", seq(0,144,18), limits = c(0,144)) +
  labs(x = "age and species") + 
  scale_fill_manual(breaks = c("lh", "rh", "none"),
                    values = c("#404040", "#bababa", "#ffffff")
                    ) + 
  scale_x_discrete(breaks=c("young_human", "young_chimp", 
                            "young_adult_human", "young_adult_chimp", 
                            "older_adult_human", "older_adult_chimp"),
                   labels=xticks_label) +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=18, face = "bold"), # was 20
        axis.text.x = element_text(size = 5, face = "bold"), # was 16
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=8),
        strip.text.x = element_text(size = 10),
        legend.position="bottom", 
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")
        ) + 
  guides() 

compdev_count.plot

## as percent
compdev_count.plot <- ggplot(perc2_other, aes(x = age_species)) +
  geom_col(data = perc2_other, aes(y = percent, fill = hemisphere),
           color = 'black') + 
  scale_y_continuous(name = "% of hemispheres", seq(0, 100, 25), limits = c(0,100)) +
  labs(x = "age and species") + 
  scale_fill_manual(breaks = c("lh", "rh", "none"),
                    values = c("#404040", "#bababa", "#ffffff")
                    ) + 
  scale_x_discrete(breaks=c("young_human", "young_chimp", 
                            "young_adult_human", "young_adult_chimp", 
                            "older_adult_human", "older_adult_chimp"),
                   labels=xticks_label) +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=18, face = "bold"), # was 20
        axis.text.x = element_text(size = 5, face = "bold"), # was 16
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=8),
        strip.text.x = element_text(size = 10),
        legend.position="bottom", 
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")
        ) + 
  guides() 

compdev_count.plot

# ggplot2::ggsave(filename = "compdev_count_percent_plot.png",
#                  plot = compdev_count.plot,
#                  device = "png",
#                  width = 10,
#                  height = 5, 
#                  units = "in",
#                  dpi = "retina")
```

#### Results for comparative/developmental analyses Q1
In addition to being present every hemisphere in the young adult human sample, the *ifrms* is present in every hemisphere in our juvenile and healthy older adult human samples. However, the *ifrms* is less consistent in chimpanzees, being present in about half of the hemispheres included in our sample.

### Q2: Is the depth (normalized) of the *ifrms* different across the lifepsan and between species? 
* 3-way (age group x species x hemi) ANOVA to test for differences in normalized depth
* age group: juvenile, young adult, older adult
* species: human, chimpanzee
* hemi: lh, rh

#### Statistical analyses
```{r, warning = FALSE}
# Dataset - used for all comp/dev morphological analyses
ifrms_compdev_morphology <- read.csv("~/Desktop/RMD_csvs/ifrms_compdev_morphology.csv")

# ANOVA 
comp_norm_depth.aov <- aov(depth_pct_max ~ hemi * group * species, data = ifrms_compdev_morphology)
summary(comp_norm_depth.aov)
rstatix::anova_summary(comp_norm_depth.aov, effect.size = "ges") #Eta-squared

# Main effect of hemisphere
ifrms_compdev_morphology %>% group_by(hemi) %>% summarise(mean = mean(depth_pct_max))

# Main effect of group
ifrms_compdev_morphology %>% group_by(group) %>% summarise(mean = mean(depth_pct_max))

# Main effect of group
ifrms_compdev_morphology %>% group_by(species) %>% summarise(mean = mean(depth_pct_max))
```

#### Results for comparative/developmental analyses Q2
The 3-way ANOVA with factors of hemisphere (left, right), age group (juvenile, young adult, older), and species (human, chimpanzee) yielded three main findings. First, there was a main effect of hemisphere (F(1, 475) = 15.43, p < 0.001,  η2G = 0.03), wherein the *ifrms* was generally deeper in the left compared to the right hemisphere, replicating trends found in young adults. Second, there was a main effect of age group (F(1, 475) = 10.68,  p < 0.001,  η2G = 0.04), in which the *ifrms* was deeper in the juvenile and older age groups than in the younger adult group—primarily in humans. Third, there was a main effect of species (F(1, 475) = 6.85, p = 0.009,  η2G = 0.01), where the *ifrms* was deeper in humans than in chimpanzees. Therefore, while the *ifrms* is consistently shallow relative to primary and secondary sulci across species and age groups, its depth differs across age groups and between species. See Figure 8c in the main text or in the plot below.

#### Figure 6c: Normalized depth comparison
```{r, warning = FALSE}
# Organize factors in order
ifrms_compdev_morphology$dataset <- factor(ifrms_compdev_morphology$dataset, 
                                           levels = c("NORA", "young_chimp", 
                                                      "HCP", "young_adult_chimp", 
                                                      "ADNI", "older_adult_chimp"))

# Means for plot
comp_depth_avg <- ifrms_compdev_morphology %>% 
  group_by(label, dataset, hemi) %>% 
  summarise(depth_pct_max = mean(depth_pct_max))
comp_depth_sd <- ifrms_compdev_morphology %>% 
  group_by(label, dataset, hemi) %>% 
  summarise(sd = sd(depth_pct_max))
comp_depth_stats <- merge(comp_depth_avg, comp_depth_sd, by = c("label", "dataset", "hemi"))

# Features for plot
comp_depth_title <- expression(atop(bold("sulcal depth"), paste(italic("(% of max depth)"))))
comp_norm_x <- expression(paste(bold("age and species")))

# Plot
comp_depth.plot <- ggplot(data = ifrms_compdev_morphology, aes(x = label, y = depth_pct_max)) +
  geom_violin(aes(x = label, y = depth_pct_max, fill = dataset), alpha = .6, position = dodge, width = 1) + 
  geom_jitter(aes(x = label, y = depth_pct_max, fill = dataset), alpha = .8, shape = 21, color = 'black',
              position=position_jitterdodge(jitter.width = .3, dodge.width = .9, jitter.height = 0)) +
  geom_pointrange(data = comp_depth_stats, 
                  aes(label, depth_pct_max, ymin=depth_pct_max-sd, ymax=depth_pct_max+sd, fill = dataset), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
  labs(x = comp_norm_x,
       y = comp_depth_title) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=20, face = "bold"),
        axis.text.x = element_text(size = 0, face = "bold", vjust = .70),
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14, face = "bold"), 
        legend.text = element_text(size=6),
        legend.position = "bottom",        
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round"),
        strip.text.x = element_text(size = 12, face = "bold"),
        axis.ticks.x = element_blank(), 
        strip.background = element_blank()) + 
  scale_color_manual(breaks = 
                       c("NORA", "young_chimp", "HCP", "young_adult_chimp", "ADNI", "older_adult_chimp"),
                     values = c("#e41a1c", "#f03b20","#377eb8", "#41b6c4", "#006837", "#2ca25f")) + 
  scale_fill_manual(breaks = 
                      c("NORA", "young_chimp", "HCP", "young_adult_chimp", "ADNI", "older_adult_chimp"),
                    values = c("#e41a1c", "#f03b20","#377eb8", "#74a9cf", "#006837", "#31a354")) +
  
  guides(alpha = F) + 
  facet_wrap(~hemi)
comp_depth.plot

# ggplot2::ggsave(filename = "comp_depth_plot.png",
#                 plot = comp_depth.plot,
#                 device = "png",
#                 width = 10,
#                 height = 5, 
#                 units = "in",
#                 dpi = "retina")
```

### Q3: Does the cortical thickness (normalized) of the *ifrms* differ across the lifespan and between species? 
* 3-way (age group x species x hemi) ANOVA to test for differences in normalized cortical thickness
* age group: juvenile, young adult, older adult
* species: human, chimpanzee
* hemi: lh, rh

#### Statistical analyses 
```{r, warning = FALSE}
# ANOVA
comp_norm_thick.aov<- aov(label_mean_thickness_pct_max ~ hemi * group * species, 
                          data = ifrms_compdev_morphology)
summary(comp_norm_thick.aov)
rstatix::anova_summary(comp_norm_thick.aov, effect.size = "ges") # Eta-squared

# Main effect of group
ifrms_compdev_morphology %>% group_by(group) %>% summarise(mean = mean(label_mean_thickness_pct_max))

# Main effect of species
ifrms_compdev_morphology %>% group_by(species) %>% summarise(mean = mean(label_mean_thickness_pct_max))

# Interaction effect between hemi and species
ifrms_compdev_morphology %>% group_by(hemi, species) %>% summarise(mean = mean(label_mean_thickness_pct_max))
```

#### Results for comparative/developmental analyses Q3
The 3-way ANOVA with hemisphere (left, right), age group (juvenile, young adult, older), and species (human, chimpanzee) as factors yielded main effects of age group (F(1, 475) = 135.37, p < 0.001,  η2G = 0.33) and species (F(1, 475) = 63.59,  p < 0.001,  η2G = 0.08). Specifically, the *ifrms* showed a decline in cortical thickness from the juvenile to young adult to older age group. At each age group, the thickness of the *ifrms* was less in chimpanzees than in humans. Interestingly, there was also a hemisphere x species interaction (F(1, 475) = 6.98, p = 0.009,  η2G = 0.008), where the *ifrms* in chimpanzees was thicker in the right hemisphere. Thus, the *ifrms* shows a prominent age- and species-related decline in cortical thickness across age groups and species. See Figure 8d in the main text or in the plot below.

#### Figure 6d: Normalized thickness comparison
```{r, warning = FALSE}
# Means for plot
norm_ct_avg <- ifrms_compdev_morphology %>% 
  group_by(label, dataset, hemi) %>% 
  summarise(label_mean_thickness_pct_max = mean(label_mean_thickness_pct_max))
norm_ct_sd <- ifrms_compdev_morphology %>% 
  group_by(label, dataset, hemi) %>% 
  summarise(sd = sd(label_mean_thickness_pct_max))
norm_ct_stats <- merge(norm_ct_avg, norm_ct_sd, by = c("label", "dataset", "hemi"))

# Features for plot
comp_norm_x <- expression(paste(bold("age and species")))
comp_norm_title <- expression(atop(bold("mean cortical thickness"), paste(italic("(% of max thickness)"))))

# Plot
comp_ct.plot <- ggplot(data = ifrms_compdev_morphology, aes(x = label, y = label_mean_thickness_pct_max)) +
  geom_violin(data = ifrms_compdev_morphology, 
              aes(x = label, y = label_mean_thickness_pct_max, fill = dataset), 
              alpha = .6, position = dodge, width = 1) + 
  geom_jitter(data = ifrms_compdev_morphology, 
              aes(x = label, y = label_mean_thickness_pct_max, fill = dataset), 
              color = 'black', alpha = .8, shape = 21,
              position=position_jitterdodge(jitter.width = .4, dodge.width = .9, jitter.height = 0)) +
  geom_pointrange(data = norm_ct_stats, 
                  aes(label, label_mean_thickness_pct_max, 
                      ymin=label_mean_thickness_pct_max-sd, 
                      ymax=label_mean_thickness_pct_max+sd, fill = dataset), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
  labs(x = comp_norm_x,
       y = comp_norm_title) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=20, face = "bold"),
        axis.text.x = element_text(size = 0, face = "bold"),
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14, face = "bold"), 
        legend.text = element_text(size=6),
        axis.ticks.x = element_blank(), 
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round"),
        strip.text.x = element_text(size = 12, face = "bold"),
        legend.position = "bottom",
        strip.background = element_blank()) + 
  scale_color_manual(breaks = 
                       c("NORA", "young_chimp", "HCP", "young_adult_chimp", "ADNI", "older_adult_chimp"),
                     values = c("#e41a1c", "#f03b20","#377eb8", "#41b6c4", "#006837", "#2ca25f")) + 
  scale_fill_manual(breaks = 
                      c("NORA", "young_chimp", "HCP", "young_adult_chimp", "ADNI", "older_adult_chimp"),
                    values = c("#e41a1c", "#f03b20","#377eb8", "#74a9cf", "#006837", "#31a354")) +
  guides(color = F, alpha = F) + 
  scale_y_continuous(breaks=seq(0,1,.1)) +
  facet_wrap(~hemi)
comp_ct.plot

# ggplot2::ggsave(filename = "comp_ct_plot.png",
#                 plot = comp_ct.plot,
#                 device = "png",
#                 width = 10,
#                 height = 5, 
#                 units = "in",
#                 dpi = "retina")
```

# Predictive Labeling Analyses

### Q1a: Is the *ifrms* able to be predicted with cortex based alignment and/or spherical convolutional neural network approaches?
* To download the code used to define sulci with the cortex based alignment (CBA) method see: (CNL github link)
* To download the code used to define sulci with the spherical convolutional neural networks (CNN) method see: https://ilwoolyu.github.io/#Software
* The methodologies and results are described on the main text

### Q1b: Do these methodologies differ in their accuracy?
* Paired t-test comparing the accuracies (DICE coefficient; IV; see Methods) of these two methods (IV)
* method: CBA, spherical CNN
* metric: DICE coefficient 

```{r, warning = FALSE}
# CNN Dataset - all
pmc_nn_predicts <- read.csv("~/Desktop/RMD_csvs/pmc_cnn_predicts.csv")

# CNN Dataset - ifrms only
pmc_nn_predicts.ifrms <- pmc_nn_predicts %>% subset(sulci == "ifrms") %>% select(-c("X", "type"))

# CBA Dataset 
ifrms_cba_predicts.ifrms <- read.csv("~/Desktop/RMD_csvs/HCP_dice_coefficients_all_72_predicts.csv")

# Average across hemispheres (since cnn only analyzed in left hemisphere)
ifrms_cba_predicts.ifrms.avg <- ifrms_cba_predicts.ifrms %>%
                                group_by(sub, sulci, method) %>%
                                    summarise(dice = mean(dice)) 

# Combine for analysis
ifrms_predicts.both <- rbind(pmc_nn_predicts.ifrms, ifrms_cba_predicts.ifrms.avg)

# T-test comparing CNN to CBA (mean of lh and rh for each participant)
t.test(ifrms_predicts.both$dice ~ ifrms_predicts.both$method, paired= T)
rstatix::cohens_d(data = ifrms_predicts.both,
         formula = dice ~ method, 
         paired= T)
```

#### Results for morphological analyses Q1b
We found that spherical CNNs were more accurate (t(71) = -3.69, p < 0.001, d = -0.435) at predicting the *ifrms*’ location than CBA (CNN: M = 0.61, SE = 0.03; CBA: M = 0.5, SE = 0.02). See Figure 5a in the main text or in the plot below.

### Figure 7a-b: Evaluation of predictive labeling methodologies
```{r, warning = FALSE}
# Figure 7a: Bar plot 

# Means for plot
ifrms_predicts_mean <- ifrms_predicts.both %>% 
  group_by(sulci, method) %>% 
  summarise(dice = mean(dice))
ifrms_predicts_sd <- ifrms_predicts.both %>% 
  group_by(sulci, method) %>% 
  summarise(n=n(), sd=sd(dice), se=sd/sqrt(n))
ifrms_pred_stats <- merge(ifrms_predicts_mean, ifrms_predicts_sd, by = c("sulci", "method"))

# Plot
dice_y_2 <- expression(atop(bold("predictability"), paste(italic("(DICE coeff.)"))))

prediction_comp.plot <- ggplot() +
  geom_col(data = ifrms_pred_stats, aes(x = method, y = dice, fill = method), 
           color = 'black', alpha = .6, position = dodge) +
  geom_jitter(data = ifrms_predicts.both, 
              aes(x = method, y = dice, fill = method, color = method), 
              alpha = .8, shape = 21,
              position=
                position_jitterdodge(jitter.width = .3, dodge.width = .9, jitter.height = 0)) +
  geom_errorbar(data = ifrms_pred_stats, 
                aes(method, ymin=dice-se, ymax=dice+se),
                width = .25, size = .75) +
  xlim("CBA", "CNN") +
  guides(fill = FALSE, color = FALSE) +
  scale_color_manual(breaks = 
                       c("CBA", "CNN"),
                     values = c( "#252525","#252525")) + 
  scale_fill_manual(breaks = c("CBA", "CNN"),
    values = c("firebrick", "#ef3b2c")) + 
  labs(x = "labeling method",
       y = dice_y_2) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=20, face = "bold"),
        axis.text.x = element_text(size = 18, face = "bold", vjust = .70),
        axis.text.y = element_text(size = 18, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        strip.text.x = element_text(size = 10),
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  scale_y_continuous(breaks=seq(0,1,.25), limits=c(0,1))
prediction_comp.plot

# ggplot2::ggsave(filename = "prediction_comp_plot.png",
#                 plot = prediction_comp.plot,
#                 device = "png",
#                 width = 5,
#                 height = 5,
#                 units = "in",
#                 dpi = "retina")


# Figure 7b: Distribution plot

prediction_dist.plot <- ggplot(ifrms_predicts.both, aes(x = dice, color= method, linetype = method)) +
  geom_density(size = 1, alpha = .5) +
  scale_color_manual(breaks = c("CBA", "CNN"),
                     values = c("firebrick", "#ef3b2c")) + 
   labs(x = "DICE coeff. values")  +
  scale_linetype_manual(breaks = c("CBA", "CNN"),
                        values = c("dashed", "solid")) + 
   labs(x = "DICE coeff. values") + 
  geom_vline(aes(xintercept=0.87),
             linetype="dashed", size = 1.05, color = 'black') +
  geom_vline(aes(xintercept=0.64),
             linetype="dashed", size = 1.05, color = 'black') +
  geom_vline(aes(xintercept=0.09),
             linetype="dashed", size = 1.05, color = 'black') +
  xlim(0,1) +
  scale_y_continuous(breaks=seq(0,2.5, .75)) +

  guides(color = F, fill = F, linetype = F) +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
          plot.subtitle = element_text(size = 12),
          plot.caption = element_text(size = 12, hjust = 1),
          axis.title.x = element_text(size=18, face = "bold", vjust = .9),
          axis.title.y = element_text(size=18, face = "bold", vjust = .9),
          axis.title.y.right = element_text(size=20, face = "bold", vjust = 1),
          axis.text.x = element_text(size = 14, face = "bold", vjust = .70),
          axis.text.y = element_text(size = 18, face = "bold"),
          legend.title = element_text(size=12), 
          legend.text = element_text(size=10),
          strip.text.x = element_text(size = 16, face = "bold"),
          strip.background = element_blank(),
          strip.placement = "outside",
          axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) 
prediction_dist.plot

# ggplot2::ggsave(filename = "prediction_dist_plot.png",
#                 plot = prediction_dist.plot,
#                 device = "png",
#                 width = 10,
#                 height = 5, 
#                 units = "in",
#                 dpi = "retina")
```


# Supplementary Analyses and Figures 

## Confirming the accuracy of algorithmically determined sulcal depth against post-mortem values
```{r}
mcgs_comparison.disc.lh <- HCP_disc_depth_PCC %>% subset(label %in% c("mcgs") & hemi == "lh")
mcgs_comparison.disc.lh <- mcgs_comparison.disc.lh[1:25,]
mcgs_comparison.disc.rh <- HCP_disc_depth_PCC %>% subset(label %in% c("mcgs") & hemi == "rh")
mcgs_comparison.disc.rh <- mcgs_comparison.disc.rh[1:25,]

spls_comparison.disc.lh <- HCP_disc_depth_PCC %>% subset(label %in% c("spls") & hemi == "lh")
spls_comparison.disc.lh <- spls_comparison.disc.lh[1:25,]
spls_comparison.disc.rh <- HCP_disc_depth_PCC %>% subset(label %in% c("spls") & hemi == "rh")
spls_comparison.disc.rh <- spls_comparison.disc.rh[1:25,]

pos_comparison.disc.lh <- HCP_disc_depth_PCC %>% subset(label %in% c("pos") & hemi == "lh")
pos_comparison.disc.lh <- pos_comparison.disc.lh[1:25,]
pos_comparison.disc.rh <- HCP_disc_depth_PCC %>% subset(label %in% c("pos") & hemi == "rh")
pos_comparison.disc.rh <- pos_comparison.disc.rh[1:25,]

ono_comparison_disc <- rbind(mcgs_comparison.disc.lh, mcgs_comparison.disc.rh, 
                             spls_comparison.disc.lh, spls_comparison.disc.rh,
                             pos_comparison.disc.lh, pos_comparison.disc.rh)

mcgs_comparison.rep.lh <- HCP_rep_depth_PCC %>% subset(label %in% c("mcgs") & hemi == "lh")
mcgs_comparison.rep.lh <- mcgs_comparison.rep.lh[1:25,]
mcgs_comparison.rep.rh <- HCP_rep_depth_PCC %>% subset(label %in% c("mcgs") & hemi == "rh")
mcgs_comparison.rep.rh <- mcgs_comparison.rep.rh[1:25,]

spls_comparison.rep.lh <- HCP_rep_depth_PCC %>% subset(label %in% c("spls") & hemi == "lh")
spls_comparison.rep.lh <- spls_comparison.rep.lh[1:25,]
spls_comparison.rep.rh <- HCP_rep_depth_PCC %>% subset(label %in% c("spls") & hemi == "rh")
spls_comparison.rep.rh <- spls_comparison.rep.rh[1:25,]

pos_comparison.rep.lh <- HCP_rep_depth_PCC %>% subset(label %in% c("pos") & hemi == "lh")
pos_comparison.rep.lh <- pos_comparison.rep.lh[1:25,]
pos_comparison.rep.rh <- HCP_rep_depth_PCC %>% subset(label %in% c("pos") & hemi == "rh")
pos_comparison.rep.rh <- pos_comparison.rep.rh[1:25,]

ono_comparison_rep <- rbind(mcgs_comparison.rep.lh, mcgs_comparison.rep.rh,
                            spls_comparison.rep.lh, spls_comparison.rep.rh,
                            pos_comparison.rep.lh, pos_comparison.rep.rh
)

ono_comparison_disc %>% subset(label %in% c("pos", "mcgs", "spls")) %>% 
  group_by(label, hemi) %>% 
  summarise(
           range = range(sulcal_depth_mm))

ono_comparison_rep %>% subset(label %in% c("pos", "mcgs", "spls")) %>% 
  group_by(label, hemi) %>% 
  summarise(
           range = range(sulcal_depth_mm)
           )
```
See Supplementary Materials for comparison.

## Supplementary Figure 2.1: Incidence rates of all 11 sulci
```{r, warning = FALSE}
# Discovery dataset plot  
HCP_count_disc_11.plot <- ggplot(HCP_count_disc, aes(x = Sulcus)) +
  geom_col(data = HCP_count_disc, aes(y = Amount, fill = Type), color = 'black') + 
  xlim("pos", "prculs", "prcus-p", "prcus-i", "prcus-a", "spls", "sps", "mcgs", "sspls", "ifrms", "icgs-p") +
  scale_y_continuous(name = "number of hemispheres", seq(0,72,6), limits = c(0,72)) +
  labs(x = "PCC and PRC sulci", 
       y = "# of hemispheres") + 
  scale_fill_manual(breaks = c("lh", "rh", "none"),
                    values = c("#404040", "#bababa", "#ffffff")
                    ) +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size = 20, face = "bold", vjust = .70),
        axis.title.y = element_text(size = 18, face = "bold"), # was 20
        axis.text.x = element_text(size = 7, face = "bold", vjust = .70), # was 16
        axis.text.y = element_text(size = 16, face = "bold"), # was 20
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        legend.position="bottom", 
        strip.text.x = element_text(size = 10),
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) + 
  guides() 
HCP_count_disc_11.plot

#ggplot2::ggsave(filename = "sulc_count_disc_11.png",
#                 plot = HCP_count_disc_11.plot,
#                 device = "png",
#                 width = 10,
#                 height = 5, 
#                 units = "in",
#                 dpi = "retina")


# Replication dataset plot
HCP_count_rep_11.plot <- ggplot(HCP_count_rep, aes(x = Sulcus)) +
  geom_col(data = HCP_count_rep, aes(y = Amount, fill = Type), color = 'black') + 
  xlim("pos", "prculs", "prcus-p", "prcus-i", "prcus-a", "spls", "sps", "mcgs", "sspls", "ifrms", "icgs-p") +
  scale_y_continuous(name = "number of hemispheres", seq(0,72,6), limits = c(0,72)) +
  labs(x = "PCC and PRC sulci", 
       y = "# of hemispheres") + 
  scale_fill_manual(breaks = c("lh", "rh", "none"),
                    values = c("#404040", "#bababa", "#ffffff")
                    ) +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=18, face = "bold"), # was 20
        axis.text.x = element_text(size = 8, face = "bold", vjust = .70), # was 16
        axis.text.y = element_text(size = 16, face = "bold"), # was 20
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        legend.position="bottom", 
        strip.text.x = element_text(size = 10),
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) + 
  guides() 
HCP_count_rep_11.plot

#ggplot2::ggsave(filename = "sulc_count_rep_11.png",
#                plot = HCP_count_rep_11.plot,
#                device = "png",
#                width = 10,
#                height = 5, 
#               units = "in",
#               dpi = "retina")
```

## Supplementary Figure 2.1: Depth of all 11 sulci 

### Statistics 
* Focusing on the three *prcus* since this is the first study to consistently identify three in-vivo)
* Determining if the three PCC tertiary sulci (*sspls*, *ifrms*, *icgs-p*) are the shallowest of the 11 definable PMC sulci

* 2-way (sulcal label x hemi) ANOVA to test for differences in depth (mm)
* sulcal label: 11 PMC (PCC & PRC) sulci (see Methods for description)
* hemi: lh, rh

#### Discovery
```{r, warning = FALSE}
# Dataset - all
HCP_all_morphology <- read.csv("~/Desktop/RMD_csvs/HCP_all_morphology.csv")

# Discovery dataset
HCP_all_morphology_disc <- HCP_all_morphology %>% subset(dataset == "HCP_discovery")

# ANOVA
all_depth_disc.aov <- aov(sulcal_depth_mm ~ hemi * label, HCP_all_morphology_disc)
summary(all_depth_disc.aov)
rstatix::anova_summary(all_depth_disc.aov, effect.size = "ges") #Eta-squared

# Post hoc tests
disc_all_depth.m1 <- emmeans::emmeans(all_depth_disc.aov,'label')
emmeans::contrast(disc_all_depth.m1, method='pairwise')

disc_all_depth.m2 <- emmeans::emmeans(all_depth_disc.aov, 'hemi')
emmeans::contrast(disc_all_depth.m2, method='pairwise')
```

#### Results (discovery)
We observed a main effect of sulcus (F(10, 706) = 268.58, p < 0.001,  η2G = 0.79) and a trending effect of hemisphere (F(1, 706) = 3.67, p = 0.056,  η2G = 0.001), where sulci in the left hemisphere were deeper. Post hoc tests on the former effect revealed three takeaways regarding the PRC sulci. First, the three *prcus* were the shallowest of the PRC sulci, but deeper on average than the PCC tertiary sulci (p-values < 0.001, Tukey’s adjustment). Second, the *prcus-p* was shallower than *prcus-i* and *prcus-a* (p-values < 0.001), while *prcus-i* and *prcus-a* had more comparable depths (p > 0.05, Tukey’s adjustment). However, it is important to note that the depth of these three sulci vary greatly between individuals. Third, the *prculs* was shallower than the *pos* (p < 0.001, Tukey’s adjustment). Finally,  the three putative PCC tertiary sulci are all shallower than the five PRC sulci (*prculs*, *prcus-p*, *prcus-i*, *prcus-a*, *sps*) that were not included in the initial depth analyses (p-values < 0.001, Tukey’s adjustment). See Supplementary Figure 1b in the supplementary materials or in the plot below.

#### Replication
```{r, warning = FALSE}
# Replication sample 
HCP_all_morphology_rep <- HCP_all_morphology %>% subset(dataset == "HCP_replication")

# ANOVA
all_depth_rep.aov <- aov(sulcal_depth_mm ~ hemi * label, HCP_all_morphology_rep)
summary(all_depth_rep.aov)
rstatix::anova_summary(all_depth_rep.aov, effect.size = "ges") #Eta-squared

# Post hoc tests
rep_all_depth.m1 <- emmeans::emmeans(all_depth_rep.aov,'label')
emmeans::contrast(rep_all_depth.m1, method='pairwise')

rep_all_depth.m2 <- emmeans::emmeans(all_depth_rep.aov, 'hemi')
emmeans::contrast(rep_all_depth.m2, method='pairwise')

rep_all_depth.i1 <- emmeans::emmeans(all_depth_rep.aov,'hemi','label')
emmeans::contrast(rep_all_depth.i1, method='pairwise')
```

#### Results (replication)
Once again, main effects of sulcus (F(10, 702) = 302.94, p < 0.001,  η2G = 0.8) and hemisphere were observed (F(1, 702) = 19.83, p < 0.001,  η2G = 0.005). For the latter main effect, the PCC and PRC sulci were once again deeper in the left hemisphere on average. Post hoc tests on the former main effect confirmed the main findings in the discovery sample. Lastly, there was a sulcus x hemisphere interaction (F(10, 702) = 19.83, p < 0.001,  η2G = 0.005). Post hoc analyses indicated that the effect was driven by the *mcgs* and *prcus-a* being significantly deeper in the left hemisphere (p-values < 0.05, Tukey’s adjustment), the *prcus-p* and *spls* being marginally deeper in the left hemisphere (p-values < 0.08, Tukey’s adjustment), and the *pos* being marginally deeper in the right hemisphere (p = 0.07, Tukey’s adjustment). See Supplementary Figure 1d in the supplementary materials or in the plot below.

### Plots
```{r, warning = FALSE}
# Discovery dataset 
all_depth_2_disc <- HCP_all_morphology_disc

## Means for plot
all_depth_2_disc_tert <- all_depth_2_disc %>% subset(label %in% c("sspls", "ifrms", "icgs-p"))
all_depth_tert_means_disc <- all_depth_2_disc_tert %>% 
  group_by(label, label2) %>% 
  summarise(sulcal_depth_mm = mean(sulcal_depth_mm))
all_depth_2_tert_sd_disc <- all_depth_2_disc_tert %>% 
  group_by(label, label2) %>% 
  summarise(sd = sd(sulcal_depth_mm),
            n = n(),
            se = sd/sqrt(n))
all_depth_tert_stats_disc <- merge(all_depth_tert_means_disc, all_depth_2_tert_sd_disc, 
                                   by = c("label", "label2"))

all_depth_ntert_disc <- all_depth_2_disc %>% subset(label %in% c("pos", "prculs", 
                                                                 "prcus-p", "prcus-i", "prcus-a",
                                                                  "sps", "spls", "mcgs"))
all_depth_n_means_disc <- all_depth_ntert_disc %>% 
  group_by(label, label2) %>% 
  summarise(sulcal_depth_mm = mean(sulcal_depth_mm))
all_depth_n_sd_disc <- all_depth_ntert_disc %>% 
  group_by(label, label2) %>% 
  summarise(sd = sd(sulcal_depth_mm),
            n = n(),
            se = sd/sqrt(n))
all_depth_n_stats_disc <- merge(all_depth_n_means_disc, all_depth_n_sd_disc, by = c("label", "label2"))


# Plot
depth_y <- expression(paste(bold("sulcal depth "), italic("(mm)")))

all_sulc_depth_disc.plot <- ggplot() +
  geom_violin(data = all_depth_2_disc_tert, aes(x = label, y = sulcal_depth_mm, fill = label2), 
              alpha = .6, position = dodge, width = 1.2) + 
  geom_jitter(data = all_depth_2_disc_tert, aes(x = label, y = sulcal_depth_mm, fill = label2, color = label2), 
              alpha = .8, shape = 21,
              position=position_jitterdodge(jitter.width = .3, dodge.width = .9, jitter.height = 0)) +
  geom_pointrange(data = all_depth_tert_stats_disc, 
                  aes(label, sulcal_depth_mm, ymin=sulcal_depth_mm-sd, ymax=sulcal_depth_mm+sd, fill = label2), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
  
  geom_violin(data = all_depth_ntert_disc, aes(x = label, y = sulcal_depth_mm, fill = label2), 
              alpha = .6, position = dodge, width = 1.1) + 
  geom_jitter(data = all_depth_ntert_disc, aes(x = label, y = sulcal_depth_mm, fill = label2, color = label2), 
              alpha = .8, shape = 21,
              position=position_jitterdodge(jitter.width = .3, 
                                            dodge.width = .9, 
                                            jitter.height = 0)) +
  geom_pointrange(data = all_depth_n_stats_disc, 
                  aes(label, sulcal_depth_mm, ymin=sulcal_depth_mm-sd, ymax=sulcal_depth_mm+sd, fill = label2), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
  xlim("pos", "prculs", "prcus-p", "prcus-i", "prcus-a", "spls", "sps", "mcgs", "sspls", "ifrms", "icgs-p") +
  guides(fill = FALSE, color = FALSE) +
  scale_color_manual(breaks = 
                       c("POS LH", "POS RH",
                         "prculs LH", "prculs RH",
                         "prcus-p LH", "prcus-p RH",
                         "prcus-i LH", "prcus-i RH",
                         "prcus-a LH", "prcus-a RH",
                         "sps LH", "sps RH",
                         "spls LH", "spls RH",
                         "MCGS LH", "MCGS RH",
                         "sspls LH", "sspls RH",
                         "ifrms LH", "ifrms RH",
                         "icgs-p LH", "icgs-p RH"),
                     values = c( "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363")) + 
  scale_fill_manual(breaks = c("POS LH", "POS RH",
                               "prculs LH", "prculs RH",
                         "prcus-p LH", "prcus-p RH",
                         "prcus-i LH", "prcus-i RH",
                         "prcus-a LH", "prcus-a RH",
                         "sps LH", "sps RH",
                               "spls LH", "spls RH",
                               "MCGS LH", "MCGS RH",
    "sspls LH", "sspls RH",
    "ifrms LH", "ifrms RH",
    "icgs-p LH", "icgs-p RH"),
    values = c("#6a51a3", "#807dba", #POS
               "#9e9ac8", "#cbc9e2", #prculs
               "#006d2c","#31a354", #prcus-p
               "darkolivegreen","darkolivegreen4", #prcus-i
               "darkolivegreen3","darkolivegreen2", #prcus-a
               "#045a8d", "#2b8cbe", #sps
               "#238b45", "#74c476", #spls"
               "#2c7fb8", "#41b6c4", #mcgs
      "chartreuse4", "chartreuse", #sspls
      "firebrick", "#ef3b2c", #ifrms
      "cadetblue", "cadetblue1")) + #icgs-p
  labs(x = "PCC and PRC sulci",
       y = depth_y) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=20, face = "bold"),
        axis.text.x = element_text(size = 7, face = "bold", vjust = .70), # was 16
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        strip.text.x = element_text(size = 10), 
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  scale_y_continuous(breaks=seq(0,26,2), limits = c(0,26))
all_sulc_depth_disc.plot

#ggplot2::ggsave(filename = "all_sulc_depth_disc_plot.png",
#                 plot = all_sulc_depth_disc.plot,
#                 device = "png",
#                 width = 10,
#                 height = 5, 
#                 units = "in",
#                 dpi = "retina")


# Replication dataset 
all_depth_2_rep <- HCP_all_morphology_rep


## Means for plot
all_depth_tert_rep <- all_depth_2_rep %>% subset(label %in% c("sspls", "ifrms", "icgs-p"))
all_tert_depth_means_rep <- all_depth_tert_rep %>% 
  group_by(label, label2) %>% 
  summarise(sulcal_depth_mm = mean(sulcal_depth_mm))
all_tert_depth_sd_rep <- all_depth_tert_rep %>% 
  group_by(label, label2) %>% 
  summarise(sd = sd(sulcal_depth_mm),
            n = n(),
            se = sd/sqrt(n))
all_tert_stats_rep <- merge(all_tert_depth_means_rep, all_tert_depth_sd_rep, by = c("label", "label2"))

all_depth_ntert_rep <- all_depth_2_rep %>% subset(label %in% c("pos", "prculs","prcus-p", "prcus-i", 
                                                                                     "prcus-a", "sps", 
                                                                                     "spls", "mcgs"))
all_n_depth_means_rep <- all_depth_ntert_rep %>% 
  group_by(label, label2) %>% 
  summarise(sulcal_depth_mm = mean(sulcal_depth_mm))
all_n_depth_sd_rep <- all_depth_ntert_rep %>% 
  group_by(label, label2) %>% 
  summarise(sd = sd(sulcal_depth_mm),
            n = n(),
            se = sd/sqrt(n))
all_n_stats_rep <- merge(all_n_depth_means_rep, all_n_depth_sd_rep, by = c("label", "label2"))


# Plot
depth_y <- expression(paste(bold("sulcal depth "), italic("(mm)")))

all_sulc_depth_repl.plot <- ggplot() +
  geom_violin(data = all_depth_tert_rep, aes(x = label, y = sulcal_depth_mm, fill = label2), 
              alpha = .6, position = dodge, width = 1.2) + 
  geom_jitter(data = all_depth_tert_rep, aes(x = label, y = sulcal_depth_mm, fill = label2, color = label2), 
              alpha = .8, shape = 21,
              position=position_jitterdodge(jitter.width = .3, dodge.width = .9, jitter.height = 0)) +
  geom_pointrange(data = all_tert_stats_rep, 
                  aes(label, sulcal_depth_mm, ymin=sulcal_depth_mm-sd, ymax=sulcal_depth_mm+sd, fill = label2), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
  
  geom_violin(data = all_depth_ntert_rep, aes(x = label, y = sulcal_depth_mm, fill = label2), 
              alpha = .6, position = dodge, width = 1) + 
  geom_jitter(data = all_depth_ntert_rep, aes(x = label, y = sulcal_depth_mm, fill = label2, color = label2), 
              alpha = .8, shape = 21,
              position=position_jitterdodge(jitter.width = .3, 
                                            dodge.width = .9, 
                                            jitter.height = 0)) +
  geom_pointrange(data = all_n_stats_rep, 
                  aes(label, sulcal_depth_mm, ymin=sulcal_depth_mm-sd, ymax=sulcal_depth_mm+sd, fill = label2), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
   xlim("pos", "prculs", "prcus-p", "prcus-i", "prcus-a", "spls", "sps", "mcgs", "sspls", "ifrms", "icgs-p") +
  guides(fill = FALSE, color = FALSE) +
  scale_color_manual(breaks = 
                       c("POS LH", "POS RH",
                         "prculs LH", "prculs RH",
                         "prcus-p LH", "prcus-p RH",
                         "prcus-i LH", "prcus-i RH",
                         "prcus-a LH", "prcus-a RH",
                         "sps LH", "sps RH",
                         "spls LH", "spls RH",
                         "MCGS LH", "MCGS RH",
                         "sspls LH", "sspls RH",
                         "ifrms LH", "ifrms RH",
                         "icgs-p LH", "icgs-p RH"),
                     values = c( "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363")) + 
  scale_fill_manual(breaks = c("POS LH", "POS RH",
                               "prculs LH", "prculs RH",
                         "prcus-p LH", "prcus-p RH",
                         "prcus-i LH", "prcus-i RH",
                         "prcus-a LH", "prcus-a RH",
                         "sps LH", "sps RH",
                               "spls LH", "spls RH",
                               "MCGS LH", "MCGS RH",
    "sspls LH", "sspls RH",
    "ifrms LH", "ifrms RH",
    "icgs-p LH", "icgs-p RH"),
    values = c("#6a51a3", "#807dba", #POS
               "#9e9ac8", "#cbc9e2", #prculs
               "#006d2c","#31a354", #prcus-p
               "darkolivegreen","darkolivegreen4", #prcus-i
               "darkolivegreen3","darkolivegreen2", #prcus-a
               "#045a8d", "#2b8cbe", #sps
               "#238b45", "#74c476", #spls"
               "#2c7fb8", "#41b6c4", #mcgs
      "chartreuse4", "chartreuse", #sspls
      "firebrick", "#ef3b2c", #ifrms
      "cadetblue", "cadetblue1")) + #icgs-p
  labs(x = "PCC and PRC sulci",
       y = depth_y) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=20, face = "bold"),
        axis.text.x = element_text(size = 7, face = "bold", vjust = .70), # was 16
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        strip.text.x = element_text(size = 10),
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  scale_y_continuous(breaks=seq(0,26,2), limits = c(0,26))
all_sulc_depth_repl.plot

#ggplot2::ggsave(filename = "all_sulc_depth_repl_plot.png",
#                 plot = all_sulc_depth_repl.plot,
#                 device = "png",
#                 width = 10,
#                 height = 5, 
#                 units = "in",
#                 dpi = "retina")
```

## Supplementary Figure 2.1: Surface area of PCC and PrC sulci 

### Statistics 
* Focusing on the differences in surface area between the three shallower putative tertiary sulci in PCC (*sspls*, *ifrms*, *icgs-p*) and other PCC/PRC sulci because, in addition to having a shallower depth, tertiary sulci typically have a reduced surface area compared to primary and secondary sulci.

* 2-way (sulcus x hemi) ANOVA to test for differences in surface area (mm^2)
* sulcal label: 11 PMC (PCC & PRC) sulci (see Methods for description)
* hemi: lh, rh

#### Discovery
```{r, warning = FALSE}
# Discovery dataset

# ANOVA
all_sa_disc.aov <- aov(total_surface_area_.mm.2. ~ hemi * label, HCP_all_morphology_disc)
summary(all_sa_disc.aov)
rstatix::anova_summary(all_sa_disc.aov, effect.size = "ges") #Eta-squared

# Post hoc tests
disc_all_sa.m1 <- emmeans::emmeans(all_depth_disc.aov,'label')
emmeans::contrast(disc_all_sa.m1, method='pairwise')
```

#### Results (discovery)
We observed a main effect of sulcus (F(10, 706) = 215.24, p < 0.001,  η2G = 0.75). Post hoc analyses on this main effect revealed that the three putative tertiary sulci have the smallest surface area of the PCC and PRC sulci defined here (p-values < 0.001, Tukey’s adjustment). See Supplementary Figure 1x in the supplementary materials or in the plot below.

#### Replication
```{r, warning = FALSE}
# Replication sample 

# ANOVA
all_sa_rep.aov <- aov(total_surface_area_.mm.2. ~ hemi * label, HCP_all_morphology_rep)
summary(all_sa_rep.aov)
rstatix::anova_summary(all_sa_rep.aov, effect.size = "ges") #Eta-squared

# Post hoc tests
rep_all_sa.m1 <- emmeans::emmeans(all_sa_rep.aov,'label')
emmeans::contrast(rep_all_sa.m1, method='pairwise')

rep_all_sa.i1 <- emmeans::emmeans(all_sa_rep.aov,'hemi','label')
emmeans::contrast(rep_all_sa.i1, method='pairwise')
```

#### Results (replication)
Once again, a main effect of sulcus (F(10, 702) = 154.43, p < 0.001, η2G = 0.67) was observed. Post hoc analyses confirmed the findings in the discovery sample (p-values < 0.001, Tukey’s adjustment). In addition, there was a sulcus x hemisphere interaction (F(10, 702) = 4.28, p < 0.001, η2G = 0.019). Post hoc analyses revealed that this effect was driven by the *pos* having a smaller surface area in the left hemisphere (p < 0.001, Tukey’s adjustment). See Supplementary Figure 1x in the supplementary materials or in the plot below.

### Plots
```{r, warning = FALSE}
# Discovery dataset 

## Means for plot
HCP_all_morphology_disc_tert <- HCP_all_morphology_disc %>% subset(label %in% c("sspls", "ifrms", "icgs-p"))
HCP_all_morphology_disc_tert_sa_means <- HCP_all_morphology_disc_tert %>% 
  group_by(label, label2) %>% 
  summarise(total_surface_area_.mm.2. = mean(total_surface_area_.mm.2.)/100)
HCP_all_morphology_disc_tert_sa_sd <- HCP_all_morphology_disc_tert %>% 
  group_by(label, label2) %>% 
  summarise(sd = sd(total_surface_area_.mm.2.)/100,
            n = n(),
            se = sd/sqrt(n))
HCP_all_morphology_disc_tert_sa_stats <- merge(HCP_all_morphology_disc_tert_sa_means, 
                                               HCP_all_morphology_disc_tert_sa_sd, 
                                   by = c("label", "label2"))

HCP_all_morphology_disc_ntert <- HCP_all_morphology_disc %>% subset(label %in% c("pos", "prculs", 
                                                                 "prcus-p", "prcus-i", "prcus-a",
                                                                  "sps", "spls", "mcgs"))
HCP_all_morphology_disc_ntert_sa_means <- HCP_all_morphology_disc_ntert %>% 
  group_by(label, label2) %>% 
  summarise(total_surface_area_.mm.2. = mean(total_surface_area_.mm.2.)/100)
HCP_all_morphology_disc_ntert_sa_sd <- HCP_all_morphology_disc_ntert %>% 
  group_by(label, label2) %>% 
  summarise(sd = sd(total_surface_area_.mm.2.)/100,
            n = n(),
            se = sd/sqrt(n))
HCP_all_morphology_disc_ntert_sa_stats <- merge(HCP_all_morphology_disc_ntert_sa_means,
                                                HCP_all_morphology_disc_ntert_sa_sd, 
                                                by = c("label", "label2"))


# Plot
sa_y <- expression(paste(bold("total surface area "), italic("(mm^2)")))

## Tertiary Plot
HCP_all_morphology_disc_sa_tert.plot <- ggplot() +
  geom_violin(data = HCP_all_morphology_disc_tert, aes(x = label, y = total_surface_area_.mm.2., fill = label2), 
              alpha = .6, position = dodge, width = 1.2) + 
  geom_jitter(data = HCP_all_morphology_disc_tert, aes(x = label, y = total_surface_area_.mm.2., fill = label2,
                                                       color = label2), 
              alpha = .8, shape = 21,
              position=position_jitterdodge(jitter.width = .3, dodge.width = .9, jitter.height = 0)) +
  geom_pointrange(data = HCP_all_morphology_disc_tert_sa_stats, 
                  aes(label, total_surface_area_.mm.2., ymin=total_surface_area_.mm.2.-sd,
                      ymax=total_surface_area_.mm.2.+sd, 
                      fill = label2), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
  xlim("sspls", "ifrms", "icgs-p") +
  guides(fill = FALSE, color = FALSE) +
  scale_color_manual(breaks = 
                       c("sspls LH", "sspls RH",
                         "ifrms LH", "ifrms RH",
                         "icgs-p LH", "icgs-p RH"),
                     values = c("#252525", "#636363",
                                "#252525", "#636363",
                                "#252525", "#636363")) + 
  scale_fill_manual(breaks = c( "sspls LH", "sspls RH",
                                "ifrms LH", "ifrms RH",
                                "icgs-p LH", "icgs-p RH"),
    values = c("chartreuse4", "chartreuse", #sspls
               "firebrick", "#ef3b2c", #ifrms
               "cadetblue", "cadetblue1")) + #icgs-p
  labs(x = "shallower sulci",
       y = sa_y) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=20, face = "bold"),
        axis.text.x = element_text(size = 16, face = "bold", vjust = .70), # was 7
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        strip.text.x = element_text(size = 10), 
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  scale_y_continuous(breaks=seq(0,300,50), limits =c(-10, 300))
HCP_all_morphology_disc_sa_tert.plot

# ggplot2::ggsave(filename = "HCP_all_morphology_disc_sa_tert_plot.png",
#                  plot = HCP_all_morphology_disc_sa_tert.plot,
#                  device = "png",
#                  width = 10,
#                  height = 5, 
#                  units = "in",
#                  dpi = "retina")

HCP_all_morphology_disc_sa_ntert.plot <- ggplot() +
  geom_violin(data = HCP_all_morphology_disc_ntert, aes(x = label, y = total_surface_area_.mm.2./100, 
                                                        fill = label2), 
              alpha = .6, position = dodge, width = 1.1) + 
  geom_jitter(data = HCP_all_morphology_disc_ntert, aes(x = label, y = total_surface_area_.mm.2./100, 
                                                        fill = label2, color = label2), 
              alpha = .8, shape = 21,
              position=position_jitterdodge(jitter.width = .3, 
                                            dodge.width = .9, 
                                            jitter.height = 0)) +
  geom_pointrange(data = HCP_all_morphology_disc_ntert_sa_stats, 
                  aes(label, total_surface_area_.mm.2., ymin=total_surface_area_.mm.2.-sd,
                      ymax=total_surface_area_.mm.2.+sd, 
                      fill = label2), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
  xlim("pos", "prculs", "prcus-p", "prcus-i", "prcus-a", "spls", "sps", "mcgs") +
  guides(fill = FALSE, color = FALSE) +
  scale_color_manual(breaks = 
                       c("POS LH", "POS RH",
                         "prculs LH", "prculs RH",
                         "prcus-p LH", "prcus-p RH",
                         "prcus-i LH", "prcus-i RH",
                         "prcus-a LH", "prcus-a RH",
                         "sps LH", "sps RH",
                         "spls LH", "spls RH",
                         "MCGS LH", "MCGS RH"
                          ),
                     values = c( "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363"
                                  )) + 
  scale_fill_manual(breaks = c("POS LH", "POS RH",
                               "prculs LH", "prculs RH",
                         "prcus-p LH", "prcus-p RH",
                         "prcus-i LH", "prcus-i RH",
                         "prcus-a LH", "prcus-a RH",
                         "sps LH", "sps RH",
                               "spls LH", "spls RH",
                               "MCGS LH", "MCGS RH"
                              ),
    values = c("#6a51a3", "#807dba", #POS
               "#9e9ac8", "#cbc9e2", #prculs
               "#006d2c","#31a354", #prcus-p
               "darkolivegreen","darkolivegreen4", #prcus-i
               "darkolivegreen3","darkolivegreen2", #prcus-a
               "#045a8d", "#2b8cbe", #sps
               "#238b45", "#74c476", #spls"
               "#2c7fb8", "#41b6c4" #mcgs
                )) + 
  labs(x = "deeper sulci",
       y = sa_y) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=20, face = "bold"),
        axis.text.x = element_text(size = 16, face = "bold", vjust = .70), # was 7
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        strip.text.x = element_text(size = 10), 
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  scale_y_continuous(breaks=seq(0,20,2), limits = c(0, 20))
HCP_all_morphology_disc_sa_ntert.plot

# ggplot2::ggsave(filename = "HCP_all_morphology_disc_sa_ntert_plot.png",
#                  plot = HCP_all_morphology_disc_sa_ntert.plot,
#                  device = "png",
#                  width = 10,
#                  height = 5, 
#                  units = "in",
#                  dpi = "retina")

HCP_all_morphology_disc_sa.plot <- ggplot() +
  geom_violin(data = HCP_all_morphology_disc_ntert, aes(x = label, y = total_surface_area_.mm.2./100, 
                                                        fill = label2), 
              alpha = .6, position = dodge, width = 1.1) + 
  geom_jitter(data = HCP_all_morphology_disc_ntert, aes(x = label, y = total_surface_area_.mm.2./100, 
                                                        fill = label2, color = label2), 
              alpha = .8, shape = 21,
              position=position_jitterdodge(jitter.width = .3, 
                                            dodge.width = .9, 
                                            jitter.height = 0)) +
  geom_pointrange(data = HCP_all_morphology_disc_ntert_sa_stats, 
                  aes(label, total_surface_area_.mm.2., ymin=total_surface_area_.mm.2.-sd, 
                      ymax=total_surface_area_.mm.2.+sd, 
                      fill = label2), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
  geom_violin(data = HCP_all_morphology_disc_tert, aes(x = label, y = total_surface_area_.mm.2./100, 
                                                       fill = label2), 
              alpha = .6, position = dodge, width = 1.2) + 
  geom_jitter(data = HCP_all_morphology_disc_tert, aes(x = label, y = total_surface_area_.mm.2./100, 
                                                       fill = label2, color = label2), 
              alpha = .8, shape = 21,
              position=position_jitterdodge(jitter.width = .3, dodge.width = .9, jitter.height = 0)) +
  geom_pointrange(data = HCP_all_morphology_disc_tert_sa_stats, 
                  aes(label, total_surface_area_.mm.2., ymin=total_surface_area_.mm.2.-sd,
                      ymax=total_surface_area_.mm.2.+sd, 
                      fill = label2), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
  xlim("pos", "prculs", "prcus-p", "prcus-i", "prcus-a", "spls", "sps", "mcgs", "sspls", "ifrms", "icgs-p") +
  guides(fill = FALSE, color = FALSE) +
  scale_color_manual(breaks = 
                       c("POS LH", "POS RH",
                         "prculs LH", "prculs RH",
                         "prcus-p LH", "prcus-p RH",
                         "prcus-i LH", "prcus-i RH",
                         "prcus-a LH", "prcus-a RH",
                         "sps LH", "sps RH",
                         "spls LH", "spls RH",
                         "MCGS LH", "MCGS RH",
                         "sspls LH", "sspls RH",
                                "ifrms LH", "ifrms RH",
                                "icgs-p LH", "icgs-p RH"
                          ),
                     values = c( "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363"
                                  )) + 
  scale_fill_manual(breaks = c("POS LH", "POS RH",
                               "prculs LH", "prculs RH",
                         "prcus-p LH", "prcus-p RH",
                         "prcus-i LH", "prcus-i RH",
                         "prcus-a LH", "prcus-a RH",
                         "sps LH", "sps RH",
                               "spls LH", "spls RH",
                               "MCGS LH", "MCGS RH",
                         "sspls LH", "sspls RH",
                                "ifrms LH", "ifrms RH",
                                "icgs-p LH", "icgs-p RH"
                              ),
    values = c("#6a51a3", "#807dba", #POS
               "#9e9ac8", "#cbc9e2", #prculs
               "#006d2c","#31a354", #prcus-p
               "darkolivegreen","darkolivegreen4", #prcus-i
               "darkolivegreen3","darkolivegreen2", #prcus-a
               "#045a8d", "#2b8cbe", #sps
               "#238b45", "#74c476", #spls"
               "#2c7fb8", "#41b6c4", #mcgs
               "chartreuse4", "chartreuse", #sspls
               "firebrick", "#ef3b2c", #ifrms
               "cadetblue", "cadetblue1")) + #icgs-p 
  labs(x = "PCC and PRC sulci",
       y = sa_y) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=20, face = "bold"),
        axis.text.x = element_text(size = 16, face = "bold", vjust = .70), # was 7
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        strip.text.x = element_text(size = 10), 
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round"))
HCP_all_morphology_disc_sa.plot

#ggplot2::ggsave(filename = "HCP_all_morphology_disc_sa_plot.png",
#                 plot = HCP_all_morphology_disc_sa.plot,
#                 device = "png",
#                 width = 10,
#                 height = 5, 
#                 units = "in",
#                 dpi = "retina")


# Replication dataset 

## Means for plot
HCP_all_morphology_rep_tert <- HCP_all_morphology_rep %>% subset(label %in% c("sspls", "ifrms", "icgs-p"))
HCP_all_morphology_rep_tert_means <- HCP_all_morphology_rep_tert %>% 
  group_by(label, label2) %>% 
  summarise(total_surface_area_.mm.2. = mean(total_surface_area_.mm.2.)/100)
HCP_all_morphology_rep_tert_sd <- HCP_all_morphology_rep_tert %>% 
  group_by(label, label2) %>% 
  summarise(sd = sd(total_surface_area_.mm.2.)/100,
            n = n(),
            se = sd/sqrt(n))
HCP_all_morphology_rep_tert_stats <- merge(HCP_all_morphology_rep_tert_means, HCP_all_morphology_rep_tert_sd, 
                                           by = c("label", "label2"))

HCP_all_morphology_rep_ntert <- HCP_all_morphology_rep %>% subset(label %in% c("pos", "prculs","prcus-p",
                                                                               "prcus-i", 
                                                                                     "prcus-a", "sps", 
                                                                                     "spls", "mcgs"))
HCP_all_morphology_rep_ntert_means <- HCP_all_morphology_rep_ntert %>% 
  group_by(label, label2) %>% 
  summarise(total_surface_area_.mm.2. = mean(total_surface_area_.mm.2.)/100)
HCP_all_morphology_rep_ntert_sd <- HCP_all_morphology_rep_ntert %>% 
  group_by(label, label2) %>% 
  summarise(sd = sd(total_surface_area_.mm.2.)/100,
            n = n(),
            se = sd/sqrt(n))
HCP_all_morphology_rep_ntert_stats <- merge(HCP_all_morphology_rep_ntert_means, HCP_all_morphology_rep_ntert_sd,
                                            by = c("label", "label2"))


# Tertiary plot
HCP_all_morphology_rep_sa_tert.plot <- ggplot() +
  geom_violin(data = HCP_all_morphology_rep_tert, aes(x = label, y = total_surface_area_.mm.2., fill = label2), 
              alpha = .6, position = dodge, width = 1.2) + 
  geom_jitter(data = HCP_all_morphology_rep_tert, aes(x = label, y = total_surface_area_.mm.2., fill = label2, 
                                                      color = label2), 
              alpha = .8, shape = 21,
              position=position_jitterdodge(jitter.width = .3, dodge.width = .9, jitter.height = 0)) +
  geom_pointrange(data = HCP_all_morphology_rep_tert_stats, 
                  aes(label, total_surface_area_.mm.2., ymin=total_surface_area_.mm.2.-sd, 
                      ymax=total_surface_area_.mm.2.+sd, 
                      fill = label2), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
   xlim("sspls", "ifrms", "icgs-p") +
  guides(fill = FALSE, color = FALSE) +
  scale_color_manual(breaks = 
                       c("sspls LH", "sspls RH",
                         "ifrms LH", "ifrms RH",
                         "icgs-p LH", "icgs-p RH"),
                     values = c(
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363")) + 
  scale_fill_manual(breaks = c(
    "sspls LH", "sspls RH",
    "ifrms LH", "ifrms RH",
    "icgs-p LH", "icgs-p RH"),
    values = c(
      "chartreuse4", "chartreuse", #sspls
      "firebrick", "#ef3b2c", #ifrms
      "cadetblue", "cadetblue1")) + #icgs-p
  labs(x = "shallower sulci",
       y = sa_y) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=20, face = "bold"),
        axis.text.x = element_text(size = 16, face = "bold", vjust = .70), # was 16
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        strip.text.x = element_text(size = 10),
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  scale_y_continuous(breaks=seq(0,300,50), limits =c(-10, 300))
HCP_all_morphology_rep_sa_tert.plot

# ggplot2::ggsave(filename = "HCP_all_morphology_rep_sa_tert_plot.png",
#                   plot = HCP_all_morphology_rep_sa_tert.plot,
#                   device = "png",
#                   width = 10,
#                   height = 5, 
#                   units = "in",
#                   dpi = "retina")

HCP_all_morphology_rep_sa_ntert.plot <- ggplot() +
  geom_violin(data = HCP_all_morphology_rep_ntert, aes(x = label, y = total_surface_area_.mm.2./100, 
                                                       fill = label2), 
              alpha = .6, position = dodge, width = 1) + 
  geom_jitter(data = HCP_all_morphology_rep_ntert, aes(x = label, y = total_surface_area_.mm.2./100., 
                                                       fill = label2, color = label2), 
              alpha = .8, shape = 21,
              position=position_jitterdodge(jitter.width = .3, 
                                            dodge.width = .9, 
                                            jitter.height = 0)) +
  geom_pointrange(data = HCP_all_morphology_rep_ntert_stats, 
                  aes(label, total_surface_area_.mm.2., ymin=total_surface_area_.mm.2.-sd,
                      ymax=total_surface_area_.mm.2.+sd, 
                      fill = label2), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
   xlim("pos", "prculs", "prcus-p", "prcus-i", "prcus-a", "spls", "sps", "mcgs") +
  guides(fill = FALSE, color = FALSE) +
  scale_color_manual(breaks = 
                       c("POS LH", "POS RH",
                         "prculs LH", "prculs RH",
                         "prcus-p LH", "prcus-p RH",
                         "prcus-i LH", "prcus-i RH",
                         "prcus-a LH", "prcus-a RH",
                         "sps LH", "sps RH",
                         "spls LH", "spls RH",
                         "MCGS LH", "MCGS RH",
                         "sspls LH", "sspls RH",
                         "ifrms LH", "ifrms RH",
                         "icgs-p LH", "icgs-p RH"),
                     values = c( "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363")) + 
  scale_fill_manual(breaks = c("POS LH", "POS RH",
                               "prculs LH", "prculs RH",
                         "prcus-p LH", "prcus-p RH",
                         "prcus-i LH", "prcus-i RH",
                         "prcus-a LH", "prcus-a RH",
                         "sps LH", "sps RH",
                               "spls LH", "spls RH",
                               "MCGS LH", "MCGS RH",
    "sspls LH", "sspls RH",
    "ifrms LH", "ifrms RH",
    "icgs-p LH", "icgs-p RH"),
    values = c("#6a51a3", "#807dba", #POS
               "#9e9ac8", "#cbc9e2", #prculs
               "#006d2c","#31a354", #prcus-p
               "darkolivegreen","darkolivegreen4", #prcus-i
               "darkolivegreen3","darkolivegreen2", #prcus-a
               "#045a8d", "#2b8cbe", #sps
               "#238b45", "#74c476", #spls"
               "#2c7fb8", "#41b6c4", #mcgs
      "chartreuse4", "chartreuse", #sspls
      "firebrick", "#ef3b2c", #ifrms
      "cadetblue", "cadetblue1")) + #icgs-p
  labs(x = "deeper sulci",
       y = sa_y) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=20, face = "bold"),
        axis.text.x = element_text(size = 16, face = "bold", vjust = .70), # was 16
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        strip.text.x = element_text(size = 10),
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  scale_y_continuous(breaks=seq(0,20,2), limits = c(0, 20))
HCP_all_morphology_rep_sa_ntert.plot

# ggplot2::ggsave(filename = "HCP_all_morphology_rep_sa_ntert_plot.png",
#                  plot = HCP_all_morphology_rep_sa_ntert.plot,
#                  device = "png",
#                  width = 10,
#                  height = 5, 
#                  units = "in",
#                  dpi = "retina")


HCP_all_morphology_rep_sa.plot <- ggplot() +
  geom_violin(data = HCP_all_morphology_rep_ntert, aes(x = label, y = total_surface_area_.mm.2./100, 
                                                       fill = label2), 
              alpha = .6, position = dodge, width = 1) + 
  geom_jitter(data = HCP_all_morphology_rep_ntert, aes(x = label, y = total_surface_area_.mm.2./100, 
                                                       fill = label2, color = label2), 
              alpha = .8, shape = 21,
              position=position_jitterdodge(jitter.width = .3, 
                                            dodge.width = .9, 
                                            jitter.height = 0)) +
  geom_pointrange(data = HCP_all_morphology_rep_ntert_stats, 
                  aes(label, total_surface_area_.mm.2., ymin=total_surface_area_.mm.2.-sd,
                      ymax=total_surface_area_.mm.2.+sd, 
                      fill = label2), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
geom_violin(data = HCP_all_morphology_rep_tert, aes(x = label, y = total_surface_area_.mm.2./100, fill = label2), 
              alpha = .6, position = dodge, width = 1.2) + 
  geom_jitter(data = HCP_all_morphology_rep_tert, aes(x = label, y = total_surface_area_.mm.2./100, fill = label2,
                                                      color = label2), 
              alpha = .8, shape = 21,
              position=position_jitterdodge(jitter.width = .3, dodge.width = .9, jitter.height = 0)) +
  geom_pointrange(data = HCP_all_morphology_rep_tert_stats, 
                  aes(label, total_surface_area_.mm.2., ymin=total_surface_area_.mm.2.-sd,
                      ymax=total_surface_area_.mm.2.+sd, 
                      fill = label2), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
xlim("pos", "prculs", "prcus-p", "prcus-i", "prcus-a", "spls", "sps", "mcgs", "sspls", "ifrms", "icgs-p") +
  guides(fill = FALSE, color = FALSE) +
  scale_color_manual(breaks = 
                       c("POS LH", "POS RH",
                         "prculs LH", "prculs RH",
                         "prcus-p LH", "prcus-p RH",
                         "prcus-i LH", "prcus-i RH",
                         "prcus-a LH", "prcus-a RH",
                         "sps LH", "sps RH",
                         "spls LH", "spls RH",
                         "MCGS LH", "MCGS RH",
                         "sspls LH", "sspls RH",
                                "ifrms LH", "ifrms RH",
                                "icgs-p LH", "icgs-p RH"
                          ),
                     values = c( "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363",
                                 "#252525", "#636363"
                                  )) + 
  scale_fill_manual(breaks = c("POS LH", "POS RH",
                               "prculs LH", "prculs RH",
                         "prcus-p LH", "prcus-p RH",
                         "prcus-i LH", "prcus-i RH",
                         "prcus-a LH", "prcus-a RH",
                         "sps LH", "sps RH",
                               "spls LH", "spls RH",
                               "MCGS LH", "MCGS RH",
                         "sspls LH", "sspls RH",
                                "ifrms LH", "ifrms RH",
                                "icgs-p LH", "icgs-p RH"
                              ),
    values = c("#6a51a3", "#807dba", #POS
               "#9e9ac8", "#cbc9e2", #prculs
               "#006d2c","#31a354", #prcus-p
               "darkolivegreen","darkolivegreen4", #prcus-i
               "darkolivegreen3","darkolivegreen2", #prcus-a
               "#045a8d", "#2b8cbe", #sps
               "#238b45", "#74c476", #spls"
               "#2c7fb8", "#41b6c4", #mcgs
               "chartreuse4", "chartreuse", #sspls
               "firebrick", "#ef3b2c", #ifrms
               "cadetblue", "cadetblue1")) + #icgs-p 
  labs(x = "shallower sulci",
       y = sa_y) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=20, face = "bold"),
        axis.text.x = element_text(size = 16, face = "bold", vjust = .70), # was 7
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        strip.text.x = element_text(size = 10), 
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) 
HCP_all_morphology_rep_sa.plot

# ggplot2::ggsave(filename = "HCP_all_morphology_rep_sa_plot.png",
#                  plot = HCP_all_morphology_rep_sa.plot,
#                  device = "png",
#                  width = 10,
#                  height = 5, 
#                  units = "in",
#                  dpi = "retina")
```

## Supplementary Figure 2.2: Correlation matrices for sulcal intersections of the discovery and replication sample shallow PCC sulci
```{r}
# Make matrices
sspls_lh_disc_2 <-  c(0.26, 0, 0,    0, 0, 0, 0, 0,    0,    0, NA, 0,    0)
ifrms_lh_disc_2 <-  c(0,    0, 0.06, 0, 0, 0, 0, 0.03, 0.06, 0, 0,    NA, 0.08)
icgs_p_lh_disc_2 <- c(0,    0, 0.05, 0, 0, 0, 0, 0,    0,    0, 0,    0.16, NA)

disc_tert_lh_mat <- rbind(sspls_lh_disc_2, ifrms_lh_disc_2, icgs_p_lh_disc_2)

colnames(disc_tert_lh_mat)  <- c("cas", "cgs", "mcgs", "pos", 
                                 "prculs", "prcus-p", "prcus-i", "prcus-a", 
                                 "spls", "sps", "sspls", "ifrms", "icgs-p")
rownames(disc_tert_lh_mat) <- c("sspls", "ifrms", "icgs-p")
 
disc_tert_lh_mat <- as.data.frame(disc_tert_lh_mat)
#disc_tert_lh_mat <- disc_tert_lh_mat %>% select(-c(4:7,10))
disc_tert_lh_mat <- as.matrix(disc_tert_lh_mat)
disc_tert_lh_mat

# disc rh 
sspls_rh_disc_2 <-  c(0.22, 0, 0,    0, 0, 0, 0, 0, 0,    0, NA, 0,    0)
ifrms_rh_disc_2 <-  c(0,    0, 0.03, 0, 0, 0, 0, 0, 0.17, 0, 0,    NA, 0)
icgs_p_rh_disc_2 <- c(0,    0, 0.04, 0, 0, 0, 0, 0, 0,    0, 0,    0,    NA)

disc_tert_rh_mat <- rbind(sspls_rh_disc_2, ifrms_rh_disc_2, icgs_p_rh_disc_2)

colnames(disc_tert_rh_mat)  <- c("cas", "cgs", "mcgs", "pos", 
                                 "prculs", "prcus-p", "prcus-i", "prcus-a", 
                                 "spls", "sps", "sspls", "ifrms", "icgs-p")
rownames(disc_tert_rh_mat) <- c("sspls", "ifrms", "icgs-p")

disc_tert_rh_mat <- as.data.frame(disc_tert_rh_mat)
#disc_tert_rh_mat <- disc_tert_rh_mat %>% select(-c(4:7,10))
disc_tert_rh_mat <- as.matrix(disc_tert_rh_mat)
disc_tert_rh_mat

# rep lh 
sspls_lh_rep_2 <-  c(0.18, 0, 0,    0, 0, 0, 0, 0,    0.06, 0, NA, 0,    0)
ifrms_lh_rep_2 <-  c(0,    0, 0.11, 0, 0, 0, 0, 0.03, 0.17, 0, 0,    NA, 0.06)
icgs_p_lh_rep_2 <- c(0,    0, 0.04, 0, 0, 0, 0, 0,    0,    0, 0,    0.08, NA)

rep_tert_lh_mat <- rbind(sspls_lh_rep_2, ifrms_lh_rep_2, icgs_p_lh_rep_2)

colnames(rep_tert_lh_mat)  <- c("cas", "cgs", "mcgs", "pos", "prculs", 
                                "prcus-p", "prcus-i", "prcus-a", "spls", 
                                "sps", "sspls", "ifrms", "icgs-p")
rownames(rep_tert_lh_mat) <- c("sspls", "ifrms", "icgs-p")

rep_tert_lh_mat <- as.data.frame(rep_tert_lh_mat)
#rep_tert_lh_mat <- rep_tert_lh_mat %>% select(-c(4:7,10))
rep_tert_lh_mat <- as.matrix(rep_tert_lh_mat)
rep_tert_lh_mat

# rep rh 
sspls_rh_rep_2 <-  c(0.4, 0,    0,    0, 0, 0, 0, 0, 0.05, 0, NA, 0,    0)
ifrms_rh_rep_2 <-  c(0,   0,    0.08, 0, 0, 0, 0, 0, 0.25, 0, 0,    NA, 0.06)
icgs_p_rh_rep_2 <- c(0,   0.09, 0,    0, 0, 0, 0, 0, 0,    0, 0,    0.09, NA)

rep_tert_rh_mat <- rbind(sspls_rh_rep_2, ifrms_rh_rep_2, icgs_p_rh_rep_2)
colnames(rep_tert_rh_mat)  <- c("cas", "cgs", "mcgs", "pos", "prculs", 
                                "prcus-p", "prcus-i", "prcus-a", "spls", 
                                "sps", "sspls", "ifrms", "icgs-p")
rownames(rep_tert_rh_mat) <- c("sspls", "ifrms", "icgs-p")

rep_tert_rh_mat <- as.data.frame(rep_tert_rh_mat)
#rep_tert_rh_mat <- rep_tert_rh_mat %>% select(-c(4:7,10))
rep_tert_rh_mat <- as.matrix(rep_tert_rh_mat)
rep_tert_rh_mat

## correlations
### disc lh ~ rh
cor.test(c(as.matrix(disc_tert_lh_mat)), c(as.matrix(disc_tert_rh_mat)))

### rep lh ~ rh
cor.test(c(as.matrix(rep_tert_lh_mat)), c(as.matrix(rep_tert_rh_mat)))

### disc lh ~ rep lh
cor.test(c(as.matrix(disc_tert_lh_mat)), c(as.matrix(rep_tert_lh_mat)))

### disc rh ~ rep rh
cor.test(c(as.matrix(disc_tert_rh_mat)), c(as.matrix(rep_tert_rh_mat)))

## Plot
colorscheme <- brewer.pal(n = 9, name = "OrRd")

#jpeg(filename = "~/Desktop/all_2.jpeg", res = 300, width = 10, height = 8, units = "in")
par(mar = c(4,4.5,4.5,3),
    mfrow = c(2,2))
plot(disc_tert_lh_mat, 
     breaks=c(0, 0.01, 0.05, 0.1, 0.2, 0.4, 0.6, 0.8, 1.0), 
     digits=2,
     fmt.cell='%.2f',
     fmt.key = '%.2f',
     asp=F,
     cex.axis=.8,
     axis.col=list(side=3, las=2), 
     axis.row = list(side=2, las=1),
     key=list(side=4, cex.axis = .8),
     text.cell=list(cex=0.6),
     main = "", xlab = "", ylab = "",
    na.col="gray",
    col = colorscheme
     )
mtext(side=3, line=3.5, "discovery (LH)",  font=2, cex=1)
mtext(side=2, line=3.5,"PCC and PRC sulci", font=2, cex=1)
mtext(side=1, line=3.5, "", font=2, cex=1)

plot(disc_tert_rh_mat, 
     breaks=c(0, 0.01, 0.05, 0.1, 0.2, 0.4, 0.6, 0.8, 1.0), 
     digits=2,
     fmt.cell='%.2f',
     fmt.key = '%.2f',
     asp=F,
     cex.axis=.8,
     axis.col=list(side=3, las=2), 
     axis.row = list(side=2, las=1),
     key=list(side=4, cex.axis = .8),
     text.cell=list(cex=0.6),
     main = "", xlab = "", ylab = "",
    na.col="gray",
    col = colorscheme
     )
mtext(side=3, line=3.5, "discovery (RH)",  font=2, cex=1)
mtext(side=1, "",  font=2, cex=1)
mtext(side=2, line=3.5, "", font=2, cex=1)

plot(rep_tert_lh_mat, 
     breaks=c(0, 0.01, 0.05, 0.1, 0.2, 0.4, 0.6, 0.8, 1.0), 
     digits=2,
     fmt.cell='%.2f',
     fmt.key = '%.2f',
     asp=F,
     cex.axis=.8,
     axis.col=list(side=3, las=2), 
     axis.row = list(side=2, las=1),
     key=list(side=4, cex.axis = .8),
     text.cell=list(cex=0.6),
     main = "", xlab = "", ylab = "",
    na.col="gray",
    col = colorscheme
     )
mtext(side=3, line=3.5, "replication (LH)",  font=2, cex=1)
mtext(side=1, line=.5, "intersections",  font=2, cex=1)
mtext(side=2, line=3.5, "PCC and PRC sulci", font=2, cex=1)

plot(rep_tert_rh_mat, 
     breaks=c(0, 0.01, 0.05, 0.1, 0.2, 0.4, 0.6, 0.8, 1.0), 
     digits=2,
     fmt.cell='%.2f',
     fmt.key = '%.2f',
     asp=F,
     cex.axis=.8,
     axis.col=list(side=3, las=2), 
     axis.row = list(side=2, las=1),
     key=list(side=4, cex.axis = .8),
     text.cell=list(cex=0.6),
     main = "", xlab = "", ylab = "",
    na.col="gray",
    col = colorscheme
     )
mtext(side=3, line=3.5, "replication (RH)",  font=2, cex=1)
mtext(side=1, line=.5, "intersections",  font=2, cex=1)
mtext(side=2, line=3.5, "", font=2, cex=1)
#dev.off()
```

## Supplementary Figure 4.1: C/M with all 11 sulci
```{r, warning = FALSE}
# Dataset
HCP_figure3_supplement <- read.csv("~/Desktop/RMD_csvs/HCP_figure3_supplement.csv")

HCP_figure3_supplement.d <- HCP_figure3_supplement %>% subset(dataset == "HCP_discovery")
cm_ratio_disc.aov <- aov(ratio ~ label * hemi, data = HCP_figure3_supplement.d)
summary(cm_ratio_disc.aov)
disc_all_ratio.m1 <- emmeans::emmeans(cm_ratio_disc.aov, ~ label)
emmeans::contrast(disc_all_ratio.m1, method='pairwise')

HCP_figure3_supplement.r <- HCP_figure3_supplement %>% subset(dataset == "HCP_replication")
cm_ratio_rep.aov <- aov(ratio ~ label * hemi, data = HCP_figure3_supplement.r)
summary(cm_ratio_rep.aov)
rep_all_ratio.m1 <- emmeans::emmeans(cm_ratio_rep.aov, ~ label)
emmeans::contrast(rep_all_ratio.m1, method='pairwise')

## LH plot
HCP_figure3_supplement_lh <- subset(HCP_figure3_supplement, 
                                    subset = HCP_figure3_supplement$hemi == "lh")

### Means for plot
HCP_figure3_supplement_lh_mean <- HCP_figure3_supplement_lh %>% 
  group_by(label, label_dataset) %>% 
  summarise(ratio = mean(ratio))
HCP_figure3_supplement_lh_sd <- HCP_figure3_supplement_lh %>% 
  group_by(label, label_dataset) %>% 
  summarise(sd = sd(ratio))
HCP_figure3_supplement_lh_stats <- merge(HCP_figure3_supplement_lh_mean, 
                                        HCP_figure3_supplement_lh_sd, 
                                        by = c("label", "label_dataset"))

### Plot
ratio_axis <- expression(paste(bold("thickness/myelination ratio")))

HCP_figure3_supplement_lh_stats$label <- factor(HCP_figure3_supplement_lh_stats$label, 
                                                levels = 
                  c("pos", "prculs", "prcus-p", "prcus-i", "prcus-a", 
                    "spls", "sps", "mcgs", 
                    "sspls", "ifrms", "icgs-p"))

HCP_figure3_supplement_lh_stats$label_dataset <- factor(HCP_figure3_supplement_lh_stats$label_dataset, 
        levels = c("POS d", "POS r",
                   "prculs d", "prculs r",
                   "prcus-p d", "prcus-p r",
                   "prcus-i d", "prcus-i r",
                   "prcus-a d", "prcus-a r",
                   "spls d", "spls r",
                   "sps d", "sps r",
                   "MCGS d", "MCGS r", 
                   "sspls d", "sspls r",
                   "ifrms d", "ifrms r",
                   "icgs-p d", "icgs-p r"))

HCP_figure3_supplement_lh$label <- factor(HCP_figure3_supplement_lh$label, levels = 
                             c("pos", "prculs", "prcus-p", "prcus-i", "prcus-a", 
                    "spls", "sps", "mcgs", 
                    "sspls", "ifrms", "icgs-p"))

HCP_figure3_supplement_lh$label_dataset <- factor(HCP_figure3_supplement_lh$label_dataset, 
                  levels = c("POS d", "POS r",
                   "prculs d", "prculs r",
                   "prcus-p d", "prcus-p r",
                   "prcus-i d", "prcus-i r",
                   "prcus-a d", "prcus-a r",
                   "spls d", "spls r",
                   "sps d", "sps r",
                   "MCGS d", "MCGS r", 
                   "sspls d", "sspls r",
                   "ifrms d", "ifrms r",
                   "icgs-p d", "icgs-p r"))

ctmy_11.plot <- ggplot(HCP_figure3_supplement_lh, aes(x = label_dataset, fill = label_dataset)) + 
  geom_violin(aes(y = ratio), size = .8, alpha = 0.6) + 
  geom_jitter(aes(y = ratio), 
              shape = 21, color = 'black', alpha = .8,
              position=position_jitterdodge(jitter.width = 4, 
                                            dodge.width = .5, jitter.height = 0)) + 
  geom_pointrange(data = HCP_figure3_supplement_lh_stats, 
                  aes(label_dataset, ratio, ymin=ratio-sd, ymax=ratio+sd, 
                      fill = label_dataset), 
                  shape = 21, size = 1, fatten = 4) +
  scale_x_discrete(breaks = c("POS d", "POS r",
                              "prculs d", "prculs r",
                   "prcus-p d", "prcus-p r",
                   "prcus-i d", "prcus-i r",
                   "prcus-a d", "prcus-a r",
                   "spls d", "spls r",
                   "sps d", "sps r",
                   "MCGS d", "MCGS r", 
                   "sspls d", "sspls r",
                   "ifrms d", "ifrms r",
                   "icgs-p d", "icgs-p r"),
                   labels = c("disc", "repl",
                                  "disc", "repl",
                                   "disc", "repl",
                                   "disc", "repl",
                                   "disc", "repl",
                                    "disc", "repl",
                                    "disc", "repl",
                                    "disc", "repl",
                                     "disc", "repl",
                                     "disc", "repl",
                                     "disc", "repl")) +
  scale_fill_manual(breaks = c("POS d", "POS r",
                   "prculs d", "prculs r",
                   "prcus-p d", "prcus-p r",
                   "prcus-i d", "prcus-i r",
                   "prcus-a d", "prcus-a r",
                   "spls d", "spls r",
                   "sps d", "sps r",
                   "MCGS d", "MCGS r", 
                   "sspls d", "sspls r",
                   "ifrms d", "ifrms r",
                   "icgs-p d", "icgs-p r"),
                    values = c("#6a51a3", "#807dba", #POS
               "#9e9ac8", "#cbc9e2", #prculs
               "#006d2c","#31a354", #prcus-p
               "darkolivegreen","darkolivegreen4", #prcus-i
               "darkolivegreen3","darkolivegreen2", #prcus-a
               "#045a8d", "#2b8cbe", #sps
               "#238b45", "#74c476", #spls"
               "#2c7fb8", "#41b6c4", #mcgs
      "chartreuse4", "chartreuse", #sspls
      "firebrick", "#ef3b2c", #ifrms
      "cadetblue", "cadetblue1")) + #icgs-p +
  scale_color_manual(breaks = c("POS d", "POS r",
                   "prculs d", "prculs r",
                   "prcus-p d", "prcus-p r",
                   "prcus-i d", "prcus-i r",
                   "prcus-a d", "prcus-a r",
                   "spls d", "spls r",
                   "sps d", "sps r",
                   "MCGS d", "MCGS r", 
                   "sspls d", "sspls r",
                   "ifrms d", "ifrms r",
                   "icgs-p d", "icgs-p r"),
                    values = c(
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363"
                       )) +
  labs(x = "PCC and PRC sulci",
       y = ratio_axis) + 
  guides(fill = F, color = F, alpha = F) +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
          plot.subtitle = element_text(size = 12),
          plot.caption = element_text(size = 12, hjust = 1),
          axis.title.x = element_text(size=20, face = "bold", vjust = .9),
          axis.title.y = element_text(size=20, face = "bold", vjust = .9),
          axis.title.y.right = element_text(size=20, face = "bold", vjust = 1),
          axis.text.x = element_text(size = 4, face = "bold", vjust = .70), # was 12
          axis.text.y = element_text(size = 16, face = "bold"), # was 20
          legend.title = element_text(size=14), 
          legend.text = element_text(size=12),
          strip.text.x = element_text(size = 6, face = "bold"), # was 16
          strip.background = element_blank(),
          strip.placement = "outside",
          axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  facet_wrap( ~ label, strip.position = "bottom", scales = "free_x", nrow = 1)
ctmy_11.plot

# ggplot2::ggsave(filename = "ctmy_11_lh_plot.png",
#                 plot = ctmy_11.plot,
#                 device = "png",
#                 width = 12,
#                 height = 5, 
#                 units = "in",
#                 dpi = "print")


## RH plot
HCP_figure3_supplement_rh <- subset(HCP_figure3_supplement, 
                       subset = HCP_figure3_supplement$hemi == "rh")

## Means for plot 
HCP_figure3_supplement_rh_mean <- HCP_figure3_supplement_rh %>% 
  group_by(label, label_dataset) %>% 
  summarise(ratio = mean(ratio))
HCP_figure3_supplement_rh_sd <- HCP_figure3_supplement_rh %>% 
  group_by(label, label_dataset) %>% 
  summarise(sd = sd(ratio))
HCP_figure3_supplement_rh_stats <- merge(HCP_figure3_supplement_rh_mean, 
                                        HCP_figure3_supplement_rh_sd, 
                                        by = c("label", "label_dataset"))

HCP_figure3_supplement_rh_stats$label <- factor(HCP_figure3_supplement_rh_stats$label, 
                                                levels = 
                  c("pos", "prculs", "prcus-p", "prcus-i", "prcus-a", 
                    "spls", "sps", "mcgs", 
                    "sspls", "ifrms", "icgs-p"))

HCP_figure3_supplement_rh_stats$label_dataset <- factor(HCP_figure3_supplement_rh_stats$label_dataset, 
        levels = c("POS d", "POS r",
                   "prculs d", "prculs r",
                   "prcus-p d", "prcus-p r",
                   "prcus-i d", "prcus-i r",
                   "prcus-a d", "prcus-a r",
                   "spls d", "spls r",
                   "sps d", "sps r",
                   "MCGS d", "MCGS r", 
                   "sspls d", "sspls r",
                   "ifrms d", "ifrms r",
                   "icgs-p d", "icgs-p r"))

HCP_figure3_supplement_rh$label <- factor(HCP_figure3_supplement_rh$label, levels = 
                             c("pos", "prculs", "prcus-p", "prcus-i", "prcus-a", 
                    "spls", "sps", "mcgs", 
                    "sspls", "ifrms", "icgs-p"))

HCP_figure3_supplement_rh$label_dataset <- factor(HCP_figure3_supplement_rh$label_dataset, 
                  levels = c("POS d", "POS r",
                   "prculs d", "prculs r",
                   "prcus-p d", "prcus-p r",
                   "prcus-i d", "prcus-i r",
                   "prcus-a d", "prcus-a r",
                   "spls d", "spls r",
                   "sps d", "sps r",
                   "MCGS d", "MCGS r", 
                   "sspls d", "sspls r",
                   "ifrms d", "ifrms r",
                   "icgs-p d", "icgs-p r"))

### Plot
ctmy_11_rh.plot <- ggplot(HCP_figure3_supplement_rh, 
                          aes(x = label_dataset, 
                              fill = label_dataset)) + 
  geom_violin(aes(y = ratio), size = .8, alpha = 0.6) + 
  geom_jitter(aes(y = ratio), 
              shape = 21, color = 'black', alpha = .8,
              position=position_jitterdodge(jitter.width = 4, 
                                            dodge.width = .5, jitter.height = 0)) + 
  geom_pointrange(data = HCP_figure3_supplement_rh_stats, 
                  aes(label_dataset, ratio, 
                      ymin=ratio-sd, ymax=ratio+sd, 
                      fill = label_dataset), 
                  shape = 21, size = 1, fatten = 4) +
  scale_x_discrete(breaks = c("POS d", "POS r",
                              "prculs d", "prculs r",
                   "prcus-p d", "prcus-p r",
                   "prcus-i d", "prcus-i r",
                   "prcus-a d", "prcus-a r",
                   "spls d", "spls r",
                   "sps d", "sps r",
                   "MCGS d", "MCGS r", 
                   "sspls d", "sspls r",
                   "ifrms d", "ifrms r",
                   "icgs-p d", "icgs-p r"),
                   labels = c("disc", "repl",
                                  "disc", "repl",
                                   "disc", "repl",
                                   "disc", "repl",
                                   "disc", "repl",
                                    "disc", "repl",
                                    "disc", "repl",
                                    "disc", "repl",
                                     "disc", "repl",
                                     "disc", "repl",
                                     "disc", "repl")) +
  scale_fill_manual(breaks = c("POS d", "POS r",
                   "prculs d", "prculs r",
                   "prcus-p d", "prcus-p r",
                   "prcus-i d", "prcus-i r",
                   "prcus-a d", "prcus-a r",
                   "spls d", "spls r",
                   "sps d", "sps r",
                   "MCGS d", "MCGS r", 
                   "sspls d", "sspls r",
                   "ifrms d", "ifrms r",
                   "icgs-p d", "icgs-p r"),
                    values = c("#6a51a3", "#807dba", #POS
               "#9e9ac8", "#cbc9e2", #prculs
               "#006d2c","#31a354", #prcus-p
               "darkolivegreen","darkolivegreen4", #prcus-i
               "darkolivegreen3","darkolivegreen2", #prcus-a
               "#045a8d", "#2b8cbe", #sps
               "#238b45", "#74c476", #spls"
               "#2c7fb8", "#41b6c4", #mcgs
      "chartreuse4", "chartreuse", #sspls
      "firebrick", "#ef3b2c", #ifrms
      "cadetblue", "cadetblue1")) + #icgs-p +
  scale_color_manual(breaks = c("POS d", "POS r",
                   "prculs d", "prculs r",
                   "prcus-p d", "prcus-p r",
                   "prcus-i d", "prcus-i r",
                   "prcus-a d", "prcus-a r",
                   "spls d", "spls r",
                   "sps d", "sps r",
                   "MCGS d", "MCGS r", 
                   "sspls d", "sspls r",
                   "ifrms d", "ifrms r",
                   "icgs-p d", "icgs-p r"),
                    values = c(
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363",
                       "#252525", "#636363"
                       )) +
  labs(x = "PCC and PRC sulci",
       y = ratio_axis) + 
  guides(fill = F, color = F, alpha = F) +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
          plot.subtitle = element_text(size = 12),
          plot.caption = element_text(size = 12, hjust = 1),
          axis.title.x = element_text(size=20, face = "bold", vjust = .9),
          axis.title.y = element_text(size=20, face = "bold", vjust = .9),
          axis.title.y.right = element_text(size=20, face = "bold", vjust = 1),
          axis.text.x = element_text(size = 4, face = "bold", vjust = .70), # was 12
          axis.text.y = element_text(size = 16, face = "bold"), # was 20
          legend.title = element_text(size=14), 
          legend.text = element_text(size=12),
          strip.text.x = element_text(size = 6, face = "bold"), # was 16
          strip.background = element_blank(),
          strip.placement = "outside",
          axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  facet_wrap( ~ label, strip.position = "bottom", scales = "free_x", nrow = 1)
ctmy_11_rh.plot

# ggplot2::ggsave(filename = "ctmy_11_rh_plot.png",
#                 plot = ctmy_11_rh.plot,
#                 device = "png",
#                 width = 12,
#                 height = 5, 
#                 units = "in",
#                 dpi = "print")
```

## Supplementary Figure 4.2: Cortical thickness and myelination of PCC sulci shown separately
```{r, warning = FALSE}
# to display thickness and myelination on one plot
scale <- mean(HCP_all_morphology$cortical_thickness_mean) / mean(HCP_all_morphology$myelin)
scale

HCP_tot_analysis.sup <- HCP_all_morphology %>% subset(label %in% c("spls", "sspls", "mcgs", "ifrms")) %>% 
  select(c("sub", "hemi", "dataset", "label", "label2", "cortical_thickness_mean", "myelin"))

HCP_tot_analysis.sup$myelination <- HCP_tot_analysis.sup$myelin*scale
HCP_tot_analysis.sup <- subset(HCP_tot_analysis.sup, select = -c(7))
HCP_tot_analysis.sup.2 <- melt(HCP_tot_analysis.sup, id.vars=c("sub","hemi", "dataset", "label", "label2"),
                  value.name = "measurement")

# axis names
ct_y <- expression(paste(bold("mean cortical thickness "), italic("(mm)")))
my_y <- expression(paste(bold("myelination "), italic("(T1w/T2w)")))

# ct vs my tertiary lh plot 
HCP_tot_analysis.sup.2$label2 <- gsub("MCGS LH", "mcgs LH", HCP_tot_analysis.sup.2$label2)
HCP_tot_analysis.sup.2$label2 <- gsub("MCGS RH", "mcgs RH", HCP_tot_analysis.sup.2$label2)
HCP_tot_analysis.sup.2$sub <- as.factor(HCP_tot_analysis.sup.2$sub)

HCP_tot_analysis.sup.2.disc <- HCP_tot_analysis.sup.2 %>% subset(dataset == "HCP_discovery")
HCP_tot_analysis.sup.2.repl <- HCP_tot_analysis.sup.2 %>% subset(dataset == "HCP_replication")

HCP_tot_analysis.sup.2$label2 <- factor(HCP_tot_analysis.sup.2$label2, 
                                                levels = 
                                                  c("spls LH", "spls RH",
                                                    "sspls LH", "sspls RH",
                                                    "mcgs LH", "mcgs RH",
                                                    "ifrms LH", "ifrms RH"
                                                    ))
HCP_tot_analysis.sup.2$variable <- factor(HCP_tot_analysis.sup.2$variable, 
                                           levels = 
                                             c("cortical_thickness_mean", "myelination"))

# Colors for plots
color = grDevices::colors()[grep('gr(a|e)y', grDevices::colors(), invert = T)]
col_disc=sample(color, 36)
col_disc

col_repl=sample(color, 36)
col_repl

ctmy_ind_disc.plot <- HCP_tot_analysis.sup.2 %>% subset(dataset == "HCP_discovery") %>%
ggplot(aes(x = variable, y = measurement, fill = variable)) + 
  geom_line(aes(group = factor(sub), color = as.factor(sub))) +
  geom_point(size = 3, shape = 21) +
  scale_y_continuous(limits = c(1.5,5), sec.axis = dup_axis(~./scale, name = my_y)) + 
  labs(x = "discovery PCC sulci",
       y = ct_y) + 
  guides(fill = F, color = F, alpha = F) +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .9),
        axis.title.y = element_text(size=20, face = "bold", vjust = .9),
        axis.title.y.right = element_text(size=20, face = "bold", vjust = 1),
        axis.text.x = element_text(size = 0, face = "bold", vjust = .70),
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        strip.text.x = element_text(size = 14, face = "bold"),
        strip.background = element_blank(),
        strip.placement = "outside",
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  facet_wrap( ~ label2, strip.position = "bottom", scales = "free_x", ncol = 8, nrow = 1) +
  scale_fill_manual(breaks = c("cortical_thickness_mean", "myelination"),
                    values = c("#636363", "#bababa")) +
  scale_color_manual(breaks = sub, 
                     values = col_disc)
ctmy_ind_disc.plot

# ggplot2::ggsave(filename = "ctmy_ind_disc_plot.png",
#                 plot = ctmy_ind_disc.plot,
#                 device = "png",
#                 width = 12,
#                 height = 5, 
#                 units = "in",
#                 dpi = "retina")

ctmy_ind_ifrms_disc.plot <- HCP_tot_analysis.sup.2 %>% subset(dataset == "HCP_discovery" & label2 %in% 
                                                                c("ifrms LH", "ifrms RH")) %>% 
  ggplot(aes(x = variable, y = measurement, fill = variable)) + 
  geom_line(aes(group = factor(sub), color = as.factor(sub))) +
  geom_point(size = 3, shape = 21) +
  scale_y_continuous(limits = c(1.5,5), sec.axis = dup_axis(~./scale, name = my_y)) + 
  labs(x = "discovery",
       y = ct_y) + 
  guides(fill = F, color = F, alpha = F) +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .9),
        axis.title.y = element_text(size=20, face = "bold", vjust = .9),
        axis.title.y.right = element_text(size=20, face = "bold", vjust = 1),
        axis.text.x = element_text(size = 0, face = "bold", vjust = .70),
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        strip.text.x = element_text(size = 14, face = "bold"),
        strip.background = element_blank(),
        strip.placement = "outside",
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  scale_fill_manual(breaks = c("cortical_thickness_mean", "myelination"),
                    values = c("#636363", "#bababa")) +
  scale_color_manual(breaks = sub, 
                     values = col_disc) +
  facet_wrap( ~ label2, strip.position = "bottom", scales = "free_x", ncol = 2, nrow = 1)
ctmy_ind_ifrms_disc.plot

# ggplot2::ggsave(filename = "ctmy_ind_ifrms_disc_plot.png",
#                 plot = ctmy_ind_ifrms_disc.plot,
#                 device = "png",
#                 width = 6,
#                 height = 7, 
#                 units = "in",
#                 dpi = "retina")

ctmy_ind_repl.plot <- HCP_tot_analysis.sup.2 %>% subset(dataset == "HCP_replication") %>%
  ggplot(aes(x = variable, y = measurement, fill = variable)) + 
  geom_line(aes(group = factor(sub), color = as.factor(sub))) +
  geom_point(size = 3, shape = 21) +
  scale_y_continuous(limits = c(1.5,5), sec.axis = dup_axis(~./scale, name = my_y)) + 
  labs(x = "replication PCC sulci",
       y = ct_y) + 
  guides(fill = F, color = F, alpha = F) +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .9),
        axis.title.y = element_text(size=20, face = "bold", vjust = .9),
        axis.title.y.right = element_text(size=20, face = "bold", vjust = 1),
        axis.text.x = element_text(size = 0, face = "bold", vjust = .70),
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        strip.text.x = element_text(size = 14, face = "bold"),
        strip.background = element_blank(),
        strip.placement = "outside",
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  facet_wrap( ~ label2, strip.position = "bottom", scales = "free_x", ncol = 8, nrow = 1) +
  scale_fill_manual(breaks = c("cortical_thickness_mean", "myelination"),
                    values = c("#636363", "#bababa")) + 
  scale_color_manual(breaks = sub, 
                     values = col_repl)
ctmy_ind_repl.plot

# ggplot2::ggsave(filename = "ctmy_ind_repl_plot.png",
#                 plot = ctmy_ind_repl.plot,
#                 device = "png",
#                 width = 12,
#                 height = 5, 
#                 units = "in",
#                 dpi = "retina")


ctmy_ind_ifrms_repl.plot <- HCP_tot_analysis.sup.2 %>% subset(dataset == "HCP_replication" & 
                                                                label2 %in% c("ifrms LH", "ifrms RH")) %>% 
  ggplot(aes(x = variable, y = measurement, fill = variable)) + 
  geom_line(aes(group = factor(sub), color = as.factor(sub))) +
  geom_point(size = 3, shape = 21) +
  scale_y_continuous(limits = c(1.5,5), sec.axis = dup_axis(~./scale, name = my_y)) + 
  labs(x = "replication",
       y = ct_y) + 
  guides(fill = F, color = F, alpha = F) +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .9),
        axis.title.y = element_text(size=20, face = "bold", vjust = .9),
        axis.title.y.right = element_text(size=20, face = "bold", vjust = 1),
        axis.text.x = element_text(size = 0, face = "bold", vjust = .70),
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        strip.text.x = element_text(size = 14, face = "bold"),
        strip.background = element_blank(),
        strip.placement = "outside",
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  scale_fill_manual(breaks = c("cortical_thickness_mean", "myelination"),
                    values = c("#636363", "#bababa")) +
  scale_color_manual(breaks = sub, 
                     values = col_repl) + 
  facet_wrap( ~ label2, strip.position = "bottom", scales = "free_x", ncol = 2, nrow = 1)

ctmy_ind_ifrms_repl.plot

# ggplot2::ggsave(filename = "ctmy_ind_ifrms_repl_plot.png",
#                 plot = ctmy_ind_ifrms_repl.plot,
#                 device = "png",
#                 width = 6,
#                 height = 7, 
#                 units = "in",
#                 dpi = "retina")
```

## Supplementary Figure 5.1: Individual subject fingerprints - discovery
```{r, warning=FALSE}
# Dataset
networks_ifrms_spls_discovery.2 <- six_networks_ifrms_spls_discovery

networks_ifrms_spls_discovery.2$TRG_sub <- gsub("100206", "P1", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("100307", "P2", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("100408", "P3", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("100610", "P4", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("101006", "P5", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("101107", "P6", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("107725", "P7", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("109830", "P8", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("112920", "P9", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("114924", "P10", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("128127", "P11", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("133928", "P12", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("144125", "P13", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("146937", "P14", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("151425", "P15", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("151829", "P16", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("164939", "P17", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("176744", "P18", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("180937", "P19", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("185947", "P20", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("214019", "P21", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("268749", "P22", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("365343", "P23", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("380036", "P24", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("517239", "P25", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("522434", "P26", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("531536", "P27", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("566454", "P28", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("585256", "P29", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("622236", "P30", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("644044", "P31", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("679770", "P32", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("687163", "P33", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("867468", "P34", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("910241", "P35", networks_ifrms_spls_discovery.2$TRG_sub) 
networks_ifrms_spls_discovery.2$TRG_sub <- gsub("959574", "P36", networks_ifrms_spls_discovery.2$TRG_sub) 

# Features for plot
networks_ifrms_spls_discovery.2$TRG_sub <- factor(networks_ifrms_spls_discovery.2$TRG_sub, 
                                       levels = c("P1", "P2", "P3", "P4", "P5", "P6", "P7", "P8", "P9", "P10",
                                                  "P11", "P12", "P13", "P14", "P15", "P16", "P17", "P18", "P19",
                                                  "P20", "P21", "P22", "P23", "P24", "P25", "P26", "P27", "P28",
                                                  "P29", "P30", "P31", "P32", "P33", "P34", "P35", "P36")) 


networks_ifrms_spls_discovery.2$label_hemi[networks_ifrms_spls_discovery.2$label_name == "ifrms" 
                                           & networks_ifrms_spls_discovery.2$hemi == "lh"] <- "ifrms.lh"

networks_ifrms_spls_discovery.2$label_hemi[networks_ifrms_spls_discovery.2$label_name == "ifrms" 
                                           & networks_ifrms_spls_discovery.2$hemi == "rh"] <- "ifrms.rh"

networks_ifrms_spls_discovery.2$label_hemi[networks_ifrms_spls_discovery.2$label_name == "spls" 
                                & networks_ifrms_spls_discovery.2$hemi == "lh"] <- "spls.lh"

networks_ifrms_spls_discovery.2$label_hemi[networks_ifrms_spls_discovery.2$label_name == "spls" 
                                & networks_ifrms_spls_discovery.2$hemi == "rh"] <- "spls.rh"

# Plot
all_conn_fp_disc.plot <- ggplot() +  
  geom_polygon(data = networks_ifrms_spls_discovery.2, 
               aes(x = network_name, y = dice_coeff, fill = label_hemi, group = label_hemi, color = label_hemi),
               size = .5,
               alpha = .1) +
  geom_point(data = networks_ifrms_spls_discovery.2, aes(x = network_name, y = dice_coeff, color = label_hemi),
             size = 1, alpha = .70) + 
  
  coord_radar(start = -pi/2) +
  labs(x = "Network Name",
       y = "Dice Coefficient", 
       title = "",
       subtitle = "",
       color = "Label & Hemisphere",
       fill = "Label & Hemisphere") +  
  scale_fill_manual(limit = c("ifrms.lh", "ifrms.rh", "spls.lh", "spls.rh"), 
                    labels = c("ifrms lh", "ifrms rh", "spls lh", "spls rh"),
                    values = c("firebrick", "#ef3b2c", "#238b45", "#4daf4a")) +
  scale_color_manual(limit = c("ifrms.lh", "ifrms.rh", "spls.lh", "spls.rh"), 
                     labels = c("ifrms lh", "ifrms rh", "spls.lh", "spls.rh"),
                     values = c("firebrick", "#ef3b2c", "#238b45", "#4daf4a")) + 
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(hjust = 0, size = 14),
        plot.caption = element_text(size = 12),
        axis.text=element_text(size=14),
        axis.title.x = element_text(size = 0),
        axis.title.y = element_text(size = 0),
        axis.text.x = element_text(size = 5, face = "bold", color = "black", vjust = .50),
        axis.text.y = element_text(size = 0, face = "bold"),
        strip.text.y = element_text(size = 0),
        strip.text.x = element_text(size = 12, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        legend.position = "bottom",
        axis.line = element_line(colour = "black", 
                                 size = 0, linetype = "solid", lineend = "round"),
        panel.grid.minor = element_line(color = "gray"), 
        panel.grid.major = element_line(color = "gray")) + 
  guides(fill = F) + 
  ylim(0,1) + 
  facet_wrap(~TRG_sub)
#all_conn_fp_disc.plot #unmark to view

# ggplot2::ggsave(filename = "all_conn_fp_disc_plot.png",
#                 plot = all_conn_fp_disc.plot,
#                 device = "png",
#                 width = 8.5,
#                 height = 11, 
#                 units = "in",
#                 dpi = "print")
```

## Supplementary Figure 5.3: Individual subject fingerprints - replication
```{r,warning=FALSE}
# Dataset
## Two marked out participants did not have network data available 
six_networks_ifrms_spls_replication2 <- six_networks_ifrms_spls_replication

six_networks_ifrms_spls_replication2$TRG_sub <- gsub("101309", "P1", 
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("101410", "P2", 
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("101915", "P3", 
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("102008", "P4", 
                                                     six_networks_ifrms_spls_replication2$TRG_sub)
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("102311", "P5", 
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("102513", "P6", 
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("102816", "P7", 
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("103111", "P8", 
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("103414", "P9", 
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("103515", "P10",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("103818", "P11",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("104416", "P12",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("104820", "P13",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("105014", "P14",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("105115", "P15",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("105216", "P16",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("105620", "P17",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("106016", "P18",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("106319", "P19",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("106521", "P20",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("107018", "P21",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
#six_networks_ifrms_spls_replication2$TRG_sub <- gsub("107220", "P22",
#                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("107321", "P23",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("107422", "P24",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
#six_networks_ifrms_spls_replication2$TRG_sub <- gsub("108121", "P25",
#                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("108222", "P26",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("108323", "P27",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("108525", "P28",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("108828", "P29",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("109123", "P30",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("109325", "P31",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("110007", "P32",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("110411", "P33",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("110613", "P34",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("120111", "P35",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 
six_networks_ifrms_spls_replication2$TRG_sub <- gsub("168240", "P36",
                                                     six_networks_ifrms_spls_replication2$TRG_sub) 

# Features for plot
six_networks_ifrms_spls_replication2$TRG_sub <- factor(six_networks_ifrms_spls_replication2$TRG_sub, 
                                       levels = c("P1", "P2", "P3", "P4", "P5", "P6", "P7", "P8", "P9", "P10",
                                                  "P11", "P12", "P13", "P14", "P15", "P16", "P17", "P18", "P19",
                                                  "P20", "P21", "P22", "P23", "P24", "P25", "P26", "P27", "P28",
                                                  "P29", "P30", "P31", "P32", "P33", "P34", "P35", "P36")) 


six_networks_ifrms_spls_replication2$label_hemi[six_networks_ifrms_spls_replication2$label_name == "ifrms" &
                                                  six_networks_ifrms_spls_replication2$hemi == "lh"] <- "ifrms.lh"

six_networks_ifrms_spls_replication2$label_hemi[six_networks_ifrms_spls_replication2$label_name == "ifrms" &
                                                  six_networks_ifrms_spls_replication2$hemi == "rh"] <- "ifrms.rh"

six_networks_ifrms_spls_replication2$label_hemi[six_networks_ifrms_spls_replication2$label_name == "spls" &
                                                  six_networks_ifrms_spls_replication2$hemi == "lh"] <- "spls.lh"

six_networks_ifrms_spls_replication2$label_hemi[six_networks_ifrms_spls_replication2$label_name == "spls" &
                                                  six_networks_ifrms_spls_replication2$hemi == "rh"] <- "spls.rh"

# Plot
all_conn_fp_repl.plot <- ggplot() +  
  geom_polygon(data = six_networks_ifrms_spls_replication2, 
               aes(x = network_name, y = dice_coeff, fill = label_hemi, group = label_hemi, color = label_hemi), 
               size = .5, alpha = .1) +
  geom_point(data = six_networks_ifrms_spls_replication2, 
             aes(x = network_name, y = dice_coeff, color = label_hemi), 
                                         size = 1, alpha = .70) + 
  coord_radar(start = -pi/2) +
  labs(x = "Network Name",
       y = "Dice Coefficient", 
       title = "",
       subtitle = "",
       color = "Label & Hemisphere",
       fill = "Label & Hemisphere") +  
  scale_fill_manual(limit = c("ifrms.lh", "ifrms.rh", "spls.lh", "spls.rh"), 
                    labels = c("ifrms lh", "ifrms rh", "spls lh", "spls rh"),
                    values = c("firebrick", "#ef3b2c", "#238b45", "#4daf4a")) +
  scale_color_manual(limit = c("ifrms.lh", "ifrms.rh", "spls.lh", "spls.rh"), 
                     labels = c("ifrms lh", "ifrms rh", "spls.lh", "spls.rh"),
                     values = c("firebrick", "#ef3b2c", "#238b45", "#4daf4a")) + 
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(hjust = 0, size = 14),
        plot.caption = element_text(size = 12),
        axis.text=element_text(size=14),
        axis.title.x = element_text(size = 0),
        axis.title.y = element_text(size = 0),
        axis.text.x = element_text(size = 5, face = "bold", color = "black", vjust = .50),
        axis.text.y = element_text(size = 0, face = "bold"),
        strip.text.y = element_text(size = 0),
        strip.text.x = element_text(size = 12, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        legend.position = "bottom",
        axis.line = element_line(colour = "black", 
                                 size = 0, linetype = "solid", lineend = "round"),
        panel.grid.minor = element_line(color = "gray"), 
        panel.grid.major = element_line(color = "gray")) + 
  guides(fill = F) + 
  ylim(0,1) + 
  facet_wrap(~TRG_sub)
#all_conn_fp_repl.plot #unmark to view

# ggplot2::ggsave(filename = "all_conn_fp_repl_plot.png",
#                 plot = all_conn_fp_repl.plot,
#                 device = "png",
#                 width = 8.5,
#                 height = 11, 
#                 units = "in",
#                 dpi = "print")
```

## Supplementary Figure 5.4: Three *prcus* connectivity fingerprints
* 3-way (network x sulcal label x hemi) repeated measures ANOVA to test for differences in overlap (DICE coefficient; see Methods)
* network: all 17 resting-state functional networks
* sulcal label: **prcus-p*, *prcus-i*, *prcus-a*
* hemi: lh, rh

### Discovery

#### Statistics
```{r, warning=FALSE}
# Dataset - all 
prcus_dice_all <-  read.csv("~/Desktop/RMD_csvs/prcus_dice_all.csv")
prcus_dice_all$TRG_sub <- as.factor(prcus_dice_all$TRG_sub)

# Discovery dataset
prcus_dice_disc <- prcus_dice_all %>% subset(dataset == "HCP_discovery")

# ANOVA
prcus_network.rmaov <- aov(dice_coeff ~ hemi*label_name*network_name +
                           Error(TRG_sub/(hemi*label_name*network_name)), 
                         data = prcus_dice_disc)
summary(prcus_network.rmaov) #p-values
rstatix::anova_summary(prcus_network.rmaov, effect.size = "ges") #Eta-squared

# Post hoc test
network_aov.i1 <- emmeans::emmeans(prcus_network.rmaov, ~ label_name | network_name)
emmeans::contrast(network_aov.i1, method='pairwise')
```

#### Results (discovery)
We observed a sulcus x network interaction effect (F(32, 3570) = 16.18, p < 0.001, η2G = 0.088). Post hoc tests indicated that these three sulci differed in their overlap with the different default mode subnetworks. These sulci show a posterior to anterior decrease in the amount of overlap with default mode network A (p-values < 0.001, Tukey’s adjustment). On the other hand, the three *prcus* show a posterior to anterior increase in overlap with default mode network C (p-values < 0.05, Tukey’s adjustment). Each sulcus also overlapped with other networks that were not shared with the other two sulci. *Prcus-p* also overlapped with CCN-b (p-values < 0.001, Tukey’s adjustment). *Prcus-i* and *prcus-a* both overlapped more with dorsal attention network A than *prcus-p* (p-values < 0.001, Tukey’s adjustment). *Prcus-a* also overlapped with more with somatomotor network A (p-values < 0.05, Tukey’s adjustment) and ventral attention network B (p-values < 0.001, Tukey’s adjustment) than the other two *prcus*, as well as overlapped more with ventral attention network A (p = 0.007, Tukey’s adjustment) and marginally more with visual network B (p = 0.08, Tukey’s adjustment) than *prcus-p*, but about the same as *prcus-i* did with both networks (p-values > 0.05, Tukey’s adjustment). Altogether, the three *prcus* are functionally complex and dissociable. See Supplementary Figure 6.4a in the supplementary materials or in the plot below.

#### Plots
```{r,warning=FALSE}
# Prcus-a

# Dataset
prcusa_dice <- prcus_dice_disc %>% subset(label_name == "prcus-a")

# Subset to networks that it overlapped most with in order to clear up plot
prcusa_dice.2 <- prcusa_dice %>% subset(network_name %in% c('ControlB', 'ControlC', 'DefaultA', 'DefaultB', 'DefaultC', 'DorsAttnA', 'SomMotorA', 'VenAttnA', 'VenAttnB', 'VisualB'))

# Get mean for each network dice value 
prcusa_dice_avg <- prcusa_dice.2 %>% 
  group_by(network_name, hemi) %>% 
  summarise(dice_coefficient = mean(dice_coeff))

# Get se value for each network by hemi 
prcusa_dice_se <- prcusa_dice.2 %>% 
  group_by(hemi, network_name) %>%
  summarise(n=n(), 
            sd=sd(dice_coeff), 
            se=sd/sqrt(n))

# Merge & add and subtract se from mean to get upper and lower 
prcusa_dice_all <- merge(prcusa_dice_avg, prcusa_dice_se,
                         by=c("network_name", "hemi"))
prcusa_dice_all <- prcusa_dice_all %>% 
  group_by(network_name, hemi) %>%
  mutate(upper = dice_coefficient + se, 
         lower = dice_coefficient - se)


## Plot
prcusa_conn_fp_disc.plot <- ggplot(data = prcusa_dice_all) +  
  geom_polygon(aes(x = network_name, y = upper, fill = NA, group = hemi, color = hemi), 
              linetype = 2, size = .4) + 
  geom_polygon(aes(x = network_name, y = lower, fill = NA, group = hemi, color = hemi), 
              linetype = 2, size = .4) +
  geom_polygon(aes(x = network_name, y = dice_coefficient, fill = hemi, group = hemi, color = hemi), 
               size = .9, alpha = .1) +
  geom_point(aes(x = network_name, y = dice_coefficient, color = hemi), size = 2) + 
  coord_radar(start = -pi/2) +
  labs(x = "Network Name",
       y = "Dice Coefficient",
       color = "Hemisphere",
       fill = "Hemisphere") +  
    theme_minimal() +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(hjust = 0, size = 14),
        plot.caption = element_text(size = 12),
        axis.text=element_text(size=14),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 7, face = "bold", color = "black", vjust = .50),
        axis.text.y = element_text(size = 12, face = "bold"),
        strip.text.y = element_text(size = 12, face = "bold"),
        strip.text.x = element_text(size = 12, face = "bold"),
        legend.title = element_text(size=14, face = "bold"), 
        legend.position = "bottom",
        legend.text = element_text(size=12),
        axis.line = element_line(colour = "black", 
                                 size = 0, linetype = "solid", lineend = "round"),
        panel.grid.minor = element_line(size = 0.5, color = "gray"), 
        panel.grid.major = element_line(size = .75, color = "gray")) +
  scale_fill_manual(breaks = c("lh", "rh"), 
                    values = c("darkolivegreen3","darkolivegreen2")) +
  scale_color_manual(breaks = c("lh", "rh"), 
                     values = c("darkolivegreen3", "darkolivegreen2")) + 
  guides(fill = F) +
  ylim(0,1)
prcusa_conn_fp_disc.plot

# ggplot2::ggsave(filename = "prcusa_conn_fp_disc_plot.png",
#                 plot = prcusa_conn_fp_disc.plot,
#                 device = "png",
#                 width = 4,
#                 height = 4, 
#                 units = "in",
#                 dpi = "print")


# Prcus-i 

# Dataset
prcusi_dice <- prcus_dice_disc %>% subset(label_name == "prcus-i")

# Subset to networks that it overlapped most with in order to clear up plot
prcusi_dice.2 <- prcusi_dice %>% subset(network_name %in% c('ControlB', 'ControlC', 'DefaultA',
                                              'DefaultB', 'DefaultC', 'DorsAttnA', 'SomMotorA',
                                              'VenAttnA', 'VenAttnB', 'VisualB'))
# Get mean for each network dice value 
prcusi_dice_avg <- prcusi_dice.2 %>% 
  group_by(network_name, hemi) %>% 
  summarise(dice_coefficient = mean(dice_coeff))

# Get se value for each network by hemi 
prcusi_dice_se <- prcusi_dice.2 %>% 
  group_by(hemi, network_name) %>%
  summarise(n=n(), 
            sd=sd(dice_coeff), 
            se=sd/sqrt(n))

# Merge & add and subtract se from mean to get upper and lower 
prcusi_dice_all <- merge(prcusi_dice_avg, prcusi_dice_se,
                         by=c("network_name", "hemi"))

prcusi_dice_all <- prcusi_dice_all %>% 
  group_by(network_name, hemi) %>%
  mutate(upper = dice_coefficient + se, 
         lower = dice_coefficient - se)

## Plot
prcusi_conn_fp_disc.plot <- ggplot(data = prcusi_dice_all) +  
  geom_polygon(aes(x = network_name, y = upper, fill = NA, group = hemi, color = hemi), 
               linetype = 2, size = .4) + 
  geom_polygon(aes(x = network_name, y = lower, fill = NA, group = hemi, color = hemi), 
               linetype = 2, size = .4) +
  geom_polygon(aes(x = network_name, y = dice_coefficient, fill = hemi, group = hemi, color = hemi), 
               size = .9, alpha = .1) +
  geom_point(aes(x = network_name, y = dice_coefficient, color = hemi), size = 2) + 
  coord_radar(start = -pi/2) +
  labs(x = "Network Name",
       y = "Dice Coefficient", 
       color = "Hemisphere",
       fill = "Hemisphere") +  
  theme_minimal() +
   theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(hjust = 0, size = 14),
        plot.caption = element_text(size = 12),
        axis.text=element_text(size=14),
        axis.title.x = element_text(size = 12, face = "bold",),
        axis.title.y = element_text(size = 12, face = "bold",),
        axis.text.x = element_text(size = 7, face = "bold", color = "black", vjust = .50),
        axis.text.y = element_text(size = 12, face = "bold"),
        strip.text.y = element_text(size = 12, face = "bold",),
        strip.text.x = element_text(size = 12, face = "bold",),
        legend.title = element_text(size=14, face = "bold"), 
        legend.text = element_text(size=12),
        legend.position = "bottom",
        axis.line = element_line(colour = "black", 
                                 size = 0, linetype = "solid", lineend = "round"),
        panel.grid.minor = element_line(size = 0.5, color = "gray"), 
        panel.grid.major = element_line(size = .75, color = "gray")) +
  scale_fill_manual(breaks = c("lh", "rh"), 
                    values = c("darkolivegreen","darkolivegreen4")) +
  scale_color_manual(breaks = c("lh", "rh"), 
                     values = c("darkolivegreen","darkolivegreen4")) + 
  guides(fill = F) +
  ylim(0,1) 
prcusi_conn_fp_disc.plot

# ggplot2::ggsave(filename = "prcusi_conn_fp_disc_plot.png",
#                 plot = prcusi_conn_fp_disc.plot,
#                 device = "png",
#                 width = 4,
#                 height = 4, 
#                 units = "in",
#                 dpi = "print")


# Prcus-p

# Dataset
prcusp_dice <- prcus_dice_disc %>% subset(label_name == "prcus-p")

# Subset to networks that it overlapped most with in order to clear up plot
prcusp_dice.2 <- prcusp_dice %>% subset(network_name %in% c('ControlB', 'ControlC', 'DefaultA',
                                              'DefaultB', 'DefaultC', 'DorsAttnA', 'SomMotorA',
                                              'VenAttnA', 'VenAttnB', 'VisualB'))
# Get mean for each network dice value 
prcusp_dice_avg <- prcusp_dice.2 %>% 
  group_by(network_name, hemi) %>% 
  summarise(dice_coefficient = mean(dice_coeff))

# Get se value for each network by hemi 

prcusp_dice_se <- prcusp_dice.2 %>% 
  group_by(hemi, network_name) %>%
  summarize(n=n(), sd=sd(dice_coeff), se=sd/sqrt(n))


# Merge & add and subtract se from mean to get upper and lower 
prcusp_dice_all <- merge(prcusp_dice_avg, prcusp_dice_se,
                         by=c("network_name", "hemi"))
prcusp_dice_all <- prcusp_dice_all %>% 
  group_by(network_name, hemi) %>%
  mutate(upper = dice_coefficient + se, 
         lower = dice_coefficient - se)

## Plot 
prcusp_conn_fp_disc.plot <- ggplot(data = prcusp_dice_all) + 
   geom_polygon(aes(x = network_name, y = upper, fill = NA, group = hemi, color = hemi), 
               linetype = 2, size = .4) + 
  geom_polygon(aes(x = network_name, y = lower, fill = NA, group = hemi, color = hemi), 
               linetype = 2, size = .4) +
  geom_polygon(aes(x = network_name, y = dice_coefficient, fill = hemi, group = hemi, color = hemi), 
               size = .9, alpha = .1) +
  geom_point(aes(x = network_name, y = dice_coefficient, color = hemi), size = 2) + 
  coord_radar(start = -pi/2) +
  labs(x = "Network Name",
       y = "Dice Coefficient", 
       color = "Hemisphere",
       fill = "Hemisphere") +  
  theme_minimal() +
   theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(hjust = 0, size = 14),
        plot.caption = element_text(size = 12),
        axis.text=element_text(size=14),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 7, face = "bold", color = "black", vjust = .50),
        axis.text.y = element_text(size = 12, face = "bold"),
        strip.text.y = element_text(size = 12, face = "bold"),
        strip.text.x = element_text(size = 12, face = "bold"),
        legend.title = element_text(size=14, face = "bold"), 
        legend.text = element_text(size=12),
        legend.position = "bottom",
        axis.line = element_line(colour = "black", 
                                 size = 0, linetype = "solid", lineend = "round"),
        panel.grid.minor = element_line(size = 0.5, color = "gray"), 
        panel.grid.major = element_line(size = .75, color = "gray"))+
  scale_fill_manual(breaks = c("lh", "rh"), 
                    values = c("#006d2c","#31a354")) +
  scale_color_manual(breaks = c("lh", "rh"), 
                     values = c("#006d2c", "#31a354")) +
   guides(fill = F) +
  ylim(0,1) 
prcusp_conn_fp_disc.plot

# ggplot2::ggsave(filename = "prcusp_conn_fp_disc_plot.png",
#                 plot = prcusp_conn_fp_disc.plot,
#                 device = "png",
#                 width = 8.5,
#                 height = 11, 
#                 units = "in",
#                 dpi = "print")
```

### Replication

#### Statistics
```{r, warning = FALSE}
# Replication dataset
prcus_dice_repl <- prcus_dice_all %>% subset(dataset == "HCP_replication")

# Anova
prcus_network_rep.rmaov <- aov(dice_coeff ~ hemi*label_name*network_name +
                               Error(TRG_sub/(hemi*label_name*network_name)), 
                             data = prcus_dice_repl)
summary(prcus_network_rep.rmaov) #p-values
rstatix::anova_summary(prcus_network_rep.rmaov, effect.size = "ges") #Eta-squared

# Post hoc test
prcus_network_rep_aov.i1 <- emmeans::emmeans(prcus_network_rep.rmaov, ~ label_name | network_name)
emmeans::contrast(prcus_network_rep_aov.i1, method='pairwise')
```

#### Results (replication)
Here we also observed a sulcus x network interaction effect (F(32, 3366) = 26.75, p < 0.001, η2G = 0.123). Post hoc tests revealed somewhat similar relationships to those observed in the discovery sample. Similar to the discovery sample, these sulci showed a posterior to anterior decrease in DMN-a overlap and a posterior to anterior increase in overlap with DMN-c (p-values < 0.001, Tukey’s adjustment). Each sulcus also overlapped with other networks than the DMN. *Prcus-a* overlapped more with CCN-b than *prcus-i* (p = 0.04, Tukey’s adjustment), but about the same as *prcus-p* (p > 0.05, Tukey’s adjustment) in this sample. Furthermore, *prcus-a* overlapped more with ventral attention network A, ventral attention network B, and visual network B than the other two sulci (p-values < 0.01, Tukey’s adjustment). Finally, *prcus-i* and *prcus-a* overlapped more with dorsal attention network A than *prcus-p* (p-values < 0.05, Tukey’s adjustment). See Supplementary Figure 6.4b in the supplementary materials or in the plot below.

#### Plots
```{r warning = FALSE}
# Prcus-a

# Dataset
prcusa_rep_dice <- prcus_dice_repl %>% subset(label_name == "prcus-a")

# Features for plot
prcusa_rep_dice$network_name <- gsub("DorsalAttentionA", "DorsAttnA", prcusa_rep_dice$network_name)
prcusa_rep_dice$network_name <- gsub("SomatomotorA", "SomMotorA", prcusa_rep_dice$network_name)
prcusa_rep_dice$network_name <- gsub("VentralAttentionA", "VenAttnA", prcusa_rep_dice$network_name)
prcusa_rep_dice$network_name <- gsub("VentralAttentionB", "VenAttnB", prcusa_rep_dice$network_name)


prcusa_rep_dice.2 <- prcusa_rep_dice %>% subset(network_name %in% c('ControlB', 'ControlC', 'DefaultA', 'DefaultB', 'DefaultC', 'DorsAttnA', 'SomMotorA', 'VenAttnA', 'VenAttnB', 'VisualB')) 

# Get mean for each network dice value 
prcusa_rep_dice_avg <- prcusa_rep_dice.2 %>% 
  group_by(network_name, hemi) %>% 
  summarise(dice_coefficient = mean(dice_coeff))

# Get se value for each network by hemi 
prcusa_rep_dice_se <- prcusa_rep_dice.2 %>% 
  group_by(hemi, network_name) %>%
  summarise(n=n(), 
            sd=sd(dice_coeff), 
            se=sd/sqrt(n))

# Merge & add and subtract se from mean to get upper and lower 
prcusa_rep_dice_all <- merge(prcusa_rep_dice_avg, prcusa_rep_dice_se,
                         by=c("network_name", "hemi"))

prcusa_rep_dice_all <- prcusa_rep_dice_all %>% 
  group_by(network_name, hemi) %>%
  mutate(upper = dice_coefficient + se, 
         lower = dice_coefficient - se)

## Plot
prcusa_conn_fp_repl.plot <- ggplot(data = prcusa_rep_dice_all) +  
  geom_polygon(aes(x = network_name, y = upper, fill = NA, group = hemi, color = hemi), 
              linetype = 2, size = .4) + 
  geom_polygon(aes(x = network_name, y = lower, fill = NA, group = hemi, color = hemi), 
              linetype = 2, size = .4) +
  geom_polygon(aes(x = network_name, y = dice_coefficient, fill = hemi, group = hemi, color = hemi), 
               size = .9, alpha = .1) +
  geom_point(aes(x = network_name, y = dice_coefficient, color = hemi), size = 2) + 
  coord_radar(start = -pi/2) +
  labs(x = "Network Name",
       y = "Dice Coefficient",
       color = "Hemisphere",
       fill = "Hemisphere") +  
    theme_minimal() +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(hjust = 0, size = 14),
        plot.caption = element_text(size = 12),
        axis.text=element_text(size=14),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 7, face = "bold", color = "black", vjust = .50),
        axis.text.y = element_text(size = 12, face = "bold"),
        strip.text.y = element_text(size = 12, face = "bold"),
        strip.text.x = element_text(size = 12, face = "bold"),
        legend.title = element_text(size = 14, face = "bold"), 
        legend.text = element_text(size=12),
        legend.position = "bottom",
        axis.line = element_line(colour = "black", 
                                 size = 0, linetype = "solid", lineend = "round"),
        panel.grid.minor = element_line(size = 0.5, color = "gray"), 
        panel.grid.major = element_line(size = .75, color = "gray")) +
  scale_fill_manual(breaks = c("lh", "rh"), 
                    values = c("darkolivegreen3","darkolivegreen2")) +
  scale_color_manual(breaks = c("lh", "rh"), 
                     values = c("darkolivegreen3", "darkolivegreen2")) + 
  guides(fill = F) +
  ylim(0,1)
prcusa_conn_fp_repl.plot

# ggplot2::ggsave(filename = "prcusa_conn_fp_repl_plot.png",
#                 plot = prcusa_conn_fp_repl.plot,
#                 device = "png",
#                 width = 4,
#                 height = 4, 
#                 units = "in",
#                 dpi = "print")


# Prcus-i

# Dataset
prcusi_dice_rep <- prcus_dice_repl %>% subset(label_name == "prcus-i")

# Features for plot
prcusi_dice_rep$network_name <- gsub("DorsalAttentionA", "DorsAttnA", prcusi_dice_rep$network_name)
prcusi_dice_rep$network_name <- gsub("SomatomotorA", "SomMotorA", prcusi_dice_rep$network_name)
prcusi_dice_rep$network_name <- gsub("VentralAttentionA", "VenAttnA", prcusi_dice_rep$network_name)
prcusi_dice_rep$network_name <- gsub("VentralAttentionB", "VenAttnB", prcusi_dice_rep$network_name)

prcusi_dice_rep.2 <- prcusi_dice_rep %>% subset(network_name %in% c('ControlB', 'ControlC', 'DefaultA',
                                              'DefaultB', 'DefaultC', 'DorsAttnA', 'SomMotorA',
                                              'VenAttnA', 'VenAttnB', 'VisualB'))
# Get mean for each network dice value 
prcusi_dice_rep_avg <- prcusi_dice_rep.2 %>% 
  group_by(network_name, hemi) %>% 
  summarise(dice_coefficient = mean(dice_coeff))

# Get se value for each network by hemi 
prcusi_dice_rep_se <- prcusi_dice_rep.2 %>% 
  group_by(hemi, network_name) %>%
  summarise(n=n(), 
            sd=sd(dice_coeff), 
            se=sd/sqrt(n))

# Merge & add and subtract se from mean to get upper and lower 
prcusi_dice_rep_all <- merge(prcusi_dice_rep_avg, prcusi_dice_rep_se,
                         by=c("network_name", "hemi"))
prcusi_dice_rep_all <- prcusi_dice_rep_all %>% 
  group_by(network_name, hemi) %>%
  mutate(upper = dice_coefficient + se, 
         lower = dice_coefficient - se)

## Plot
prcusi_conn_fp_repl.plot <- ggplot(data = prcusi_dice_rep_all) +  
  geom_polygon(aes(x = network_name, y = upper, fill = NA, group = hemi, color = hemi), 
               linetype = 2, size = .4) + 
  geom_polygon(aes(x = network_name, y = lower, fill = NA, group = hemi, color = hemi), 
               linetype = 2, size = .4) +
  geom_polygon(aes(x = network_name, y = dice_coefficient, fill = hemi, group = hemi, color = hemi), 
               size = .9, alpha = .1) +
  geom_point(aes(x = network_name, y = dice_coefficient, color = hemi), size = 2) + 
  coord_radar(start = -pi/2) +
  labs(x = "Network Name",
       y = "Dice Coefficient", 
       color = "Hemisphere",
       fill = "Hemisphere") +  
  theme_minimal() +
   theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(hjust = 0, size = 14),
        plot.caption = element_text(size = 12),
        axis.text=element_text(size=14),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 7, face = "bold", color = "black", vjust = .50),
        axis.text.y = element_text(size = 12, face = "bold"),
        strip.text.y = element_text(size = 12, face = "bold"),
        strip.text.x = element_text(size = 12, face = "bold"),
        legend.title = element_text(size=14, face = "bold"), 
        legend.text = element_text(size=12),
        legend.position = "bottom",
        axis.line = element_line(colour = "black", 
                                 size = 0, linetype = "solid", lineend = "round"),
        panel.grid.minor = element_line(size = 0.5, color = "gray"), 
        panel.grid.major = element_line(size = .75, color = "gray")) +
  scale_fill_manual(breaks = c("lh", "rh"), 
                    values = c("darkolivegreen","darkolivegreen4")) +
  scale_color_manual(breaks = c("lh", "rh"), 
                     values = c("darkolivegreen","darkolivegreen4")) + 
  guides(fill = F) +
  ylim(0,1) 
prcusi_conn_fp_repl.plot

# ggplot2::ggsave(filename = "prcusi_conn_fp_repl_plot.png",
#                 plot = prcusi_conn_fp_repl.plot,
#                 device = "png",
#                 width = 4,
#                 height = 4, 
#                 units = "in",
#                 dpi = "print")


# Prcus-p

# Dataset
prcusp_dice_rep <- prcus_dice_repl %>% subset(label_name == "prcus-p")

# Features for plot
prcusp_dice_rep$network_name <- gsub("DorsalAttentionA", "DorsAttnA", prcusp_dice_rep$network_name)
prcusp_dice_rep$network_name <- gsub("SomatomotorA", "SomMotorA", prcusp_dice_rep$network_name)
prcusp_dice_rep$network_name <- gsub("VentralAttentionA", "VenAttnA", prcusp_dice_rep$network_name)
prcusp_dice_rep$network_name <- gsub("VentralAttentionB", "VenAttnB", prcusp_dice_rep$network_name)

prcusp_dice_rep.2 <- prcusp_dice_rep %>% subset(network_name %in% c('ControlB', 'ControlC', 'DefaultA',
                                              'DefaultB', 'DefaultC', 'DorsAttnA', 'SomMotorA',
                                              'VenAttnA', 'VenAttnB', 'VisualB'))
# Get mean for each network dice value 
prcusp_dice_rep_avg <- prcusp_dice_rep.2 %>% 
  group_by(network_name, hemi) %>% 
  summarise(dice_coefficient = mean(dice_coeff))

# Get se value for each network by hemi 

prcusp_dice_rep_se <- prcusp_dice_rep.2 %>% 
  group_by(hemi, network_name) %>%
  summarise(n=n(), 
            sd=sd(dice_coeff), 
            se=sd/sqrt(n))


# Merge & add and subtract se from mean to get upper and lower 
prcusp_dice_rep_all <- merge(prcusp_dice_rep_avg, prcusp_dice_rep_se,
                         by=c("network_name", "hemi"))
prcusp_dice_rep_all <- prcusp_dice_rep_all %>% 
  group_by(network_name, hemi) %>%
  mutate(upper = dice_coefficient + se, 
         lower = dice_coefficient - se)

# Plot
prcusp_conn_fp_repl.plot <- ggplot(data = prcusp_dice_rep_all) + 
   geom_polygon(aes(x = network_name, y = upper, fill = NA, group = hemi, color = hemi), 
               linetype = 2, size = .4) + 
  geom_polygon(aes(x = network_name, y = lower, fill = NA, group = hemi, color = hemi), 
               linetype = 2, size = .4) +
  geom_polygon(aes(x = network_name, y = dice_coefficient, fill = hemi, group = hemi, color = hemi), 
               size = .9, alpha = .1) +
  geom_point(aes(x = network_name, y = dice_coefficient, color = hemi), size = 2) + 
  coord_radar(start = -pi/2) +
  labs(x = "Network Name",
       y = "Dice Coefficient", 
       color = "Hemisphere",
       fill = "Hemisphere") +  
   theme_minimal() +
   theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(hjust = 0, size = 14),
        plot.caption = element_text(size = 12),
        axis.text=element_text(size=14),
        axis.title.x = element_text(size = 12, face = "bold"),
        axis.title.y = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(size = 7, face = "bold", color = "black", vjust = .50),
        axis.text.y = element_text(size = 12, face = "bold"),
        strip.text.y = element_text(size = 12, face = "bold"),
        strip.text.x = element_text(size = 12, face = "bold"),
        legend.title = element_text(size = 14, face = "bold"), 
        legend.text = element_text(size=12),
        legend.position = "bottom",
        axis.line = element_line(colour = "black", 
                                 size = 0, linetype = "solid", lineend = "round"),
        panel.grid.minor = element_line(size = 0.5, color = "gray"), 
        panel.grid.major = element_line(size = .75, color = "gray"))+
  scale_fill_manual(breaks = c("lh", "rh"), 
                    values = c("#006d2c","#31a354")) +
  scale_color_manual(breaks = c("lh", "rh"), 
                     values = c("#006d2c", "#31a354")) +
   guides(fill = F) +
  ylim(0,1) 
prcusp_conn_fp_repl.plot

# ggplot2::ggsave(filename = "prcusp_conn_fp_repl_plot.png",
#                 plot = prcusp_conn_fp_repl.plot,
#                 device = "png",
#                 width = 4,
#                 height = 4, 
#                 units = "in",
#                 dpi = "print")
```

## Supplementary Figure 7.1: Correlation matrices for sulcal intersections of the discovery and replication sample shallow PCC sulci
```{r}
## Making matrices
# All HCP together

# hcp combined lh
sspls_lh_hcpC <-  c(0.23, 0,    0,    0, 0, 0, 0, 0,    0.03, 0, NA, 0,    0)
ifrms_lh_hcpC <-  c(0,    0,    0.13, 0, 0, 0, 0, 0.03, 0.11, 0, 0,  NA,   0.07)
icgs_p_lh_hcpC <- c(0,    0,    0.05, 0, 0, 0, 0, 0, 0, 0,    0,     0.12, NA)

hcpC_tert_lh_mat <- rbind(sspls_lh_hcpC, ifrms_lh_hcpC, icgs_p_lh_hcpC)
colnames(hcpC_tert_lh_mat)  <- c("cas", "cgs", "mcgs", "pos", "prculs", "prcus-p",
                                 "prcus-i", "prcus-a", "spls", "sps", "sspls", "ifrms", "icgs-p")
rownames(hcpC_tert_lh_mat) <- c("sspls", "ifrms", "icgs-p")

hcpC_tert_lh_mat <- as.data.frame(hcpC_tert_lh_mat)
#hcpC_tert_lh_mat <- hcpC_tert_lh_mat %>% select(-c(4:7,10))
hcpC_tert_lh_mat <- as.matrix(hcpC_tert_lh_mat)

# hcp combined rh 
sspls_rh_hcpC <-  c(0.32, 0,    0,    0, 0, 0, 0, 0, 0.03, 0, NA, 0,    0)
ifrms_rh_hcpC <-  c(0,    0,    0.06, 0, 0, 0, 0, 0, 0.21, 0, 0,  NA,   0.03)
icgs_p_rh_hcpC <- c(0,    0.04, 0.02, 0, 0, 0, 0, 0, 0,    0, 0,  0.04, NA)

hcpC_tert_rh_mat <- rbind(sspls_rh_hcpC, ifrms_rh_hcpC, icgs_p_rh_hcpC)
colnames(hcpC_tert_rh_mat)  <- c("cas", "cgs", "mcgs", "pos", "prculs", "prcus-p", 
                                 "prcus-i", "prcus-a", "spls", "sps", "sspls", "ifrms", "icgs-p")
rownames(hcpC_tert_rh_mat) <- c("sspls", "ifrms", "icgs-p")

hcpC_tert_rh_mat <- as.data.frame(hcpC_tert_rh_mat)
#hcpC_tert_rh_mat <- hcpC_tert_rh_mat %>% select(-c(4:7,10))
hcpC_tert_rh_mat <- as.matrix(hcpC_tert_rh_mat)

# Nora lh
sspls_lh_nora <-  c(0.16, 0,    0,    0, 0, 0, 0, 0, 0.05, 0, NA, 0,  0)
ifrms_lh_nora <-  c(0.03, 0,    0.11, 0, 0, 0, 0, 0, 0.08, 0, 0,  NA, 0)
icgs_p_lh_nora <- c(0.03, 0.09, 0.13, 0, 0, 0, 0, 0, 0,    0, 0,  0, NA)

nora_tert_lh_mat <- rbind(sspls_lh_nora, ifrms_lh_nora, icgs_p_lh_nora)
colnames(nora_tert_lh_mat)  <- c("cas", "cgs", "mcgs", "pos", "prculs",
                                 "prcus-p", "prcus-i", "prcus-a", "spls", "sps", "sspls", "ifrms", "icgs-p")
rownames(nora_tert_lh_mat) <- c("sspls", "ifrms", "icgs-p")

nora_tert_lh_mat <- as.data.frame(nora_tert_lh_mat)
#nora_tert_lh_mat <- nora_tert_lh_mat %>% select(-c(4:7,10))
nora_tert_lh_mat <- as.matrix(nora_tert_lh_mat)

# nora rh 
sspls_rh_nora <-  c(0.12, 0,    0,    0, 0, 0, 0, 0, 0.03, 0, NA, 0,    0)
ifrms_rh_nora <-  c(0.03, 0,    0.07, 0, 0, 0, 0, 0, 0.18, 0, 0,  NA,   0.01)
icgs_p_rh_nora <- c(0,    0.11, 0,    0, 0, 0, 0, 0, 0,    0, 0,  0.03, NA)

nora_tert_rh_mat <- rbind(sspls_rh_nora, ifrms_rh_nora, icgs_p_rh_nora)
colnames(nora_tert_rh_mat)  <- c("cas", "cgs", "mcgs", "pos", "prculs", "prcus-p",
                                 "prcus-i", "prcus-a", "spls", "sps", "sspls", "ifrms", "icgs-p")
rownames(nora_tert_rh_mat) <- c("sspls", "ifrms", "icgs-p")

nora_tert_rh_mat <- as.data.frame(nora_tert_rh_mat)
#nora_tert_rh_mat <- nora_tert_rh_mat %>% select(-c(4:7,10))
nora_tert_rh_mat <- as.matrix(nora_tert_rh_mat)

# ADNI
# lh 
sspls_lh_adni <-  c(0.21, 0, 0,    0, 0, 0, 0, 0,    0.09, 0, NA,   0,     0)
ifrms_lh_adni <-  c(0.01, 0, 0.1,  0, 0, 0, 0, 0,    0.07, 0, 0,    NA,    0.01)
icgs_p_lh_adni <- c(0.04, 0, 0.04, 0, 0, 0, 0, 0,    0,    0, 0,    0.04,  NA)

adni_tert_lh_mat <- rbind(sspls_lh_adni, ifrms_lh_adni, icgs_p_lh_adni)
colnames(adni_tert_lh_mat)  <- c("cas", "cgs", "mcgs", "pos", "prculs", 
                                 "prcus-p", "prcus-i", "prcus-a", "spls", "sps", "sspls", "ifrms", "icgs-p")
rownames(adni_tert_lh_mat) <- c("sspls", "ifrms", "icgs-p")

adni_tert_lh_mat <- as.data.frame(adni_tert_lh_mat)
#adni_tert_lh_mat <- adni_tert_lh_mat %>% select(-c(4:7,10))
adni_tert_lh_mat <- as.matrix(adni_tert_lh_mat)

# rh 
sspls_rh_adni <-  c(0.09, 0,    0,    0, 0, 0, 0, 0,    0.03, 0, NA, 0, 0)
ifrms_rh_adni <-  c(0.03, 0,    0.04, 0, 0, 0, 0, 0.01, 0.14, 0, 0, NA, 0)
icgs_p_rh_adni <- c(0.04, 0.07, 0.11, 0, 0, 0, 0, 0,    0,    0, 0, 0,  NA)

adni_tert_rh_mat <- rbind(sspls_rh_adni, ifrms_rh_adni, icgs_p_rh_adni)
colnames(adni_tert_rh_mat)  <- c("cas", "cgs", "mcgs", "pos", "prculs", "prcus-p", "prcus-i", "prcus-a", "spls", "sps", "sspls", "ifrms", "icgs-p")
rownames(adni_tert_rh_mat) <- c("sspls", "ifrms", "icgs-p")
adni_tert_rh_mat <- as.data.frame(adni_tert_rh_mat)
#adni_tert_rh_mat <- adni_tert_rh_mat %>% select(-c(4:7,10))
adni_tert_rh_mat <- as.matrix(adni_tert_rh_mat)


## correlations
## hcpC lh ~ rh
cor.test(c(as.matrix(hcpC_tert_lh_mat)), c(as.matrix(hcpC_tert_rh_mat)))

## nora lh ~ rh
cor.test(c(as.matrix(nora_tert_lh_mat)), c(as.matrix(nora_tert_rh_mat)))

## adni lh ~ rh
cor.test(c(as.matrix(adni_tert_lh_mat)), c(as.matrix(adni_tert_rh_mat)))

## hcpC lh ~ nora lh
cor.test(c(as.matrix(hcpC_tert_lh_mat)), c(as.matrix(nora_tert_lh_mat)))

## hcpC rh ~ nora rh
cor.test(c(as.matrix(hcpC_tert_rh_mat)), c(as.matrix(nora_tert_rh_mat)))

## hcpC lh ~ adni lh
cor.test(c(as.matrix(hcpC_tert_lh_mat)), c(as.matrix(adni_tert_lh_mat)))

## hcpC rh ~ adni rh
cor.test(c(as.matrix(hcpC_tert_rh_mat)), c(as.matrix(adni_tert_rh_mat)))

## nora lh ~ adni lh
cor.test(c(as.matrix(nora_tert_lh_mat)), c(as.matrix(adni_tert_lh_mat)))

## nora rh ~ adni rh
cor.test(c(as.matrix(nora_tert_rh_mat)), c(as.matrix(adni_tert_rh_mat)))

# Plot
colorscheme <- brewer.pal(n = 9, name = "OrRd")

#jpeg(filename = "~/Desktop/tert_sulctypes_dev.jpeg", res = 300, width = 10, height = 8, units = "in")
par(mar = c(4, 4.5, 5, 3),
    mfrow = c(3,2))
plot(nora_tert_lh_mat, 
     breaks=c(0, 0.01, 0.05, 0.1, 0.2, 0.4, 0.6, 0.8, 1.0), 
     digits=2,
     fmt.cell='%.2f',
     fmt.key = '%.2f',
     asp=F,
     cex.axis=.8,
     axis.col=list(side=3, las=2), 
     axis.row = list(side=2, las=1),
     key=list(side=4, cex.axis = .8),
     text.cell=list(cex=0.6),
     main = "", xlab = "", ylab = "",
    na.col="gray",
    col = colorscheme
     )
mtext(side=3, line=3.5, "juvenile (LH)",  font=2, cex=1)
mtext(side=2, line=3.5,"", font=2, cex=1)
mtext(side=1, line=3.5, "", font=2, cex=1)

plot(nora_tert_rh_mat, 
     breaks=c(0, 0.01, 0.05, 0.1, 0.2, 0.4, 0.6, 0.8, 1.0), 
     digits=2,
     fmt.cell='%.2f',
     fmt.key = '%.2f',
     asp=F,
     cex.axis=.8,
     axis.col=list(side=3, las=2), 
     axis.row = list(side=2, las=1),
     key=list(side=4, cex.axis = .8),
     text.cell=list(cex=0.6),
     main = "", xlab = "", ylab = "",
    na.col="gray",
    col = colorscheme
     )
mtext(side=3, line=3.5, "juvenile (RH)",  font=2, cex=1)
mtext(side=1, "",  font=2, cex=1)
mtext(side=2, line=3.5, "", font=2, cex=1)

plot(hcpC_tert_lh_mat, 
     breaks=c(0, 0.01, 0.05, 0.1, 0.2, 0.4, 0.6, 0.8, 1.0), 
     digits=2,
     fmt.cell='%.2f',
     fmt.key = '%.2f',
     asp=F,
     cex.axis=.8,
     axis.col=list(side=3, las=2), 
     axis.row = list(side=2, las=1),
     key=list(side=4, cex.axis = .8),
     text.cell=list(cex=0.6),
     main = "", xlab = "", ylab = "",
    na.col="gray",
    col = colorscheme
     )
mtext(side=3, line=3.5, "young adult (LH)",  font=2, cex=1)
mtext(side=2, line=3.5,"", font=2, cex=1)
mtext(side=1, line=3.5, "", font=2, cex=1)

plot(hcpC_tert_rh_mat, 
     breaks=c(0, 0.01, 0.05, 0.1, 0.2, 0.4, 0.6, 0.8, 1.0), 
     digits=2,
     fmt.cell='%.2f',
     fmt.key = '%.2f',
     asp=F,
     cex.axis=.8,
     axis.col=list(side=3, las=2), 
     axis.row = list(side=2, las=1),
     key=list(side=4, cex.axis = .8),
     text.cell=list(cex=0.6),
     main = "", xlab = "", ylab = "",
    na.col="gray",
    col = colorscheme
     )
mtext(side=3, line=3.5, "young adult (RH)",  font=2, cex=1)
mtext(side=1, "",  font=2, cex=1)
mtext(side=2, line=3.5, "", font=2, cex=1)

plot(adni_tert_lh_mat, 
     breaks=c(0, 0.01, 0.05, 0.1, 0.2, 0.4, 0.6, 0.8, 1.0), 
     digits=2,
     fmt.cell='%.2f',
     fmt.key = '%.2f',
     asp=F,
     cex.axis=.8,
     axis.col=list(side=3, las=2), 
     axis.row = list(side=2, las=1),
     key=list(side=4, cex.axis = .8),
     text.cell=list(cex=0.6),
     main = "", xlab = "", ylab = "",
    na.col="gray",
    col = colorscheme
     )
mtext(side=3, line=3.5, "healthy older adult (LH)",  font=2, cex=1)
mtext(side=1, line=.5, "intersections",  font=2, cex=1)
mtext(side=2, line=3.5, "", font=2, cex=1)

plot(adni_tert_rh_mat, 
     breaks=c(0, 0.01, 0.05, 0.1, 0.2, 0.4, 0.6, 0.8, 1.0), 
     digits=2,
     fmt.cell='%.2f',
     fmt.key = '%.2f',
     asp=F,
     cex.axis=.8,
     axis.col=list(side=3, las=2), 
     axis.row = list(side=2, las=1),
     key=list(side=4, cex.axis = .8),
     text.cell=list(cex=0.6),
     main = "", xlab = "", ylab = "",
    na.col="gray",
    col = colorscheme
     )
mtext(side=3, line=3.5, "healthy older adult (RH)",  font=2, cex=1)
mtext(side=1, line=.5, "intersections",  font=2, cex=1)
mtext(side=2, line=3.5, "", font=2, cex=1)
#dev.off()
```

## Supplementary Figure 7.2a: Raw sulcal depth (mm)
* 3-way (age group x species x hemi) ANOVA to test for differences in raw depth (mm)
* age group: juvenile, young adult, older adult
* species: human, chimpanzee
* hemi: lh, rh

### Statistics
```{r, warning = FALSE}
# ANOVA
comp_raw_depth.aov <- aov(sulcal_depth_mm ~ hemi * group * species, data = ifrms_compdev_morphology)
summary(comp_raw_depth.aov)
rstatix::anova_summary(comp_raw_depth.aov, effect.size = "ges") #Eta-squared

# Main effect of hemi
ifrms_compdev_morphology %>% group_by(hemi) %>% summarise(mean = mean(sulcal_depth_mm))

# Main effect of group
ifrms_compdev_morphology %>% group_by(group) %>% summarise(mean = mean(sulcal_depth_mm))

# Main effect of species
ifrms_compdev_morphology %>% group_by(species) %>% summarise(mean = mean(sulcal_depth_mm))
```

### Results
When using the raw (unnormalized) depth values, there were still main effects of hemisphere (F(1, 475) = 21.26, p < 0.001,  η2G = 0.04), age group (F(1, 475) = 9.61, p < 0.001,  η2G = 0.04), and species (F(1, 475) = 4.11, p = 0.043,  η2G = 0.008), with the same relationships between the hemispheres, age groups, and species as the normalized data. Therefore, while the *ifrms* is consistently shallow relative to primary and secondary sulci across species and age groups, its depth differs across age groups and between species. See Supplementary Figure 8a in the supplementary materials or in the plot below.

### Plot
```{r, warning = FALSE}
# Means for plot
comp_depth_raw_avg <- ifrms_compdev_morphology %>% 
  group_by(label, dataset, hemi) %>% 
  summarise(sulcal_depth_mm = mean(sulcal_depth_mm))

comp_depth_raw_sd <- ifrms_compdev_morphology %>% 
  group_by(label, dataset, hemi) %>% 
  summarise(sd = sd(sulcal_depth_mm))

# Plot
comp_depth_raw_stats <- merge(comp_depth_raw_avg, comp_depth_raw_sd, by = c("label", "dataset", "hemi"))

comp_depth_raw.plot <- ggplot(data = ifrms_compdev_morphology, 
                              aes(x = label, y = sulcal_depth_mm)) +
  geom_violin(data = ifrms_compdev_morphology, 
              aes(x = label, y = sulcal_depth_mm, fill = dataset), alpha = .6, position = dodge, width = 1) + 
  geom_jitter(data = ifrms_compdev_morphology, 
              aes(x = label, y = sulcal_depth_mm, fill = dataset), 
              alpha = .8, shape = 21, color = 'black',
              position=position_jitterdodge(jitter.width = .3, dodge.width = .9, jitter.height = 0)) +
  geom_pointrange(data = comp_depth_raw_stats, 
                  aes(label, sulcal_depth_mm, ymin=sulcal_depth_mm-sd, 
                      ymax=sulcal_depth_mm+sd, 
                      fill = dataset), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
  labs(x = comp_norm_x,
       y = depth_y) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=20, face = "bold"),
        axis.text.x = element_text(size = 0, face = "bold"),
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14, face = "bold"), 
        legend.text = element_text(size=6),
        axis.ticks.x = element_blank(), 
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round"),
        strip.text.x = element_text(size = 12, face = "bold"),
        legend.position = "bottom",
        strip.background = element_blank()) + 
  scale_color_manual(breaks = 
                       c("NORA", "young_chimp", "HCP", "young_adult_chimp", "ADNI", "older_adult_chimp"),
                     values = c("#e41a1c", "#f03b20","#377eb8", "#41b6c4", "#006837", "#2ca25f")) + 
  scale_fill_manual(breaks = 
                      c("NORA", "young_chimp", "HCP", "young_adult_chimp", "ADNI", "older_adult_chimp"),
                    values = c("#e41a1c", "#f03b20","#377eb8", "#74a9cf", "#006837", "#31a354")) +
  
  guides(alpha = F) + 
  facet_wrap(~hemi) + 
  scale_y_continuous(breaks=seq(0,15,2))
comp_depth_raw.plot

# ggplot2::ggsave(filename = "comp_depth_raw_plot.png",
#                 plot = comp_depth_raw.plot,
#                 device = "png",
#                 width = 10,
#                 height = 5, 
#                 units = "in",
#                 dpi = "print")
```

## Supplemental Figure 7.2b: Raw cortical thickness 
* 3-way (age group x species x hemi) ANOVA to test for differences in raw cortical thickness (mm)
* age group: juvenile, young adult, older adult
* species: human, chimpanzee
* hemi: lh, rh

### Statistics
```{r, warning = FALSE}
# ANOVA
comp_raw_thick.aov<- aov(cortical_thickness_mean ~ hemi * group * species, 
                          data = ifrms_compdev_morphology)
summary(comp_raw_thick.aov)
rstatix::anova_summary(comp_raw_thick.aov, effect.size = "ges") #Eta-squared

# Main effect of group
ifrms_compdev_morphology %>% group_by(group) %>% summarise(mean = mean(cortical_thickness_mean))

# Main effect of species
ifrms_compdev_morphology %>% group_by(species) %>% summarise(mean = mean(cortical_thickness_mean))

# Interaction effect between hemi and species
ifrms_compdev_morphology %>% group_by(hemi, species) %>% summarise(mean = mean(cortical_thickness_mean))
```

### Results
When using the raw (unnormalized) FreeSurfer thickness values, these effects were replicated: that is, main effects of age group (F(1, 475) = 135.4, p < 0.001,  η2G = 0.33) and species (F(1, 475) = 63.59, p < 0.001,  η2G = 0.08), as well as the hemisphere x species interaction (F(1, 475) = 6.98, p = 0.009,  η2G = 0.008). Thus, the *ifrms* shows a prominent age- and species-related decline in cortical thickness across age groups and species. See Supplementary Figure 8b in the supplementary materials or in the plot below.

### Plot
```{r, warning = FALSE}
# Means for plot
comp_ct_avg <- ifrms_compdev_morphology %>% 
  group_by(label, dataset, hemi) %>% 
  summarise(cortical_thickness_mean = mean(cortical_thickness_mean))

comp_ct_sd <- ifrms_compdev_morphology %>% 
  group_by(label, dataset, hemi) %>% 
  summarise(sd = sd(cortical_thickness_mean))

# Plot
comp_ct_stats <- merge(comp_ct_avg, comp_ct_sd, by = c("label", "dataset", "hemi"))
ct_y <- expression(paste(bold("mean cortical thickness "), italic("(mm)")))

comp_ct_raw.plot <- ggplot(data = ifrms_compdev_morphology, 
                           aes(x = label, y = cortical_thickness_mean)) +
  geom_violin(data = ifrms_compdev_morphology, 
              aes(x = label, y = cortical_thickness_mean, fill = dataset), 
              alpha = .6, position = dodge, width = 1) + 
  geom_jitter(data = ifrms_compdev_morphology, 
              aes(x = label, y = cortical_thickness_mean, fill = dataset), 
              color = 'black', alpha = .8, shape = 21,
              position=position_jitterdodge(jitter.width = .3, dodge.width = .9, jitter.height = 0)) +
  geom_pointrange(data = comp_ct_stats, 
                  aes(label, cortical_thickness_mean, 
                      ymin=cortical_thickness_mean-sd, ymax=cortical_thickness_mean+sd, 
                      fill = dataset), 
                  shape = 21, position = dodge, size = 1.25, fatten = 3) +
  labs(x = comp_norm_x,
       y = ct_y) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=20, face = "bold"),
        axis.text.x = element_text(size = 0, face = "bold"),
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14, face = "bold"), 
        legend.text = element_text(size=6),
        axis.ticks.x = element_blank(), 
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round"),
        strip.text.x = element_text(size = 12, face = "bold"),
        legend.position = "bottom",
        strip.background = element_blank()) + 
  scale_color_manual(breaks = 
                       c("NORA", "young_chimp", "HCP", "young_adult_chimp", "ADNI", "older_adult_chimp"),
                     values = c("#e41a1c", "#f03b20","#377eb8", "#41b6c4", "#006837", "#2ca25f")) + 
  scale_fill_manual(breaks = 
                      c("NORA", "young_chimp", "HCP", "young_adult_chimp", "ADNI", "older_adult_chimp"),
                    values = c("#e41a1c", "#f03b20","#377eb8", "#74a9cf", "#006837", "#31a354")) +
  scale_y_continuous(breaks=seq(0,4.5,.5)) +
  guides(alpha = F) + 
  facet_wrap(~hemi)
comp_ct_raw.plot

# ggplot2::ggsave(filename = "comp_ct_raw_plot.png",
#                 plot = comp_ct_raw.plot,
#                 device = "png",
#                 width = 10,
#                 height = 5, 
#                 units = "in",
#                 dpi = "print")
```

## Supplemental Figure 9a: Depth of all PMC sulci between age groups (humans)
* 3-way (sulcal label x age group x hemi) ANOVA to test for differences in raw depth (mm)
* sulcal label: 11 PMC (PCC & PRC) sulci (see Methods for description)
* age group: juvenile, young adult, older adult
* hemi: lh, rh

### Statistics
```{r, warning = FALSE}
# Dataset 
development_all_morphology <- read.csv("~/Desktop/RMD_csvs/developmental_all_morphology.csv")

# ANOVA
dev_pmc_depth.aov <- aov(sulcal_depth_mm ~ label * group * hemi, data = development_all_morphology)
summary(dev_pmc_depth.aov)
rstatix::anova_summary(dev_pmc_depth.aov, effect.size = "ges") #Eta-squared

dev_pmc_dep.m1 <- emmeans::emmeans(dev_pmc_depth.aov,'label')
emmeans::contrast(dev_pmc_dep.m1, method='pairwise')

dev_pmc_dep.m2 <- emmeans::emmeans(dev_pmc_depth.aov,'group')
emmeans::contrast(dev_pmc_dep.m2, method='pairwise')

dev_pmc_dep.m3 <- emmeans::emmeans(dev_pmc_depth.aov,'hemi')
emmeans::contrast(dev_pmc_dep.m3, method='pairwise')

dev_pmc_dep.i1 <- emmeans::emmeans(dev_pmc_depth.aov,'group','label')
emmeans::contrast(dev_pmc_dep.i1, method='pairwise')

dev_pmc_dep.i2 <- emmeans::emmeans(dev_pmc_depth.aov,'hemi','label')
emmeans::contrast(dev_pmc_dep.i2, method='pairwise')

dev_pmc_dep.i3 <- emmeans::emmeans(dev_pmc_depth.aov,'hemi','group')
emmeans::contrast(dev_pmc_dep.i3, method='pairwise')
```
We observed a main effect of sulcus (F(10, 4195) = 1657.74, p < 0.001,  η2G = 0.78). Here, post hoc analyses confirmed that the the differences in depth between sulci observed in the young adult samples hold when all age groups are included (p-values < 0.001, Tukey's adjustment). 

There was also a main effect of age group (F(2, 4195) = 53.82, p < 0.001,  η2G = 0.005), where sulci were generally deeper in juveniles than in young adults (p < 0.001, Tukey's method) and older adults (p < 0.001, Tukey's method). Additionally, there was also a sulcus x age group interaction (F(20, 4195) = 6.21, p < 0.001,  η2G = 0.006), indicating that not all sulci differed by age group. Specifically, i) the *prcus-p*, *prcus-a*, *sps*, *spls*, and *mcgs* were all deeper in juveniles than in young adults (p-values < 0.05, Tukey's method) and older adults (p-values < 0.05, Tukey's method), ii) the *prcus-i* was deeper in juveniles than in young adults (p < 0.001, Tukey's method) and older adults (p < 0.001, Tukey's method), as well as deeper in young adults than in older adults (p = 0.001, Tukey's method), iii) the *ifrms* was deeper in juveniles than in young adults (p = 0.034, Tukey's adjustment) and deeper in older adults than young adults (p = 0.003, Tukey's adjustment), and iv) The *prculs* was marginally deeper in older adults than juveniles (p = 0.087, tukey's adjustment). Importantly, the magnitude of difference between age groups was unique for each sulcus. 

Finally, there were multiple effects related to hemisphere. First, there was a main effect of hemisphere (F(1, 4195) = 113, p < 0.001,  η2G = 0.005), where, across the age group and sulcus factors, sulci were deeper in the left than right hemisphere. Second, there was also a sulcus x hemisphere interaction (F(10, 4195) = 5.26, p < 0.001  η2G = 0.002), where across age groups, all sulci but the *pos* were deeper (to differing degrees) in the left hemisphere (p-values < 0.05, Tukey's method), while the *pos* was instead deeper in the right hemisphere (p = 0.033, Tukey's method). Third, there was an age group x hemisphere interaction (F(2, 4195) = 3.7, p = 0.025,  η2G = 0), where all three age groups were deeper (albeit to differing degrees) in left hemisphere (p-values < 0.001, Tukey's method).See Supplementary Figure 9x in the supplementary materials or in the plot below.

### Plot
```{r}
## Means for plot
dev_depth_means <- development_all_morphology %>% 
  group_by(label, group_hemi) %>% 
  summarise(sulcal_depth_mm = mean(sulcal_depth_mm))
dev_depth_sd <- development_all_morphology %>% 
  group_by(label, group_hemi) %>% 
  summarise(sd = sd(sulcal_depth_mm),
            n = n(),
            se = sd/sqrt(n))
dev_depth_stats <- merge(dev_depth_means, dev_depth_sd, 
                                   by = c("label", "group_hemi"))

# Plot

## Organize features for plot
dev_depth_stats$group_hemi <- factor(dev_depth_stats$group_hemi, 
                                                    levels = c("j lh", "ya lh","oa lh", 
                                                               "j rh", "ya rh", "oa rh"))

development_all_morphology$group_hemi <- factor(development_all_morphology$group_hemi, 
                                        levels = c("j lh", "ya lh", "oa lh", 
                                                   "j rh", "ya rh", "oa rh"))

dev_depth_stats$label <- factor(dev_depth_stats$label, 
                                                 levels = c("pos", "prculs", "prcus-p", "prcus-i", "prcus-a",
                                                            "sps", "spls", "mcgs", "sspls", "ifrms", "icgs-p"))

development_all_morphology$label <- factor(development_all_morphology$label, 
                                     levels = c("pos", "prculs", "prcus-p", "prcus-i", "prcus-a",
                                                "sps", "spls", "mcgs", "sspls", "ifrms", "icgs-p"))

## Visualize
depth_y <- expression(paste(bold("sulcal depth "), italic("(mm)")))
scaleFUN <- function(x) sprintf("%.2f", x) # to ensure two sig figs

dev_depth.plot <- ggplot(development_all_morphology, aes(x = group_hemi, fill = group_hemi)) +
  geom_boxplot(aes(x = group_hemi, y = sulcal_depth_mm, fill = group_hemi),
               color = 'black',
               alpha = .6, position = dodge) +
  #geom_col(data = dev_depth_stats, 
           #aes(x = group_hemi, y = sulcal_depth_mm, fill = group_hemi), 
           #color = 'black',
           #alpha = .6, position = dodge) +
  #geom_jitter(aes(y = cortical_thickness_mean), 
             # shape = 21, color = 'black', alpha = .5, #was .8
             # position=position_jitterdodge(jitter.width = 2, 
             #                               dodge.width = .5, jitter.height = 0)) + 
  #geom_pointrange(data = dlpfc_dev_comparison.sa.stats, 
  #                aes(group_hemi, total_surface_area_.mm.2., ymin=total_surface_area_.mm.2.-sd,
  #ymax=total_surface_area_.mm.2.+sd, 
  #                    fill = group_hemi), 
  #                shape = 21, size = 1, fatten = 4) +
  #geom_errorbar(data = dev_depth_stats, 
                #aes(group_hemi, ymin=sulcal_depth_mm-sd, 
                #                ymax=sulcal_depth_mm+sd),
                #width = 0.5, size = .75) +
  scale_x_discrete(breaks = c("j lh", "ya lh", "oa lh", "j rh", "ya rh", "oa rh"), 
                   labels = c("j", "ya", "oa", "j", "ya", "oa")) +
  scale_fill_manual(breaks = c("j lh", "ya lh", "oa lh", "j rh", "ya rh", "oa rh"),
                    values = c("#e41a1c", "#377eb8", "#006837", "#f03b20", "#41b6c4", "#2ca25f")) +
  scale_color_manual(breaks = c("j lh", "ya lh", "oa lh", "j rh", "ya rh", "oa rh"),
                     values = c("#252525", "#252525", "#252525", "#636363", "#636363", "#636363")) +
  guides(fill = FALSE, color = FALSE) +
  labs(x = "PCC and PRC sulci",
       y = depth_y) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=20, face = "bold"),
        axis.text.x = element_text(size = 0, face = "bold", vjust = .70), # was 7 / 16
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        strip.text.x = element_text(size = 14, face = "bold"),
        strip.background = element_blank(),
        strip.placement = "outside",
        axis.ticks.x = element_blank(), 
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  facet_wrap( ~ label, strip.position = "bottom", scales = "free_x", ncol=11) +
  scale_y_continuous(breaks=seq(0, 28, 2.5), limits = c(0,28))
                     #labels=scaleFUN)
dev_depth.plot

# ggplot2::ggsave(filename = "~/Desktop/dev_depth_plot.png",
#                  plot = dev_depth.plot,
#                  device = "png",
#                  width = 10,
#                  height = 5, 
#                  units = "in",
#                  dpi = "retina")
```

## Supplemental Figure 9b: Surface area of all PCC and PRC sulci between age groups (humans)
* 3-way (sulcal label x age group x hemi) ANOVA to test for differences in surface area (mm^2)
* sulcal label: 11 PMC (PCC & PRC) sulci (see Methods for description)
* age group: juvenile, young adult, older adult
* hemi: lh, rh

### Statistics
```{r, warning = FALSE}
# ANOVA
dev_pmc_sa.aov <- aov(total_surface_area_.mm.2. ~ label * group * hemi, data = development_all_morphology)
summary(dev_pmc_sa.aov)
rstatix::anova_summary(dev_pmc_sa.aov, effect.size = "ges") #Eta-squared

# Post hoc tests
dev_pmc_sa.m1 <- emmeans::emmeans(dev_pmc_sa.aov,'label')
emmeans::contrast(dev_pmc_sa.m1, method='pairwise')

dev_pmc_sa.m2 <- emmeans::emmeans(dev_pmc_sa.aov,'group')
emmeans::contrast(dev_pmc_sa.m2, method='pairwise')

dev_pmc_sa.i1 <- emmeans::emmeans(dev_pmc_sa.aov,'group','label')
emmeans::contrast(dev_pmc_sa.i1, method='pairwise')

dev_pmc_sa.i2 <- emmeans::emmeans(dev_pmc_sa.aov,'hemi','label')
emmeans::contrast(dev_pmc_sa.i2, method='pairwise')
```
We observed a main effect of sulcus (F(10, 4195) = 1371.19, p < 0.001,  η2G = 0.76). Post hoc analyses on this main effect revealed that across age groups, the three putative tertiary sulci have the smallest surface area of the PCC and PRC sulci (p-values < 0.001, Tukey’s adjustment). 

There was also an additional main effect of age group (F(2, 4195) = 14.4, p < 0.001, η2G = 0.002), and a sulcus x age group interaction F(20, 4195) = 2.27, p = 0.001, η2G = 0.003). Post hoc analyses revealed that the former main effect was driven by the PCC and PRC sulci having generally larger surface areas in juveniles than in young adults (p = 0.029, Tukey’s adjustment) and older adults (p < 0.001, Tukey’s adjustment), as well as young adults having marginally larger surface areas than older adults (p = 0.069, Tukey's adjustment). Post hoc analyses showed that the latter interaction effect was driven primarily by i) the *pos* having a larger surface area in juveniles than young adults (p = 0.01, Tukey’s adjustment) and older adults (p < 0.001, Tukey’s adjustment), ii) the *prculs* having a smaller surface area in juveniles than young adults (p = 0.002, Tukey's adjustment) and marginally smaller surface area in juveniles than older adults (p = 0.08, Tukey's adjustment), and iii) the *prcus-i*, *prcus-p*, *sps*, and *spls* having a larger surface area in juveniles than older adults (p-values < 0.05, Tukey’s adjustment); however, the three putative tertiary sulci showed no differences in surface area across the three age groups (p-values > 0.1, Tukey’s adjustment). 

Finally, there was a sulcus x hemisphere interaction (F(10, 4195) = 14.38, p < 0.001, η2G = 0.008). Post hoc analyses revealed that, across age groups, i) the *pos* has a smaller surface area in the left hemisphere (p < 0.001, Tukey’s adjustment), ii) the *mcgs* and *prcus-a* have a larger surface area in the left hemisphere (p-values < 0.05, Tukey's adjustment), and iii) the *sps* has a marginally larger surface area in the left hemisphere (p = 0.55, Tukey’s adjustment). See Supplementary Figure 9x in the supplementary materials or in the plot below.

### Plots <- edit
```{r, warning = FALSE}
# Means for plot
dev_all_morphology_sa_means <- development_all_morphology %>% 
  group_by(label, group_hemi) %>% 
  summarise(total_surface_area_.mm.2. = mean(total_surface_area_.mm.2.)/100)
dev_all_morphology_sa_sd <- development_all_morphology %>% 
  group_by(label, group_hemi) %>% 
  summarise(sd = sd(total_surface_area_.mm.2.)/100,
            n = n(),
            se = sd/sqrt(n))
dev_all_morphology_sa_stats <- merge(dev_all_morphology_sa_means, dev_all_morphology_sa_sd, 
                                                by = c("label", "group_hemi"))

dev_all_morphology_sa_stats$group_hemi <- factor(dev_all_morphology_sa_stats$group_hemi, 
                                                    levels = c("j lh", "ya lh","oa lh", 
                                                               "j rh", "ya rh", "oa rh"))

development_all_morphology$group_hemi <- factor(development_all_morphology$group_hemi, 
                                        levels = c("j lh", "ya lh", "oa lh", 
                                                   "j rh", "ya rh", "oa rh"))

dev_all_morphology_sa_stats$label <- factor(dev_all_morphology_sa_stats$label, 
                                                 levels = c("pos", "prculs", "prcus-p", "prcus-i", "prcus-a",
                                                            "sps", "spls", "mcgs", "sspls", "ifrms", "icgs-p"))

development_all_morphology$label <- factor(development_all_morphology$label, 
                                     levels = c("pos", "prculs", "prcus-p", "prcus-i", "prcus-a",
                                                "sps", "spls", "mcgs", "sspls", "ifrms", "icgs-p"))
## All Plot
scaleFUN <- function(x) sprintf("%.2f", x) # to ensure two sig figs
sa_y <- expression(paste(bold("total surface area "), italic("(mm^2)")))

dev_sa.plot <- ggplot(development_all_morphology, aes(x = group_hemi, fill = group_hemi)) +
  geom_boxplot(aes(x = group_hemi, y = total_surface_area_.mm.2./100, fill = group_hemi),
               color = 'black',
               alpha = .6, position = dodge) +
  #geom_col(data = dev_all_morphology_sa_stats, 
           #aes(x = group_hemi, y = total_surface_area_.mm.2., fill = group_hemi), 
           #color = 'black',
           #alpha = .6, position = dodge) +
  #geom_jitter(aes(y = cortical_thickness_mean), 
             # shape = 21, color = 'black', alpha = .5, #was .8
             # position=position_jitterdodge(jitter.width = 2, 
             #                               dodge.width = .5, jitter.height = 0)) + 
  #geom_pointrange(data = dlpfc_dev_comparison.sa.stats, 
  #                aes(group_hemi, total_surface_area_.mm.2., ymin=total_surface_area_.mm.2.-sd,
  #ymax=total_surface_area_.mm.2.+sd, 
  #                    fill = group_hemi), 
  #                shape = 21, size = 1, fatten = 4) +
  # geom_errorbar(data = dev_all_morphology_sa_stats, 
  #              aes(group_hemi, ymin=total_surface_area_.mm.2.-sd, 
  #                              ymax=total_surface_area_.mm.2.+sd),
  #              width = 0.5, size = .75) +
  scale_x_discrete(breaks = c("j lh", "ya lh", "oa lh", "j rh", "ya rh", "oa rh"), 
                   labels = c("j", "ya", "oa", "j", "ya", "oa")) +
  scale_fill_manual(breaks = c("j lh", "ya lh", "oa lh", "j rh", "ya rh", "oa rh"),
                    values = c("#e41a1c", "#377eb8", "#006837", "#f03b20", "#41b6c4", "#2ca25f")) +
  scale_color_manual(breaks = c("j lh", "ya lh", "oa lh", "j rh", "ya rh", "oa rh"),
                     values = c("#252525", "#252525", "#252525", "#636363", "#636363", "#636363")) +
  guides(fill = FALSE, color = FALSE) +
  labs(x = "PCC and PRC sulci",
       y = sa_y) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=20, face = "bold"),
        axis.text.x = element_text(size = 0, face = "bold", vjust = .70), # was 7 / 16
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        strip.text.x = element_text(size = 14, face = "bold"),
        strip.background = element_blank(),
        strip.placement = "outside",
        axis.ticks.x = element_blank(), 
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  facet_wrap( ~ label, strip.position = "bottom", scales = "free_x", ncol=11) +
  scale_y_continuous(breaks=seq(0, 20, 1.5), limits = c(0,20))

dev_sa.plot

# ggplot2::ggsave(filename = "dev_sa_plot.png",
#                  plot = dev_sa.plot,
#                  device = "png",
#                  width = 10,
#                  height = 5, 
#                  units = "in",
#                  dpi = "retina")
```

## Supplemental Figure 9c: Cortical thickness of all PMC sulci in juveniles
* 2-way (sulcal label x age group x hemi) ANOVA to test for differences in cortical thickness (mm)
* sulcal label: 11 PMC (PCC & PRC) sulci (see Methods for description)
* age group: juvenile, young adult, older adult
* hemi: lh, rh

### Statistics
```{r, warning = FALSE}
# ANOVA
dev_pmc_ct.aov <- aov(cortical_thickness_mean ~ label * group * hemi, data = development_all_morphology)
summary(dev_pmc_ct.aov)
rstatix::anova_summary(dev_pmc_ct.aov, effect.size = "ges") #Eta-squared

# Post hoc tests
dev_pmc_ct.m1 <- emmeans::emmeans(dev_pmc_ct.aov,'label')
emmeans::contrast(dev_pmc_ct.m1, method='pairwise')

dev_pmc_ct.m2 <- emmeans::emmeans(dev_pmc_ct.aov,'group')
emmeans::contrast(dev_pmc_ct.m2, method='pairwise')

dev_pmc_ct.m3 <- emmeans::emmeans(dev_pmc_ct.aov,'hemi')
emmeans::contrast(dev_pmc_ct.m3, method='pairwise')

dev_pmc_ct.i1 <- emmeans::emmeans(dev_pmc_ct.aov,'group','label')
emmeans::contrast(dev_pmc_ct.i1, method='pairwise')
```
We observed a main effect of sulcus (F(10, 4195) = 871.83, p < 0.001,  η2G = 0.58). Post hoc analyses on this main effect revealed that across age groups, the *ifrms* remains the thickest sulcus in the region (p-values < 0.01, Tukey's adjustment). 

There was also a main effect of age group (F(2, 4195) = 838.75, p < 0.001, η2G = 0.11), and a sulcus x age group  interaction F(20, 4195) = 18.26, p = 0.001, η2G = 0.024). Post hoc analyses on the former main effect showed that, in general, the PCC and PRC sulci decreased in thickness from the younger to older age groups (p-values < 0.001, Tukey's adjustment). Post hoc analyses on the latter interaction effect revealed that there were unique relationships in the age group differences in cortical thickness for each sulcus. While the *pos*, *prculs*, *prcus-p*, *spls*, *mcgs*, *sspls*, *ifrms*, and *icgs-p* all present large declines in thickness from the juvenile to young adult to older adult age group (p-values <= 0.001, Tukey's adjustment), the exact magnitude of the decline differed by sulcus. Additionally, the *prcus-i*, *prcus-a* and *sps* only showed a decline in thickness from the juvenile to older adult age group, as well as from the young adult to older adult age group (p-values < 0.001, Tukey's adjustment). 

Finally, there was a main effect of hemisphere F(2, 4195) = 3.88, p = 0.049, η2G = 0), where sulci were generally thicker in right hemisphere. See Supplementary Figure 9x in the supplementary materials or in the plot below.

### Plot
```{r}
## Means for plot
dev_ct_means <- development_all_morphology %>% 
  group_by(label, group_hemi) %>% 
  summarise(cortical_thickness_mean = mean(cortical_thickness_mean))
dev_ct_sd <- development_all_morphology %>% 
  group_by(label, group_hemi) %>% 
  summarise(sd = sd(cortical_thickness_mean),
            n = n(),
            se = sd/sqrt(n))
dev_ct_stats <- merge(dev_ct_means, dev_ct_sd, 
                                   by = c("label", "group_hemi"))

# Plot
ct_y <- expression(paste(bold("mean cortical thickness "), italic("(mm)")))

## Organize features for plot
dev_ct_stats$group_hemi <- factor(dev_ct_stats$group_hemi, 
                                                    levels = c("j lh", "ya lh","oa lh", 
                                                               "j rh", "ya rh", "oa rh"))

development_all_morphology$group_hemi <- factor(development_all_morphology$group_hemi, 
                                        levels = c("j lh", "ya lh", "oa lh", 
                                                   "j rh", "ya rh", "oa rh"))

dev_ct_stats$label <- factor(dev_ct_stats$label, 
                                                 levels = c("pos", "prculs", "prcus-p", "prcus-i", "prcus-a",
                                                            "sps", "spls", "mcgs", "sspls", "ifrms", "icgs-p"))

development_all_morphology$label <- factor(development_all_morphology$label, 
                                     levels = c("pos", "prculs", "prcus-p", "prcus-i", "prcus-a",
                                                "sps", "spls", "mcgs", "sspls", "ifrms", "icgs-p"))

## Visualize
dev_ct.plot <- ggplot(development_all_morphology, aes(x = group_hemi, fill = group_hemi)) +
  geom_boxplot(aes(x = group_hemi, y = cortical_thickness_mean, fill = group_hemi),
               color = 'black',
               alpha = .6, position = dodge) +
  #geom_col(data = dev_ct_stats, 
  #         aes(x = group_hemi, y = cortical_thickness_mean, fill = group_hemi), 
  #         color = 'black',
  #         alpha = .6, position = dodge) +
  #geom_jitter(aes(y = cortical_thickness_mean), 
  #            shape = 21, color = 'black', alpha = .5, #was .8
  #            position=position_jitterdodge(jitter.width = 2, 
  #                                          dodge.width = .5, jitter.height = 0)) + 
  #geom_pointrange(data = dlpfc_dev_comparison.sa.stats, 
  #                aes(group_hemi, total_surface_area_.mm.2., ymin=total_surface_area_.mm.2.-sd,
  #ymax=total_surface_area_.mm.2.+sd, 
  #                    fill = group_hemi), 
  #                shape = 21, size = 1, fatten = 4) +
  #geom_errorbar(data = dev_ct_stats, 
  #              aes(group_hemi, ymin=cortical_thickness_mean-sd, 
  #                              ymax=cortical_thickness_mean+sd),
  #              width = 0.5, size = .75) +
  scale_x_discrete(breaks = c("j lh", "ya lh", "oa lh", "j rh", "ya rh", "oa rh"), 
                   labels = c("j", "ya", "oa", "j", "ya", "oa")) +
  scale_fill_manual(breaks = c("j lh", "ya lh", "oa lh", "j rh", "ya rh", "oa rh"),
                    values = c("#e41a1c", "#377eb8", "#006837", "#f03b20", "#41b6c4", "#2ca25f")) +
  scale_color_manual(breaks = c("j lh", "ya lh", "oa lh", "j rh", "ya rh", "oa rh"),
                     values = c("#252525", "#252525", "#252525", "#636363", "#636363", "#636363")) +
  guides(fill = FALSE, color = FALSE) +
  labs(x = "PCC and PRC sulci",
       y = ct_y) + 
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
        plot.subtitle = element_text(size = 12),
        plot.caption = element_text(size = 12, hjust = 1),
        axis.title.x = element_text(size=20, face = "bold", vjust = .70),
        axis.title.y = element_text(size=20, face = "bold"),
        axis.text.x = element_text(size = 0, face = "bold", vjust = .70), # was 7 / 16
        axis.text.y = element_text(size = 20, face = "bold"),
        legend.title = element_text(size=14), 
        legend.text = element_text(size=12),
        strip.text.x = element_text(size = 14, face = "bold"),
        strip.background = element_blank(),
        strip.placement = "outside",
        axis.ticks.x = element_blank(), 
        axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  facet_wrap( ~ label, strip.position = "bottom", scales = "free_x", ncol=11) +
  scale_y_continuous(breaks=seq(0, 5.0, .5), limits = c(0,5.0),
                     labels=scaleFUN)
dev_ct.plot


# ggplot2::ggsave(filename = "dev_ct_plot_ind.png",
#                  plot = dev_ct.plot,
#                  device = "png",
#                  width = 10,
#                  height = 5, 
#                  units = "in",
#                  dpi = "retina")
```

## Supplemental Figure 10: Evaluation of the spherical CNNs ability to define PMC sulci 
```{r, warning = FALSE}
# Features for plot
pmc_nn_predicts$sulci <- factor(pmc_nn_predicts$sulci, levels = c("pos", "prculs", "spls", "mcgs", "prcus-p", "prcus-i", "prcus-a", "ifrms"))
#pmc_nn_predicts <- pmc_nn_predicts %>%  rename(sulcal_depth_mm = depth_calcsulc_mm)
pmc_nn_predicts$type <- factor(pmc_nn_predicts$type, levels = c("prominent sulci", "less prominent sulci"))

# Means for plot
pmc_pred_avg <- pmc_nn_predicts %>% 
  group_by(sulci, type) %>% 
  summarise(dice = mean(dice))
pmc_pred_sd <- pmc_nn_predicts %>% 
  group_by(sulci, type) %>% 
  summarise(n=n(), sd=sd(dice), se=sd/sqrt(n))
pmc_pred_stats <- merge(pmc_pred_avg, pmc_pred_sd, by = c("sulci", "type"))

# Plot
dice_y <- expression(atop(bold("predictability"), paste(italic("(DICE coeff.)"))))

cnn_all.plot <- ggplot() +
  geom_col(data = pmc_pred_stats, aes(x = sulci, y = dice, fill = sulci), color = 'black',
              alpha = .6, position = dodge) +
  geom_jitter(data = pmc_nn_predicts, 
              aes(x = sulci, y = dice, fill = sulci, color = sulci), 
              alpha = .8, shape = 21,
              position=
                position_jitterdodge(jitter.width = 1.5, dodge.width = .9, jitter.height = 0)) +
  geom_errorbar(data = pmc_pred_stats, aes(sulci, ymin=dice-se, ymax=dice+se),
              width = .25, size = .75) +
  scale_x_discrete(breaks = c("pos", "prculs", "spls", "mcgs", "prcus-p", "prcus-i", "prcus-a", "ifrms"), 
                   labels = c("pos", "prculs", "spls", "mcgs", "prcus-p", "prcus-i", "prcus-a",
                            "ifrms")) +
scale_y_continuous(breaks=seq(0,1,.2)) + ylim(0,1) +
scale_color_manual(breaks = 
                       c("pos", "prculs", "prcus-p", "prcus-i", 
                         "prcus-a", "spls", "mcgs", "ifrms"),
                     values = c( "#252525","#252525", "#252525","#252525",
                                 "#252525","#252525","#252525", "#252525")) + 
  scale_fill_manual(breaks = c("pos", "prculs", "prcus-p", "prcus-i", 
                         "prcus-a", "spls", "mcgs", "ifrms"),
    values = c("#807dba", 
               "#cbc9e2", 
               "#31a354", 
               "darkolivegreen4", 
               "darkolivegreen2", 
               "#74c476", 
               "#41b6c4", 
               "#ef3b2c")) + 
  labs(x = "8 PCC and PrC sulci",
       y = dice_y) +
  guides(fill = F, color = F, alpha = F) +
  theme(plot.title = element_text(face = "bold", hjust = 0, size = 14), 
          plot.subtitle = element_text(size = 12),
          plot.caption = element_text(size = 12, hjust = 1),
          axis.title.x = element_text(size=20, face = "bold", vjust = .9),
          axis.title.y = element_text(size=20, face = "bold", vjust = .9),
          axis.title.y.right = element_text(size=20, face = "bold", vjust = 1),
          axis.text.x = element_text(size = 6, face = "bold", vjust = .70), # was 16 
          axis.text.y = element_text(size = 16, face = "bold"), # was 20
          legend.title = element_text(size=14), 
          legend.text = element_text(size=12),
          strip.text.x = element_text(size = 8, face = "bold"), # was 18
          strip.background = element_blank(),
          strip.placement = "outside",
          axis.line = element_line(colour = "black", linetype = "solid", lineend = "round")) +
  facet_grid(. ~ type, 
             scales = "free_x", space='free', switch="both")
cnn_all.plot

# ggplot2::ggsave(filename = "cnn_all_plot.png",
#                 plot = cnn_all.plot,
#                 device = "png",
#                 width = 10,
#                 height = 5, 
#                 units = "in",
#                 dpi = "retina")
```


# Supplementary Tables 

## Supplementary Table 1: Discovery incidence rates
```{r, warning = FALSE}
discovery_IR <- data.frame("sulcus" <- c("pos", "prculs", "prcus-p", "prcus-i", "prcus-a", 
                                         "spls", "sps", "mcgs", "sspls", "ifrms", "icgs-p" 
                                       ),
                      "LH count" <- c("36/36", "36/36", "36/36", "36/36", "36/36",
                                      "36/36", "35/36", "36/36", "23/36", "36/36", "19/36"
                           ),
                           "LH %" <- c(100, 100, 100, 100, 100,
                                       100, 97.22, 100, 63.89, 100, 52.78
                           ),
                           "RH count" <- c("36/36", "36/36", "36/36", "36/36", "36/36",
                                      "36/36", "34/36", "36/36", "18/36", "36/36", "23/36"
                      ),
                           "RH %" <- c(100, 100, 100, 100, 100,
                                       100, 94.44, 100, 50, 100, 63.89
                      )
                           )

names(discovery_IR)[1] <- "sulci"
names(discovery_IR)[2] <- "appearance in LH"
names(discovery_IR)[3] <- "LH %"
names(discovery_IR)[4] <- "appearance in RH"
names(discovery_IR)[5] <- "RH %"


discovery_IR_tab <- discovery_IR %>% gt() %>%
tab_header(
  title = md("**Supplementary Table 1**"),
  subtitle = md("*Incidence rates of PMC sulci in the discovery sample*")) %>%
tab_style(
    style = cell_text(style = "italic"),
    locations = cells_body(
      columns = c(1),
      rows = 1:11
    )) %>%
tab_source_note(md("*Note.* This table illustrates the incidence rates of the 8-11 definable PMC sulci in the *discovery* young adult sample (N = 36 participants). The incidence rate of each sulcus (posterior to anterior) is provided in number and percent for both the left (LH) and right hemispheres (RH). The abbreviations used are as follows: anterior precuneal sulcus (*prcus-a*); intermediate precuneal sulcus (*prcus-i*); inframarginal sulcus (*ifrms*); marginal ramus of the cingulate sulcus (*mcgs*); parieto-occipital sulcus (*pos*); posterior intracingulate sulcus (*icgs-p*); posterior precuneal sulcus (*prcus-p*); precuneal limiting sulcus (*prculs*); splenial sulcus (*spls*); subsplenial sulcus (*sspls*); superior parietal sulcus (*sps*).")) %>%
  tab_options(table.font.size = 20,
    heading.title.font.size = 20,
    heading.subtitle.font.size = 20,
    heading.align = "left",
    heading.border.bottom.color = 'black',
    table.border.top.color = "white",
    #column_labels.border.top.width = 3,
    column_labels.border.top.color = "black",
    #column_labels.border.bottom.width = 3,
    column_labels.border.bottom.color = "black",
    column_labels.vlines.color = "black",
    row_group.border.bottom.color = "black",
    row_group.border.top.color = "black",
    row_group.border.right.color = "black",
    stub.border.color = "black",
    table_body.border.bottom.color = "black",
    table_body.hlines.color = "black",
    table_body.vlines.color = "black",
    table.border.bottom.color = "white",
    table.width = pct(100),
    table.background.color = "white"
  ) %>%
  cols_align(align="center", columns = 1:5) %>%
  tab_style(
style = list(
      cell_borders(
        sides = c("top", "bottom"),
        color = "white",
        weight = px(1)
      ),
      cell_text(
        align="center"
      ),
      cell_fill(color = "white", alpha = NULL)
    ),
    locations = cells_body(
      columns = everything(),
      rows = everything()
    )
  ) %>%
  opt_table_font(font = google_font(name = "Times"))
#discovery_IR_tab #unmark to view

#gtsave(discovery_IR_tab, file = "Supp_Table_1_disc_IR.png")
```

## Supplementary Table 2: Replication incidence rates
```{r, warning = FALSE}
replication_IR <- data.frame("sulcus" <- c("pos", "prculs", "prcus-p", "prcus-i", "prcus-a", 
                                         "spls", "sps", "mcgs", "sspls", "ifrms", "icgs-p" 
                                       ),
                      "LH count" <- c("36/36", "36/36", "36/36", "36/36", "36/36",
                                      "36/36", "30/36", "36/36", "17/36", "36/36", "24/36"
                           ),
                           "LH %" <- c(100, 100, 100, 100, 100,
                                       100, 83.33, 100, 47.22, 100, 66.67
                           ),
                           "RH count" <- c("36/36", "36/36", "36/36", "36/36", "36/36",
                                      "36/36", "34/36", "36/36", "20/36", "36/36", "23/36"
                      ),
                           "RH %" <- c(100, 100, 100, 100, 100,
                                       100, 94.44, 100, 55.56, 100, 63.89
                      )
                           )

names(replication_IR)[1] <- "sulci"
names(replication_IR)[2] <- "appearance in LH"
names(replication_IR)[3] <- "LH %"
names(replication_IR)[4] <- "appearance in RH"
names(replication_IR)[5] <- "RH %"


replication_IR_tab <- replication_IR %>% gt() %>%
tab_header(
  title = md("**Supplementary Table 2**"),
  subtitle = md("*Incidence rates of PMC sulci in the replication sample*")) %>%
tab_style(
    style = cell_text(style = "italic"),
    locations = cells_body(
      columns = c(1),
      rows = 1:11
    )) %>%
tab_source_note(md("*Note.* This table illustrates the incidence rates of the 8-11 definable PMC sulci in the *replication* young adult sample (N = 36 participants). The incidence rate of each sulcus (posterior to anterior) is provided in number and percent for both the left (LH) and right hemispheres (RH). The abbreviations used are as follows: anterior precuneal sulcus (*prcus-a*); intermediate precuneal sulcus (*prcus-i*); inframarginal sulcus (*ifrms*); marginal ramus of the cingulate sulcus (*mcgs*); parieto-occipital sulcus (*pos*); posterior intracingulate sulcus (*icgs-p*); posterior precuneal sulcus (*prcus-p*); precuneal limiting sulcus (*prculs*); splenial sulcus (*spls*); subsplenial sulcus (*sspls*); superior parietal sulcus (*sps*).")) %>%
  tab_options(table.font.size = 20,
    heading.title.font.size = 20,
    heading.subtitle.font.size = 20,
    heading.align = "left",
    heading.border.bottom.color = 'black',
    table.border.top.color = "white",
    #column_labels.border.top.width = 3,
    column_labels.border.top.color = "black",
    #column_labels.border.bottom.width = 3,
    column_labels.border.bottom.color = "black",
    column_labels.vlines.color = "black",
    row_group.border.bottom.color = "black",
    row_group.border.top.color = "black",
    row_group.border.right.color = "black",
    stub.border.color = "black",
    table_body.border.bottom.color = "black",
    table_body.hlines.color = "black",
    table_body.vlines.color = "black",
    table.border.bottom.color = "white",
    table.width = pct(100),
    table.background.color = "white"
  ) %>%
  cols_align(align="center", columns = 1:5) %>%
  tab_style(
    style = list(
      cell_borders(
        sides = c("top", "bottom"),
        color = "white",
        weight = px(1)
      ),
      cell_text(
        align="center"
      ),
      cell_fill(color = "white", alpha = NULL)
    ),
    locations = cells_body(
      columns = everything(),
      rows = everything()
    )
  ) %>%
  opt_table_font(font = google_font(name = "Times"))
#replication_IR_tab #unmark to view

#gtsave(replication_IR_tab, file = "Supp_Table_2_repl_IR.png")
```

## Supplementary Table 3: Discovery Prcuneal Sulci 
```{r, warning = FALSE}
disc_prcus_types <- data.frame("mcst" <- c("LH (n=36)", "RH (n=36)", "LH (n=36)", "RH (n=36)", "LH (n=36)", "RH (n=36)"),
                              "1" <- c("spls", "spls",    "spls", "spls",    "spls", "spls"),
                              "percent" <- c(55.6, 41.7,   47.2, 61.1,        77.8, 58.3),
                              "2" <- c("free", "free",    "free", "prcus-a",    "prcus-i", "mcgs"),
                              "percent" <- c(36.1, 38.9,   38.9, 22.2,           13.9, 27.8),
                              "3" <- c("prcus-i", "prcus-i",  "prcus-p", "prcus-p","free", "prcus-i"),
                              "percent" <- c(13.9, 13.9,        13.9, 13.9,           11.1, 22.2))

names(disc_prcus_types)[1] <- "Sulci"
names(disc_prcus_types)[2] <- "First"
names(disc_prcus_types)[3] <- "first_percent"
names(disc_prcus_types)[4] <- "Second"
names(disc_prcus_types)[5] <- "second_percent"
names(disc_prcus_types)[6] <- "Third"
names(disc_prcus_types)[7] <- "third_percent"

disc_prcus_types_tab <- disc_prcus_types %>% gt() %>%
tab_header(
  title = md("**Supplementary Table 3**"),
  subtitle = md("*Most common intersections of the discovery sample's precuneal sulci*")) %>%
tab_row_group(
    group = "prcus-p",
    rows = 1:2) %>%
tab_row_group(
    group = "prcus-i",
    rows = 3:4) %>%
tab_row_group(
    group = "prcus-a",
    rows = 5:6) %>%
tab_style(
    style = cell_text(style = "italic"),
    locations = cells_body(
      columns = c(2,4,6),
      rows = 1:6
    )) %>%
cols_label(
    first_percent = "%",
    second_percent = "%",
    third_percent = "%") %>%
tab_source_note(md("*Note.* This table illustrates the different sulcal patterns, or types, of the three precuneal sulci (*prcus*) identified in the *discovery* young adult sample (N = 36 participants). For each sulcus, the top three most prevalent sulcal patterns and their percent of occurrence are provided for both the left (LH) and right hemispheres (RH). The incidence of each sulcus in this sample is also provided for each hemisphere for reference. The abbreviations used are as follows: anterior precuneal sulcus (*prcus-a*); intermediate precuneal sulcus (*prcus-i*); marginal ramus of the cingulate sulcus (*mcgs*); no intersections (*free*); posterior precuneal sulcus (*prcus-p*); splenial sulcus (*spls*).")) %>%
  tab_options(table.font.size = 20,
    heading.title.font.size = 20,
    heading.subtitle.font.size = 20,
    heading.align = "left",
    heading.border.bottom.color = 'black',
    table.border.top.color = "white",
    #column_labels.border.top.width = 3,
    column_labels.border.top.color = "black",
    #column_labels.border.bottom.width = 3,
    column_labels.border.bottom.color = "black",
    column_labels.vlines.color = "black",
    row_group.border.bottom.color = "black",
    row_group.border.top.color = "black",
    row_group.border.right.color = "black",
    stub.border.color = "black",
    table_body.border.bottom.color = "black",
    table_body.hlines.color = "black",
    table_body.vlines.color = "black",
    table.border.bottom.color = "white",
    table.width = pct(100),
    table.background.color = "white"
  ) %>%
  cols_align(align="center", columns = 1:7) %>%
  tab_style(
    style = list(
      cell_borders(
        sides = c("top", "bottom"),
        color = "white",
        weight = px(1)
      ),
      cell_text(
        align="center"
      ),
      cell_fill(color = "white", alpha = NULL)
    ),
    locations = cells_body(
      columns = everything(),
      rows = everything()
    )
  ) %>%
  opt_table_font(font = google_font(name = "Times"))
#disc_prcus_types_tab #unmark to view

#gtsave(disc_prcus_types_tab, file = "Supp_Table_3_disc_prc_types.png")
```

## Supplementary Table 4: Discovery Shallow PCC Sulci
```{r Table 2 setup, warning = FALSE}
disc_tert_types <- data.frame("mcst" <- c("LH (n=23)", "RH (n=18)", "LH (n=36)", "RH (n=36)", "LH (n=19)", "RH (n=23)"),
                "1" <- c("free", "free", "free", "free", "free", "free"),
                "percent" <- c(73.9, 77.8, 83.3, 80.6, 78.9, 95.7),
                "2" <- c("cas", "cas", "icgs-p", "spls", "ifrms", "mcgs"),
                "percent" <- c(26.1, 22.2, 8.3, 16.7, 15.8, 4.3),
                "3" <- c("---", "---", "mcgs", "mcgs", "mcgs", "---"),
                "percent" <- c(0, 0, 5.6, 2.8, 5.3, 0))

names(disc_tert_types)[1] <- "Sulci"
names(disc_tert_types)[2] <- "First"
names(disc_tert_types)[3] <- "first_percent"
names(disc_tert_types)[4] <- "Second"
names(disc_tert_types)[5] <- "second_percent"
names(disc_tert_types)[6] <- "Third"
names(disc_tert_types)[7] <- "third_percent"

disc_tert_types_tab <- disc_tert_types %>% gt() %>%
tab_header(
  title = md("**Supplementary Table 4**"),
  subtitle = md("*Most common intersections of the discovery sample's shallow PCC sulci*")) %>%
#tab_stubhead(label = md("Sulci")) %>%
tab_row_group(
    group = "sspls",
    rows = 1:2) %>%
tab_row_group(
    group = "ifrms",
    rows = 3:4) %>%
tab_row_group(
    group = "icgs-p",
    rows = 5:6) %>%
tab_style(
    style = cell_text(style = "italic"),
    locations = cells_body(
      columns = c(2,4,6),
      rows = 1:6
    )) %>%
cols_label(
    first_percent = "%",
    second_percent = "%",
    third_percent = "%") %>%
tab_source_note(md("*Note.* This table illustrates the different sulcal patterns, or types, of the three shallow PCC sulci identified in the *discovery* young adult sample (N = 36 participants). For each sulcus, the top three most prevalent sulcal patterns and their percent of occurrence are provided for both the left (LH) and right hemispheres (RH). The incidence of each sulcus in this sample is also provided for each hemisphere for reference. The abbreviations used are as follows: callosal sulcus (*cas*); inframarginal sulcus (*ifrms*); marginal ramus of the cingulate sulcus (*mcgs*); no intersections (*free*); no other option (---); posterior intracingulate sulcus (*icgs-p*); splenial sulcus (*spls*); subsplenial sulcus (*sspls*).")) %>%
  tab_options(table.font.size = 20,
    heading.title.font.size = 20,
    heading.subtitle.font.size = 20,
    heading.align = "left",
    heading.border.bottom.color = 'black',
    table.border.top.color = "white",
    #column_labels.border.top.width = 3,
    column_labels.border.top.color = "black",
    #column_labels.border.bottom.width = 3,
    column_labels.border.bottom.color = "black",
    column_labels.vlines.color = "black",
    row_group.border.bottom.color = "black",
    row_group.border.top.color = "black",
    row_group.border.right.color = "black",
    stub.border.color = "black",
    table_body.border.bottom.color = "black",
    table_body.hlines.color = "black",
    table_body.vlines.color = "black",
    table.border.bottom.color = "white",
    table.width = pct(100),
    table.background.color = "white"
  ) %>%
  cols_align(align="center", columns = 1:7) %>%
  tab_style(
    style = list(
      cell_borders(
        sides = c("top", "bottom"),
        color = "white",
        weight = px(1)
      ),
      cell_text(
        align="center"
      ),
      cell_fill(color = "white", alpha = NULL)
    ),
    locations = cells_body(
      columns = everything(),
      rows = everything()
    )
  ) %>%
  opt_table_font(font = google_font(name = "Times"))
#disc_tert_types_tab #unmark to view

#gtsave(disc_tert_types_tab, file = "Supp_Table_4_disc_shallow_types.png")
```

## Supplementary Table 5: Replication Prcuneal Sulci 
```{r, warning = FALSE}
rep_prcus_types <- data.frame("mcst" <- c("LH (n=36)", "RH (n=36)", "LH (n=36)", "RH (n=36)", "LH (n=36)", "RH (n=36)"),
                               "1" <- c("spls", "spls",    "spls", "spls",    "spls", "spls"),
                               "percent" <- c(55.6, 55.6,   63.9, 63.9,        83.3, 72.2),
                               "2" <- c("free", "free",    "prcus-a", "free",    "prcus-i", "prcus-i"),
                               "percent" <- c(33.3, 36.1,   22.2, 25.0,           22.2, 19.4),
                               "3" <- c("prcus-i", "prcus-i",  "free", "prcus-a",    "mcgs", "mcgs"),
                               "percent" <- c(13.9, 11.1,        22.2, 19.4,           13.9, 16.7))

names(rep_prcus_types)[1] <- "Sulci"
names(rep_prcus_types)[2] <- "First"
names(rep_prcus_types)[3] <- "first_percent"
names(rep_prcus_types)[4] <- "Second"
names(rep_prcus_types)[5] <- "second_percent"
names(rep_prcus_types)[6] <- "Third"
names(rep_prcus_types)[7] <- "third_percent"

rep_prcus_types_tab <- rep_prcus_types %>% gt() %>%
tab_header(
  title = md("**Supplementary Table 5**"),
  subtitle = md("*Most common intersections of the replication sample's precuneal sulci*")) %>%
tab_row_group(
    group = "prcus-p",
    rows = 1:2) %>%
tab_row_group(
    group = "prcus-i",
    rows = 3:4) %>%
tab_row_group(
    group = "prcus-a",
    rows = 5:6) %>%
tab_style(
    style = cell_text(style = "italic"),
    locations = cells_body(
      columns = c(2,4,6),
      rows = 1:6
    )) %>%
cols_label(
    first_percent = "%",
    second_percent = "%",
    third_percent = "%") %>%
tab_source_note(md("*Note.* This table illustrates the different sulcal patterns, or types, of the three precuneal sulci (*prcus*) identified in the *replication* young adult sample (N = 36 participants). For each sulcus, the top three most prevalent sulcal patterns and their percent of occurrence are provided for both the left (LH) and right hemispheres (RH). The incidence of each sulcus in this sample is also provided for each hemisphere for reference. The abbreviations used are as follows: anterior precuneal sulcus (*prcus-a*); intermediate precuneal sulcus (*prcus-i*); marginal ramus of the cingulate sulcus (*mcgs*); no intersections (*free*); posterior precuneal sulcus (*prcus-p*); splenial sulcus (*spls*).")) %>%
  tab_options(table.font.size = 20,
    heading.title.font.size = 20,
    heading.subtitle.font.size = 20,
    heading.align = "left",
    heading.border.bottom.color = 'black',
    table.border.top.color = "white",
    #column_labels.border.top.width = 3,
    column_labels.border.top.color = "black",
    #column_labels.border.bottom.width = 3,
    column_labels.border.bottom.color = "black",
    column_labels.vlines.color = "black",
    row_group.border.bottom.color = "black",
    row_group.border.top.color = "black",
    row_group.border.right.color = "black",
    stub.border.color = "black",
    table_body.border.bottom.color = "black",
    table_body.hlines.color = "black",
    table_body.vlines.color = "black",
    table.border.bottom.color = "white",
    table.width = pct(100),
    table.background.color = "white"
  ) %>%
  cols_align(align="center", columns = 1:7) %>%
  tab_style(
    style = list(
      cell_borders(
        sides = c("top", "bottom"),
        color = "white",
        weight = px(1)
      ),
      cell_text(
        align="center"
      ),
      cell_fill(color = "white", alpha = NULL)
    ),
    locations = cells_body(
      columns = everything(),
      rows = everything()
    )
  ) %>%
  opt_table_font(font = google_font(name = "Times"))
#rep_prcus_types_tab #unmark to view

#gtsave(rep_prcus_types_tab, file = "Supp_Table_5_repl_prc_types.png")
```

## Supplementary Table 6: Replication Shallow PCC Sulci 
```{r, warning = FALSE}
rep_tert_types <- data.frame("mcst" <- c("LH (n=17)", "RH (n=20)", "LH (n=36)", "RH (n=36)", "LH (n=24)", "RH (n=23)"),
                "$1^st$" <- c("free", "free", "free", "free", "free", "free"),
                "percent" <- c(76.5, 55.0, 66.7, 61.1, 87.5, 82.6),
                "$2^nd$" <- c("cas", "cas", "spls", "spls", "ifrms", "ifrms"),
                "percent" <- c(17.6, 40.0, 16.7, 25.0, 8.3, 8.7),
                "$3^rd$" <- c("spls", "spls", "mcgs", "mcgs", "mcgs", "cgs"),
                "percent" <- c(5.9, 5.0, 11.1, 8.3, 4.2, 8.7))

names(rep_tert_types)[1] <- "Sulci"
names(rep_tert_types)[2] <- "First"
names(rep_tert_types)[3] <- "first_percent"
names(rep_tert_types)[4] <- "Second"
names(rep_tert_types)[5] <- "second_percent"
names(rep_tert_types)[6] <- "Third"
names(rep_tert_types)[7] <- "third_percent"

rep_tert_types_tab <- rep_tert_types %>% gt() %>%
tab_header(
  title = md("**Supplementary Table 6**"),
  subtitle = md("*Most common intersections of the replication sample's shallow PCC sulci*")) %>%
#tab_stubhead(label = md("Sulci")) %>%
tab_row_group(
    group = "sspls",
    rows = 1:2) %>%
tab_row_group(
    group = "ifrms",
    rows = 3:4) %>%
tab_row_group(
    group = "icgs-p",
    rows = 5:6) %>%
tab_style(
    style = cell_text(style = "italic"),
    locations = cells_body(
      columns = c(2,4,6),
      rows = 1:6
    )) %>%
cols_label(
    first_percent = "%",
    second_percent = "%",
    third_percent = "%") %>%
tab_source_note(md("*Note.* This table illustrates the different sulcal patterns, or types, of the three shallow PCC sulci identified in the *replication* young adult sample (N = 36 participants). For each sulcus, the top three most prevalent sulcal patterns and their percent of occurrence are provided for both the left (LH) and right hemispheres (RH). The incidence of each sulcus in this sample is also provided for each hemisphere for reference. The abbreviations used are as follows: callosal sulcus (*cas*); cingulate sulcus (*cgs*); inframarginal sulcus (*ifrms*); marginal ramus of the cingulate sulcus (*mcgs*); no intersections (*free*); posterior intracingulate sulcus (*icgs-p*); splenial sulcus (*spls*); subsplenial sulcus (*sspls*).")) %>%
  tab_options(table.font.size = 20,
    heading.title.font.size = 20,
    heading.subtitle.font.size = 20,
    heading.align = "left",
    heading.border.bottom.color = 'black',
    table.border.top.color = "white",
    #column_labels.border.top.width = 3,
    column_labels.border.top.color = "black",
    #column_labels.border.bottom.width = 3,
    column_labels.border.bottom.color = "black",
    column_labels.vlines.color = "black",
    row_group.border.bottom.color = "black",
    row_group.border.top.color = "black",
    row_group.border.right.color = "black",
    stub.border.color = "black",
    table_body.border.bottom.color = "black",
    table_body.hlines.color = "black",
    table_body.vlines.color = "black",
    table.border.bottom.color = "white",
    table.width = pct(100),
    table.background.color = "white"
  ) %>%
  cols_align(align="center", columns = 1:7) %>%
  tab_style(
    style = list(
      cell_borders(
        sides = c("top", "bottom"),
        color = "white",
        weight = px(1)
      ),
      cell_text(
        align="center"
      ),
      cell_fill(color = "white", alpha = NULL)
    ),
    locations = cells_body(
      columns = everything(),
      rows = everything()
    )
  ) %>%
  opt_table_font(font = google_font(name = "Times"))
#rep_tert_types_tab #unmark to view

#gtsave(rep_tert_types_tab, file = "Supp_Table_6_repl_shallow_types.png")
```

## Supplementary Table 7 and 8: Locational coupling between the IFRMS and Control B network
```{r, warning = FALSE}
# Control B
discovery_replication_lg <- data.frame(
                "coordinate" <- c("right (LH)", "right (RH)", "anterior (LH)", "anterior (RH)", 
                                  "superior (LH)", "superior (RH)",
                                  
                                  "right (LH)", "right (RH)", "anterior (LH)", "anterior (RH)", 
                                  "superior (LH)", "superior (RH)"
                                  ),
                "df" <- c("1, 33", "1, 34", "1, 33", "1, 34", "1, 33", "1, 34",
                          
                          "1, 31", "1, 32", "1, 31", "1,32", "1, 31", "1, 32"
                          
                          ),
                "β" <- c(0.61, 0.5, 0.57, 0.44, 0.98, 0.74,
                         
                         0.77, 1.14, 0.4, 0.47, 0.82, 0.92
                         ),
                "standard error" <- c(0.16, 0.17, 0.11, 0.1, 0.1, 0.08,
                                      
                                      0.16, 0.39, 0.11, 0.16, 0.1, 0.09
                                      ), 
                "t" <- c(3.77, 2.87, 5.37, 4.46, 9.68, 9.65,
                        
                          4.96, 2.91, 3.71, 2.96, 8.29, 9.69
                         ),
                "p-value" <- c("<0.001", "0.007", "<0.001", "<0.001", "<0.001", "<0.001",
                               
                               "<0.001", "0.007", "0.001", "0.006", "<0.001", "<0.001"
                               ),
                "adjusted R^2" <- c(0.28, 0.17, 0.45, 0.35, 0.73, 0.72,
                                    
                                    0.42, 0.18, 0.29, 0.19, 0.68, 0.74
                                    ),
                "F" <- c(14.23, 8.23, 28.84, 19.91, 93.71, 93.04,
                         
                         24.61, 8.44, 13.77, 8.74, 68.8, 93.95
                         ),
                "Adjusted p-value" <- c("<0.001", "0.007", "<0.001", "<0.001", "<0.001", "<0.001",
                                        
                                        "<0.001", "0.007", "0.001", "0.006", "<0.001", "<0.001"
                                        )
                )

names(discovery_replication_lg)[1] <- "RAS coordinate"
names(discovery_replication_lg)[2] <- "df"
names(discovery_replication_lg)[3] <- "coefficient"
names(discovery_replication_lg)[4] <- "SE"
names(discovery_replication_lg)[5] <- "t value"
names(discovery_replication_lg)[6] <- "p_value"
names(discovery_replication_lg)[7] <- "adjusted_R2"
names(discovery_replication_lg)[8] <- "F-statistic"
names(discovery_replication_lg)[9] <- "adjusted_p_value"

discovery_replication_lg_tab <- discovery_replication_lg %>% gt() %>%
tab_header(
  title = md("<b>Supplementary Table 7</b>"),
  subtitle = md("<i>Regression analysis summary for ifrms location predicting CCN-b location<i/>")) %>%
  cols_label(
    coefficient = html("<i>β</i>"),
    adjusted_R2 = html("adjusted R<sup>2</sup>"),
    p_value = html("<i>p</i>-value"),
    adjusted_p_value = html("adjusted <i>p</i>-value")
    ) %>%
  tab_row_group(
    group = "replication",
    rows = 7:12) %>%
  tab_row_group(
    group = "discovery",
    rows = 1:6) %>%
tab_source_note(html("<i>Note.</i> This table provides the output of each linear regression run between each of the RAS (right, anterior, superior) coordinates of the inframarginal sulcus (<i>ifrms</i>; predictor variable) and cognitive control network B (CCN-b; outcome variable). A separate linear regression was run for each coordinate in each hemisphere (left (LH) and right (RH)) and sample (<i>discovery</i> and <i>replication</i>). The <i>p</i>-values presented in this table are FDR corrected for multiple comparisons. Exclusions: The LH of one participant in each sample was not included due to not having a CCN-b node near the <i>ifrms</i> and two participants from the <i>replication</i> sample were not included due to not having resting-state parcellations available. The other abbreviations used are as follows: degrees of freedom (df); regression beta coefficient (<i>β</i>); standard error (SE).")) %>%
  tab_options(table.font.size = 20,
    heading.title.font.size = 20,
    heading.subtitle.font.size = 20,
    heading.align = "left",
    heading.border.bottom.color = 'black',
    table.border.top.color = "white",
    column_labels.border.top.color = "black",
    column_labels.border.bottom.color = "black",
    column_labels.vlines.color = "black",
    row_group.border.bottom.color = "black",
    row_group.border.top.color = "black",
    row_group.border.right.color = "black",
    stub.border.color = "black",
    table_body.border.bottom.color = "black",
    table_body.hlines.color = "black",
    table_body.vlines.color = "black",
    table.border.bottom.color = "white",
    table.width = pct(100),
    table.background.color = "white"
  ) %>%
  cols_align(align="center", columns = 1:9) %>%
  tab_style(
    style = list(
      cell_borders(
        sides = c("top", "bottom"),
        color = "white",
        weight = px(1)
      ),
      cell_text(
        align="center"
      ),
      cell_fill(color = "white", alpha = NULL)
    ),
    locations = cells_body(
      columns = everything(),
      rows = everything()
    ) 
  ) %>%
  opt_table_font(font = google_font(name = "Times"))
#discovery_replication_lg_tab #unmark to view

#gtsave(discovery_replication_lg_tab, file = "Supp_Table_7_CCNb_lg.png")


# Control C
discovery_replication_lg_CCNc <- data.frame(
                "coordinate" <- c("right (LH)", "right (RH)", "anterior (LH)", "anterior (RH)", 
                                  "superior (LH)", "superior (RH)",
                                  
                                  "right (LH)", "right (RH)", "anterior (LH)", "anterior (RH)", 
                                  "superior (LH)", "superior (RH)"
                                  ),
                "df" <- c("1, 34", "1, 34", "1, 34", "1, 34", "1, 34", "1, 34",
                          
                          "1, 32", "1, 32", "1, 32", "1,32", "1, 32", "1, 32"
                          ),
                "coefficient" <- c(0.8, 0.32, 0.43, 0.3, 0.9, 0.71,
                                   
                                   0.56, 0.55, 0.32, 0.41, 0.81, 0.86
                                   ),
                "standard error" <- c(0.16, 0.09, 0.11, 0.09, 0.1, 0.08,
                                      
                                      0.09, 0.14, 0.1, 0.1, 0.09, 0.08
                                      ), 
                "t" <- c(5.07, 3.43, 3.87, 3.38, 8.69, 9.31,
                         
                         6.02, 3.82, 3.11, 4.02, 8.96, 10.24
                         ),
                "p-value" <- c("<0.001", "0.002", "<0.001", "0.002", "<0.001","<0.001",
                               
                               "<0.001", "<0.001", "0.004", "<0.001", "<0.001", "<0.001"
                               ),
                "adjusted R^2" <- c(0.41, 0.23, 0.28, 0.23, 0.68, 0.71,
                                    
                                    0.52, 0.29, 0.21, 0.32, 0.71, 0.76
                                    ),
                "F" <- c(25.75, 11.74, 14.94, 11.43, 75.47, 86.62,
                         
                         36.21, 14.62, 9.67, 16.19, 80.29, 104.9
                         ),
                "Adjusted p-value" <- c("<0.001", "0.002", "<0.001", "0.002", "<0.001", "<0.001",
                                        
                                        "<0.001", "<0.001", "0.004", "<0.001", "<0.001", "<0.001"
                                        )
                )

names(discovery_replication_lg_CCNc)[1] <- "RAS coordinate"
names(discovery_replication_lg_CCNc)[2] <- "df"
names(discovery_replication_lg_CCNc)[3] <- "coefficient"
names(discovery_replication_lg_CCNc)[4] <- "SE"
names(discovery_replication_lg_CCNc)[5] <- "t value"
names(discovery_replication_lg_CCNc)[6] <- "p_value"
names(discovery_replication_lg_CCNc)[7] <- "adjusted_R2"
names(discovery_replication_lg_CCNc)[8] <- "F-statistic"
names(discovery_replication_lg_CCNc)[9] <- "adjusted_p_value"

discovery_replication_lg_CCNc_tab <- discovery_replication_lg_CCNc %>% gt() %>%
tab_header(
  title = md("<b>Supplementary Table 8</b>"),
  subtitle = md("<i>Regression analysis summary for ifrms location predicting CCN-c location</i>")) %>%
  cols_label(
    coefficient = html("<i>β</i>"),
    adjusted_R2 = html("adjusted R<sup>2</sup>"),
    p_value = html("<i>p</i>-value"),
    adjusted_p_value = html("adjusted <i>p</i>-value")
    ) %>%
  tab_row_group(
    group = "replication",
    rows = 7:12) %>%
  tab_row_group(
    group = "discovery",
    rows = 1:6) %>%
tab_source_note(html("<i>Note.</i> This table provides the output of each linear regression run between each of the RAS (right, anterior, superior) coordinates of the inframarginal sulcus (<i>ifrms</i>; predictor variable) and cognitive control network C (CCN-c; outcome variable). A separate linear regression was run for each coordinate in each hemisphere (left (LH) and right (RH)) and sample (<i>discovery</i> and <i>replication</i>). The <i>p</i>-values presented in this table are FDR corrected for multiple comparisons. Exclusions: Two participants from the <i>replication</i> sample were not included due to not having resting-state parcellations available. The other abbreviations used are as follows: degrees of freedom (df); regression beta coefficient (<i>β</i>); standard error (SE).")) %>%
  tab_options(table.font.size = 20,
    heading.title.font.size = 20,
    heading.subtitle.font.size = 20,
    heading.align = "left",
    heading.border.bottom.color = 'black',
    table.border.top.color = "white",
    column_labels.border.top.color = "black",
    column_labels.border.bottom.color = "black",
    column_labels.vlines.color = "black",
    row_group.border.bottom.color = "black",
    row_group.border.top.color = "black",
    row_group.border.right.color = "black",
    stub.border.color = "black",
    table_body.border.bottom.color = "black",
    table_body.hlines.color = "black",
    table_body.vlines.color = "black",
    table.border.bottom.color = "white",
    table.width = pct(100),
    table.background.color = "white"
  ) %>%
  cols_align(align="center", columns = 1:9) %>%
  tab_style(
    style = list(
      cell_borders(
        sides = c("top", "bottom"),
        color = "white",
        weight = px(1)
      ),
      cell_text(
        align="center"
      ),
      cell_fill(color = "white", alpha = NULL)
    ),
    locations = cells_body(
      columns = everything(),
      rows = everything()
    )
  ) %>%
  opt_table_font(font = google_font(name = "Times"))
#discovery_replication_lg_CCNc_tab #unmark to view

#gtsave(discovery_replication_lg_CCNc_tab, file = "Supp_Table_8_CCNc_lg.png")
```

## Supplementary Table 9: NORA incidence rates
```{r, warning = FALSE}
nora_IR <- data.frame("sulcus" <- c("pos", "prculs", "prcus-p", "prcus-i", "prcus-a", 
                                         "spls", "sps", "mcgs", "sspls", "ifrms", "icgs-p" 
                                       ),
                      "LH count" <- c("72/72", "72/72", "72/72", "72/72", "72/72",
                                      "72/72", "64/72", "72/72", "38/72" , "72/72", "32/72"
                           ),
                           "LH %" <- c(100, 100, 100, 100, 100,
                                       100, 88.89, 100, 52.78, 100, 44.44
                           ),
                           "RH count" <- c("72/72", "72/72", "72/72", "72/72", "72/72",
                                      "72/72", "67/72", "72/72", "34/72" , "72/72", "36/72"
                      ),
                           "RH %" <- c(100, 100, 100, 100, 100,
                                       100, 93.06, 100, 47.22, 100, 50
                      )
                           )

names(nora_IR)[1] <- "sulci"
names(nora_IR)[2] <- "appearance in LH"
names(nora_IR)[3] <- "LH %"
names(nora_IR)[4] <- "appearance in RH"
names(nora_IR)[5] <- "RH %"


nora_IR_tab <- nora_IR %>% gt() %>%
tab_header(
  title = md("**Supplementary Table 9**"),
  subtitle = md("*Incidence rates of PMC sulci in the juvenile sample*")) %>%
tab_style(
    style = cell_text(style = "italic"),
    locations = cells_body(
      columns = c(1),
      rows = 1:11
    )) %>%
tab_source_note(md("*Note.* This table illustrates the incidence rates of the 8-11 definable PMC sulci in the juvenile sample (N = 72 participants). The incidence rate of each sulcus (posterior to anterior) is provided in number and percent for both the left (LH) and right hemispheres (RH). The abbreviations used are as follows: anterior precuneal sulcus (*prcus-a*); intermediate precuneal sulcus (*prcus-i*); inframarginal sulcus (*ifrms*); marginal ramus of the cingulate sulcus (*mcgs*); parieto-occipital sulcus (*pos*); posterior intracingulate sulcus (*icgs-p*); posterior precuneal sulcus (*prcus-p*); precuneal limiting sulcus (*prculs*); splenial sulcus (*spls*); subsplenial sulcus (*sspls*); superior parietal sulcus (*sps*).")) %>%
  tab_options(table.font.size = 20,
    heading.title.font.size = 20,
    heading.subtitle.font.size = 20,
    heading.align = "left",
    heading.border.bottom.color = 'black',
    table.border.top.color = "white",
    #column_labels.border.top.width = 3,
    column_labels.border.top.color = "black",
    #column_labels.border.bottom.width = 3,
    column_labels.border.bottom.color = "black",
    column_labels.vlines.color = "black",
    row_group.border.bottom.color = "black",
    row_group.border.top.color = "black",
    row_group.border.right.color = "black",
    stub.border.color = "black",
    table_body.border.bottom.color = "black",
    table_body.hlines.color = "black",
    table_body.vlines.color = "black",
    table.border.bottom.color = "white",
    table.width = pct(100),
    table.background.color = "white"
  ) %>%
  cols_align(align="center", columns = 1:5) %>%
  tab_style(
    style = list(
      cell_borders(
        sides = c("top", "bottom"),
        color = "white",
        weight = px(1)
      ),
      cell_text(
        align="center"
      ),
      cell_fill(color = "white", alpha = NULL)
    ),
    locations = cells_body(
      columns = everything(),
      rows = everything()
    )
  ) %>%
  opt_table_font(font = google_font(name = "Times"))
#nora_IR_tab #unmark to view

#gtsave(nora_IR_tab, file = "Supp_Table_9_nora_IR.png")
```

## Supplementary Table 10: ADNI incidence rates
```{r, warning = FALSE}
ADNI_IR <- data.frame("sulcus" <- c("pos", "prculs", "prcus-p", "prcus-i", "prcus-a", 
                                         "spls", "sps", "mcgs", "sspls", "ifrms", "icgs-p" 
                                       ),
                      "LH count" <- c("72/72", "72/72", "72/72", "72/72", "72/72",
                                      "72/72", "59/72", "72/72", "33/72" , "72/72", "27/72"
                           ),
                           "LH %" <- c(100, 100, 100, 100, 100,
                                       100, 81.94, 100, 45.83, 100, 37.5
                           ),
                           "RH count" <- c("72/72", "72/72", "72/72", "72/72", "72/72",
                                      "72/72", "55/72", "72/72", "32/72" , "72/72", "28/72"
                      ),
                           "RH %" <- c(100, 100, 100, 100, 100,
                                       100, 76.39, 100, 44.44, 100, 38.89
                      )
                           )

names(ADNI_IR)[1] <- "sulci"
names(ADNI_IR)[2] <- "appearance in LH"
names(ADNI_IR)[3] <- "LH %"
names(ADNI_IR)[4] <- "appearance in RH"
names(ADNI_IR)[5] <- "RH %"


ADNI_IR_tab <- ADNI_IR %>% gt() %>%
tab_header(
  title = md("**Supplementary Table 10**"),
  subtitle = md("*Incidence rates of PMC sulci in the healthy older adult sample*")) %>%
tab_style(
    style = cell_text(style = "italic"),
    locations = cells_body(
      columns = c(1),
      rows = 1:11
    )) %>%
tab_source_note(md("*Note.* This table illustrates the incidence rates of the 8-11 definable PMC sulci in the healhty older adult sample (N = 72 participants). The incidence rate of each sulcus (posterior to anterior) is provided in number and percent for both the left (LH) and right hemispheres (RH). The abbreviations used are as follows: anterior precuneal sulcus (*prcus-a*); intermediate precuneal sulcus (*prcus-i*); inframarginal sulcus (*ifrms*); marginal ramus of the cingulate sulcus (*mcgs*); parieto-occipital sulcus (*pos*); posterior intracingulate sulcus (*icgs-p*); posterior precuneal sulcus (*prcus-p*); precuneal limiting sulcus (*prculs*); splenial sulcus (*spls*); subsplenial sulcus (*sspls*); superior parietal sulcus (*sps*).")) %>%
  tab_options(table.font.size = 20,
    heading.title.font.size = 20,
    heading.subtitle.font.size = 20,
    heading.align = "left",
    heading.border.bottom.color = 'black',
    table.border.top.color = "white",
    #column_labels.border.top.width = 3,
    column_labels.border.top.color = "black",
    #column_labels.border.bottom.width = 3,
    column_labels.border.bottom.color = "black",
    column_labels.vlines.color = "black",
    row_group.border.bottom.color = "black",
    row_group.border.top.color = "black",
    row_group.border.right.color = "black",
    stub.border.color = "black",
    table_body.border.bottom.color = "black",
    table_body.hlines.color = "black",
    table_body.vlines.color = "black",
    table.border.bottom.color = "white",
    table.width = pct(100),
    table.background.color = "white"
  ) %>%
  cols_align(align="center", columns = 1:5) %>%
  tab_style(
    style = list(
      cell_borders(
        sides = c("top", "bottom"),
        color = "white",
        weight = px(1)
      ),
      cell_text(
        align="center"
      ),
      cell_fill(color = "white", alpha = NULL)
    ),
    locations = cells_body(
      columns = everything(),
      rows = everything()
    )
  ) %>%
  opt_table_font(font = google_font(name = "Times"))
#ADNI_IR_tab #unmark to view

#gtsave(ADNI_IR_tab, file = "Supp_Table_10_adni_IR.png")
```

## Supplementary Table 11: NORA Prcuneal Sulci
```{r, warning = FALSE}
nora_prcus_types <- data.frame("mcst" <- c("LH (n=72)", "RH (n=72)", "LH (n=72)", "RH (n=72)", "LH (n=72)", "RH (n=72)"),
                              "1" <- c("spls", "spls",    "spls", "spls",    "spls", "spls"),
                              "percent" <- c(55.6, 52.8,   68.1, 61.1,        79.2, 68.1),
                              "2" <- c("free", "free",    "prcus-a", "free",    "prcus-i", "prcus-i"),
                              "percent" <- c(33.3, 37.5,   22.2, 31.9,           19.4, 22.2),
                              "3" <- c("prcus-i", "prcus-i", "free", "prcus-a",    "mcgs", "free"),
                              "percent" <- c(15.3, 19.4,        20.8, 22.2,           9.7, 20.8))

names(nora_prcus_types)[1] <- "Sulci"
names(nora_prcus_types)[2] <- "First"
names(nora_prcus_types)[3] <- "first_percent"
names(nora_prcus_types)[4] <- "Second"
names(nora_prcus_types)[5] <- "second_percent"
names(nora_prcus_types)[6] <- "Third"
names(nora_prcus_types)[7] <- "third_percent"

nora_prcus_types_tab <- nora_prcus_types %>% gt() %>%
tab_header(
  title = md("**Supplementary Table 11**"),
  subtitle = md("*Most common intersections of the juvenile sample's precuneal sulci*")) %>%
tab_row_group(
    group = "prcus-p",
    rows = 1:2) %>%
tab_row_group(
    group = "prcus-i",
    rows = 3:4) %>%
tab_row_group(
    group = "prcus-a",
    rows = 5:6) %>%
tab_style(
    style = cell_text(style = "italic"),
    locations = cells_body(
      columns = c(2,4,6),
      rows = 1:6
    )) %>%
cols_label(
    first_percent = "%",
    second_percent = "%",
    third_percent = "%") %>%
tab_source_note(md("*Note.* This table illustrates the different sulcal patterns, or types, of the three precuneal sulci (*prcus*) identified in the juvenile sample (N = 72 participants). For each sulcus, the top three most prevalent sulcal patterns and their percent of occurrence are provided for both the left (LH) and right hemispheres (RH). The incidence of each sulcus in this sample is also provided for each hemisphere for reference. The abbreviations used are as follows: anterior precuneal sulcus (*prcus-a*); intermediate precuneal sulcus (*prcus-i*); marginal ramus of the cingulate sulcus (*mcgs*); no intersections (*free*); posterior precuneal sulcus (*prcus-p*); splenial sulcus (*spls*).")) %>%
  tab_options(table.font.size = 20,
    heading.title.font.size = 20,
    heading.subtitle.font.size = 20,
    heading.align = "left",
    heading.border.bottom.color = 'black',
    table.border.top.color = "white",
    #column_labels.border.top.width = 3,
    column_labels.border.top.color = "black",
    #column_labels.border.bottom.width = 3,
    column_labels.border.bottom.color = "black",
    column_labels.vlines.color = "black",
    row_group.border.bottom.color = "black",
    row_group.border.top.color = "black",
    row_group.border.right.color = "black",
    stub.border.color = "black",
    table_body.border.bottom.color = "black",
    table_body.hlines.color = "black",
    table_body.vlines.color = "black",
    table.border.bottom.color = "white",
    table.width = pct(100),
    table.background.color = "white"
  ) %>%
  cols_align(align="center", columns = 1:7) %>%
  tab_style(
    style = list(
      cell_borders(
        sides = c("top", "bottom"),
        color = "white",
        weight = px(1)
      ),
      cell_text(
        align="center"
      ),
      cell_fill(color = "white", alpha = NULL)
    ),
    locations = cells_body(
      columns = everything(),
      rows = everything()
    )
  ) %>%
  opt_table_font(font = google_font(name = "Times"))
#nora_prcus_types_tab #unmark to view

#gtsave(nora_prcus_types_tab, file = "Supp_Table_11_juv_prc_types.png")
```

## Supplementary Table 12: NORA Tertiary Sulci
```{r, warning = FALSE}
nora_tert_types <- data.frame("mcst" <- c("LH (n=38)", "RH (n=34)", "LH (n=72)", "RH (n=72)", "LH (n=32)", "RH (n=36)"),
                              "1" <- c("free", "free", "free", "free", "free", "free"),
                              "percent" <- c(78.9, 85.3, 80.6, 73.6, 75.0, 83.3),
                              "2" <- c("cas", "cas", "mcgs", "spls", "mcgs", "cgs"),
                              "percent" <- c(15.8, 11.8, 11.1, 18.1, 12.5, 11.1),
                              "3" <- c("spls", "spls", "spls", "mcgs", "cgs", "ifrms"),
                              "percent" <- c(5.3, 2.9, 8.3, 5.6, 9.4, 2.8))

names(nora_tert_types)[1] <- "Sulci"
names(nora_tert_types)[2] <- "First"
names(nora_tert_types)[3] <- "first_percent"
names(nora_tert_types)[4] <- "Second"
names(nora_tert_types)[5] <- "second_percent"
names(nora_tert_types)[6] <- "Third"
names(nora_tert_types)[7] <- "third_percent"

nora_tert_types_tab <- nora_tert_types %>% gt() %>%
tab_header(
  title = md("**Supplementary Table 12**"),
  subtitle = md("*Most common intersections of the juvenile sample's shallow PCC sulci*")) %>%
tab_row_group(
    group = "sspls",
    rows = 1:2) %>%
tab_row_group(
    group = "ifrms",
    rows = 3:4) %>%
tab_row_group(
    group = "icgs-p",
    rows = 5:6) %>%
tab_style(
    style = cell_text(style = "italic"),
    locations = cells_body(
      columns = c(2,4,6),
      rows = 1:6
    )) %>%
cols_label(
    first_percent = "%",
    second_percent = "%",
    third_percent = "%") %>%
tab_source_note(md("*Note.* This table illustrates the different sulcal patterns, or types, of the three shallow PCC sulci identified in the juvenile sample (N = 72 participants). For each sulcus, the top three most prevalent sulcal patterns and their percent of occurrence are provided for both the left (LH) and right hemispheres (RH). The incidence of each sulcus in this sample is also provided for each hemisphere for reference. The abbreviations used are as follows: callosal sulcus (*cas*); cingulate sulcus (*cgs*); inframarginal sulcus (*ifrms*); marginal ramus of the cingulate sulcus (*mcgs*); no intersections (*free*); posterior intracingulate sulcus (*icgs-p*); splenial sulcus (*spls*); subsplenial sulcus (*sspls*).")) %>%
  tab_options(table.font.size = 20,
    heading.title.font.size = 20,
    heading.subtitle.font.size = 20,
    heading.align = "left",
    heading.border.bottom.color = 'black',
    table.border.top.color = "white",
    #column_labels.border.top.width = 3,
    column_labels.border.top.color = "black",
    #column_labels.border.bottom.width = 3,
    column_labels.border.bottom.color = "black",
    column_labels.vlines.color = "black",
    row_group.border.bottom.color = "black",
    row_group.border.top.color = "black",
    row_group.border.right.color = "black",
    stub.border.color = "black",
    table_body.border.bottom.color = "black",
    table_body.hlines.color = "black",
    table_body.vlines.color = "black",
    table.border.bottom.color = "white",
    table.width = pct(100),
    table.background.color = "white"
  ) %>%
  cols_align(align="center", columns = 1:7) %>%
  tab_style(
    style = list(
      cell_borders(
        sides = c("top", "bottom"),
        color = "white",
        weight = px(1)
      ),
      cell_text(
        align="center"
      ),
      cell_fill(color = "white", alpha = NULL)
    ),
    locations = cells_body(
      columns = everything(),
      rows = everything()
    )
  ) %>%
  opt_table_font(font = google_font(name = "Times"))
#nora_tert_types_tab #unmark to view

#gtsave(nora_tert_types_tab, file = "Supp_Table_11_juv_shallow_types.png")
```

## Supplementary Table 13: ADNI Prcuneal Sulci
```{r, warning = FALSE}
adni_prcus_types <- data.frame("mcst" <- c("LH (n=72)", "RH (n=72)", "LH (n=72)", "RH (n=72)", "LH (n=72)", "RH (n=72)"),
                               "1" <- c("free", "spls",    "spls", "spls",    "spls", "spls"),
                               "percent" <- c(52.4, 56.9,   54.2, 52.8,        70.8, 75),
                               "2" <- c("spls", "free",    "free", "free",    "free", "free"),
                               "percent" <- c(44.4, 34.7,   30.6, 38.9,           20.8, 15.3),
                               "3" <- c("prcus-i", "prcus-i", "prcus-a", "prcus-p",    "prcus-i", "mcgs"),
                               "percent" <- c(6.9, 13.9,        9.7, 13.9,           9.7, 9.7))

names(adni_prcus_types)[1] <- "Sulci"
names(adni_prcus_types)[2] <- "First"
names(adni_prcus_types)[3] <- "first_percent"
names(adni_prcus_types)[4] <- "Second"
names(adni_prcus_types)[5] <- "second_percent"
names(adni_prcus_types)[6] <- "Third"
names(adni_prcus_types)[7] <- "third_percent"

adni_prcus_types_tab <- adni_prcus_types %>% gt() %>%
tab_header(
  title = md("**Supplementary Table 13**"),
  subtitle = md("*Most common intersections of the healthy older adult sample's precuneal sulci*")) %>%
tab_row_group(
    group = "prcus-p",
    rows = 1:2) %>%
tab_row_group(
    group = "prcus-i",
    rows = 3:4) %>%
tab_row_group(
    group = "prcus-a",
    rows = 5:6) %>%
tab_style(
    style = cell_text(style = "italic"),
    locations = cells_body(
      columns = c(2,4,6),
      rows = 1:6
    )) %>%
cols_label(
    first_percent = "%",
    second_percent = "%",
    third_percent = "%") %>%
tab_source_note(md("*Note.* This table illustrates the different sulcal patterns, or types, of the three precuneal sulci (*prcus*) identified in the healthy older adult sample (N = 72 participants). For each sulcus, the top three most prevalent sulcal patterns and their percent of occurrence are provided for both the left (LH) and right hemispheres (RH). The incidence of each sulcus in this sample is also provided for each hemisphere for reference. The abbreviations used are as follows: anterior precuneal sulcus (*prcus-a*); intermediate precuneal sulcus (*prcus-i*); marginal ramus of the cingulate sulcus (*mcgs*); no intersections (*free*); posterior precuneal sulcus (*prcus-p*); splenial sulcus (*spls*).")) %>%
  tab_options(table.font.size = 20,
    heading.title.font.size = 20,
    heading.subtitle.font.size = 20,
    heading.align = "left",
    heading.border.bottom.color = 'black',
    table.border.top.color = "white",
    #column_labels.border.top.width = 3,
    column_labels.border.top.color = "black",
    #column_labels.border.bottom.width = 3,
    column_labels.border.bottom.color = "black",
    column_labels.vlines.color = "black",
    row_group.border.bottom.color = "black",
    row_group.border.top.color = "black",
    row_group.border.right.color = "black",
    stub.border.color = "black",
    table_body.border.bottom.color = "black",
    table_body.hlines.color = "black",
    table_body.vlines.color = "black",
    table.border.bottom.color = "white",
    table.width = pct(100),
    table.background.color = "white"
  ) %>%
  cols_align(align="center", columns = 1:7) %>%
  tab_style(
    style = list(
      cell_borders(
        sides = c("top", "bottom"),
        color = "white",
        weight = px(1)
      ),
      cell_text(
        align="center"
      ),
      cell_fill(color = "white", alpha = NULL)
    ),
    locations = cells_body(
      columns = everything(),
      rows = everything()
    )
  ) %>%
  opt_table_font(font = google_font(name = "Times"))
#adni_prcus_types_tab #unmark to view

#gtsave(adni_prcus_types_tab, file = "Supp_Table_13_oa_prc_types.png")
```

## Supplementary Table 14: ADNI Tertiary Sulci
```{r, warning = FALSE}
adni_tert_types <- data.frame("mcst" <- c("LH (n=33)", "RH (n=32)", "LH (n=72)", "RH (n=72)", "LH (n=27)", "RH (n=28)"),
                              "1" <- c("free", "free", "free", "free", "free", "free"),
                              "percent" <- c(69.7, 87.5, 80.6, 77.8, 88.9, 82.1),
                              "2" <- c("cas", "cas", "mcgs", "spls", "mcgs", "mcgs"),
                              "percent" <- c(21.2, 9.4, 9.7, 13.9, 3.7, 10.7),
                              "3" <- c("spls", "spls", "spls", "mcgs", "cas", "cgs"),
                              "percent" <- c(9.1, 3.1, 6.9, 4.2, 3.7, 7.1))

names(adni_tert_types)[1] <- "Sulci"
names(adni_tert_types)[2] <- "First"
names(adni_tert_types)[3] <- "first_percent"
names(adni_tert_types)[4] <- "Second"
names(adni_tert_types)[5] <- "second_percent"
names(adni_tert_types)[6] <- "Third"
names(adni_tert_types)[7] <- "third_percent"

adni_tert_types_tab <- adni_tert_types %>% gt() %>%
tab_header(
  title = md("**Supplementary Table 14**"),
  subtitle = md("*Most common intersections of the healthy older adult sample's shallow PCC sulci*")) %>%
tab_row_group(
    group = "sspls",
    rows = 1:2) %>%
tab_row_group(
    group = "ifrms",
    rows = 3:4) %>%
tab_row_group(
    group = "icgs-p",
    rows = 5:6) %>%
tab_style(
    style = cell_text(style = "italic"),
    locations = cells_body(
      columns = c(2,4,6),
      rows = 1:6
    )) %>%
cols_label(
    first_percent = "%",
    second_percent = "%",
    third_percent = "%") %>%
tab_source_note(md("*Note.* This table illustrates the different sulcal patterns, or types, of the three shallow PCC sulci identified in the healthy older adult sample (N = 72 participants). For each sulcus, the top three most prevalent sulcal patterns and their percent of occurrence are provided for both the left (LH) and right hemispheres (RH). The incidence of each sulcus in this sample is also provided for each hemisphere for reference. The abbreviations used are as follows: callosal sulcus (*cas*); cingulate sulcus (*cgs*); inframarginal sulcus (*ifrms*); marginal ramus of the cingulate sulcus (*mcgs*); no intersections (*free*); posterior intracingulate sulcus (*icgs-p*); splenial sulcus (*spls*); subsplenial sulcus (*sspls*).")) %>%
  tab_options(table.font.size = 20,
    heading.title.font.size = 20,
    heading.subtitle.font.size = 20,
    heading.align = "left",
    heading.border.bottom.color = 'black',
    table.border.top.color = "white",
    #column_labels.border.top.width = 3,
    column_labels.border.top.color = "black",
    #column_labels.border.bottom.width = 3,
    column_labels.border.bottom.color = "black",
    column_labels.vlines.color = "black",
    row_group.border.bottom.color = "black",
    row_group.border.top.color = "black",
    row_group.border.right.color = "black",
    stub.border.color = "black",
    table_body.border.bottom.color = "black",
    table_body.hlines.color = "black",
    table_body.vlines.color = "black",
    table.border.bottom.color = "white",
    table.width = pct(100),
    table.background.color = "white"
  ) %>%
  cols_align(align="center", columns = 1:7) %>%
  tab_style(
    style = list(
      cell_borders(
        sides = c("top", "bottom"),
        color = "white",
        weight = px(1)
      ),
      cell_text(
        align="center"
      ),
      cell_fill(color = "white", alpha = NULL)
    ),
    locations = cells_body(
      columns = everything(),
      rows = everything()
    )
  ) %>%
  opt_table_font(font = google_font(name = "Times"))
#adni_tert_types_tab #unmark to view

#gtsave(adni_tert_types_tab, file = "Supp_Table_14_oa_shallow_types.png")
```

## Supplementary Table 15: Depth of PMC sulci between age groups
```{r}
dev_depth_stats.tab <- dev_depth_stats %>% select(c("label", "group_hemi", "sulcal_depth_mm", "sd")) 
dev_depth_stats.tab <- dev_depth_stats.tab %>% mutate_at(3:4, round, 2)
dev_depth_stats.tab <- dev_depth_stats.tab %>%
  mutate(label = fct_relevel(label, c("pos", "prculs", "prcus-p", "prcus-i", "prcus-a",
                                      "sps", "spls", "mcgs", "sspls", "ifrms", "icgs-p")), 
         group_hemi = fct_relevel(group_hemi, c("j lh", "ya lh", "oa lh", "j rh", "ya rh", "oa rh"))) %>% 
  arrange(label) %>%
  arrange(group_hemi) %>% 
  gt(groupname_col = 'label',
     rowname_col = 'group_hemi') %>%
tab_header(
  title = md("**Supplementary Table 15**"),
  subtitle = md("*Mean ± sd depth of each PMC sulcus between human age groups*")) %>%
  cols_label(
    label = "sulcus",
    group_hemi = "group & hemi",
    sulcal_depth_mm = "mean") %>%
tab_style(
    style = cell_text(style = "italic"),
    locations = cells_body(
      columns = c(1),
      rows = 1:66
    )) %>%
tab_source_note(md("*Note.* Depth values are in millimeters. Abbreviations are as follows: juvenile (j), young adult (ya), older adult (oa), left hemisphere (lh), right hemisphere (rh)")) %>%
  tab_options(table.font.size = 20,
    heading.title.font.size = 20,
    heading.subtitle.font.size = 20,
    heading.align = "left",
    heading.border.bottom.color = 'black',
    table.border.top.color = "white",
    #column_labels.border.top.width = 3,
    column_labels.border.top.color = "black",
    #column_labels.border.bottom.width = 3,
    column_labels.border.bottom.color = "black",
    column_labels.vlines.color = "black",
    row_group.border.bottom.color = "black",
    row_group.border.top.color = "black",
    row_group.border.right.color = "black",
    stub.border.color = "black",
    table_body.border.bottom.color = "black",
    table_body.hlines.color = "black",
    table_body.vlines.color = "black",
    table.border.bottom.color = "white",
    table.width = pct(100),
    table.background.color = "white"
  ) %>%
  cols_align(align="center", columns = 1:4) %>%
  tab_style(
    style = list(
      cell_borders(
        sides = c("top", "bottom"),
        color = "white",
        weight = px(1)
      ),
      cell_text(
        align="center"
      ),
      cell_fill(color = "white", alpha = NULL)
    ),
    locations = cells_body(
      columns = everything(),
      rows = everything()
    )
  ) %>%
  opt_table_font(font = google_font(name = "Times"))

#dev_depth_stats.tab #unmark to view

#gtsave(dev_depth_stats.tab, file = "Supp_Table_15_dev_depth_stats.tab.png")
```

## Supplementary Table 16: Surface Area of PMC sulci between age groups 
```{r, warning = FALSE}
# Table
dev_all_morphology_sa_means <- development_all_morphology %>% 
  group_by(label, group_hemi) %>% 
  summarise(total_surface_area_.mm.2. = mean(total_surface_area_.mm.2.))
dev_all_morphology_sa_sd <- development_all_morphology %>% 
  group_by(label, group_hemi) %>% 
  summarise(sd = sd(total_surface_area_.mm.2.),
            n = n(),
            se = sd/sqrt(n))
dev_all_morphology_sa_stats <- merge(dev_all_morphology_sa_means, dev_all_morphology_sa_sd, 
                                                by = c("label", "group_hemi"))

dev_all_morphology_sa_stats.tab <- dev_all_morphology_sa_stats %>% select(c("label", "group_hemi", "total_surface_area_.mm.2.", "sd")) 
dev_all_morphology_sa_stats.tab <- dev_all_morphology_sa_stats.tab %>% mutate_at(3:4, round, 2)

dev_all_morphology_sa_stats.tab <- dev_all_morphology_sa_stats.tab %>%
  mutate(label = fct_relevel(label, c("pos", "prculs", "prcus-p", "prcus-i", "prcus-a",
                                      "sps", "spls", "mcgs", "sspls", "ifrms", "icgs-p")), 
         group_hemi = fct_relevel(group_hemi, c("j lh", "ya lh", "oa lh", "j rh", "ya rh", "oa rh"))) %>% 
  arrange(label) %>%
  arrange(group_hemi) %>% 
  gt(groupname_col = 'label',
     rowname_col = 'group_hemi') %>%
tab_header(
  title = md("**Supplementary Table 16**"),
  subtitle = md("*Mean ± sd surface area of each PMC sulcus between human age groups*")) %>%
  cols_label(
    label = "sulcus",
    group_hemi = "group & hemi",
    total_surface_area_.mm.2. = "mean") %>%
tab_style(
    style = cell_text(style = "italic"),
    locations = cells_body(
      columns = c(1),
      rows = 1:66
    )) %>%
tab_source_note(md("*Note.* Surface area values are in squared millimeters. Abbreviations are as follows: juvenile (j), young adult (ya), older adult (oa), left hemisphere (lh), right hemisphere (rh).")) %>%
  tab_options(table.font.size = 20,
    heading.title.font.size = 20,
    heading.subtitle.font.size = 20,
    heading.align = "left",
    heading.border.bottom.color = 'black',
    table.border.top.color = "white",
    #column_labels.border.top.width = 3,
    column_labels.border.top.color = "black",
    #column_labels.border.bottom.width = 3,
    column_labels.border.bottom.color = "black",
    column_labels.vlines.color = "black",
    row_group.border.bottom.color = "black",
    row_group.border.top.color = "black",
    row_group.border.right.color = "black",
    stub.border.color = "black",
    table_body.border.bottom.color = "black",
    table_body.hlines.color = "black",
    table_body.vlines.color = "black",
    table.border.bottom.color = "white",
    table.width = pct(100),
    table.background.color = "white"
  ) %>%
  cols_align(align="center", columns = 1:4) %>%
  tab_style(
    style = list(
      cell_borders(
        sides = c("top", "bottom"),
        color = "white",
        weight = px(1)
      ),
      cell_text(
        align="center"
      ),
      cell_fill(color = "white", alpha = NULL)
    ),
    locations = cells_body(
      columns = everything(),
      rows = everything()
    )
  ) %>%
  opt_table_font(font = google_font(name = "Times"))

#dev_all_morphology_sa_stats.tab #unmark to view

#gtsave(dev_all_morphology_sa_stats.tab, file = "Supp_Table_16_dev_sa_stats.tab.png")
```

## Supplementary Table 17: Cortical Thickness of PMC sulci between age groups 
```{r, warning = FALSE}
dev_ct_stats.tab <- dev_ct_stats %>% select(c("label", "group_hemi", "cortical_thickness_mean", "sd")) 
dev_ct_stats.tab <- dev_ct_stats.tab %>% mutate_at(3:4, round, 2)
dev_ct_stats.tab <- dev_ct_stats.tab %>%
  mutate(label = fct_relevel(label, c("pos", "prculs", "prcus-p", "prcus-i", "prcus-a",
                                      "sps", "spls", "mcgs", "sspls", "ifrms", "icgs-p")), 
         group_hemi = fct_relevel(group_hemi, c("j lh", "ya lh", "oa lh", "j rh", "ya rh", "oa rh"))) %>% 
  arrange(label) %>%
  arrange(group_hemi) %>% 
  gt(groupname_col = 'label',
     rowname_col = 'group_hemi') %>%
tab_header(
  title = md("**Supplementary Table 17**"),
  subtitle = md("*Mean ± sd cortical thickness of each PMC sulcus between human age groups*")) %>%
  cols_label(
    label = "sulcus",
    group_hemi = "group & hemi",
    cortical_thickness_mean = "mean") %>%
tab_style(
    style = cell_text(style = "italic"),
    locations = cells_body(
      columns = c(1),
      rows = 1:66
    )) %>%
tab_source_note(md("*Note.* Cortical thickness values are in millimeters. Abbreviations are as follows: juvenile (j), young adult (ya), older adult (oa), left hemisphere (lh), right hemisphere (rh)")) %>%
  tab_options(table.font.size = 20,
    heading.title.font.size = 20,
    heading.subtitle.font.size = 20,
    heading.align = "left",
    heading.border.bottom.color = 'black',
    table.border.top.color = "white",
    #column_labels.border.top.width = 3,
    column_labels.border.top.color = "black",
    #column_labels.border.bottom.width = 3,
    column_labels.border.bottom.color = "black",
    column_labels.vlines.color = "black",
    row_group.border.bottom.color = "black",
    row_group.border.top.color = "black",
    row_group.border.right.color = "black",
    stub.border.color = "black",
    table_body.border.bottom.color = "black",
    table_body.hlines.color = "black",
    table_body.vlines.color = "black",
    table.border.bottom.color = "white",
    table.width = pct(100),
    table.background.color = "white"
  ) %>%
  cols_align(align="center", columns = 1:4) %>%
  tab_style(
    style = list(
      cell_borders(
        sides = c("top", "bottom"),
        color = "white",
        weight = px(1)
      ),
      cell_text(
        align="center"
      ),
      cell_fill(color = "white", alpha = NULL)
    ),
    locations = cells_body(
      columns = everything(),
      rows = everything()
    )
  ) %>%
  opt_table_font(font = google_font(name = "Times"))

#dev_ct_stats.tab #unmark to view

#gtsave(dev_ct_stats.tab, file = "Supp_Table_17_dev_ct_stats.tab.png")
```

## Supplementary Table 18: ADNI Scanning Parameters 
```{r, warning = FALSE}
adni_scanning <- data.frame("participants" <- c(26, 8, 6, 6, 
                                                5, 5, 4, 2,
                                                2, 1, 1, 1,
                                                1, 1, 1, 1,
                                                1),
                               "scanner" <- c("Siemens", "Siemens", "Philips", "GE",
                                              "Philips", "Siemens", "GE", "Siemens",
                                              "GE", "Philips", "Philips", "Philips",
                                              "GE", "GE", "GE", "GE",
                                              "Siemens"),
                               "magnetic field strength (T)" <- c("3", "3", "3", "1.5",
                                            "3", "3", "1.5", "1.5",
                                            "1.5", "3", "1.5", "1.5",
                                            "1.5", "1.5", "1.5", "3",
                                            "1.5"),
                               "TR (ms)" <- c(2300, 2300, 6.5, 8.6,
                                              6.8, 2300, 8.9, 2400,
                                              9.2, 6.8, 8.6, 8.5,
                                              9.2, 9.1, 7.0, 7.0,
                                              3000
                                              ),
                               "TE (ms)" <- c(3.0, 3.0, 2.9, 3.8,
                                              3.2, 3.0, 3.9, 3.5,
                                              4.1, 3.1, 4.0, 4.0,
                                              4.0, 4.0, 3.9, 3.0,
                                              3.6
                                              ),
              "voxel_size" <- c("1 x 1 x 1", "1.1 x 1.1 x 1.2", "1 x 1 x 1", "0.9 x 0.9 x 1.2",
                               "1 x 1 x 1.2", "1 x 1 x 1.2", "0.9 x 0.9 x 1.2", "1.3 x 1.3 x 1.2",
                        "0.9 x 0.9 x 1.2", "1 x 1 x 1.2", "0.9 x 0.9 x 1.2", "0.9 x 0.9 x 1.2",
                       "0.9 x 0.9 x 1.2", "0.9 x 0.9 x 1.2", "0.9 x 0.9 x 1.2", "1 x 1 x 1.2",
                                          "1.3 x 1.3 x 1.2")
                               )

names(adni_scanning)[1] <- "participants"
names(adni_scanning)[2] <- "scanner manufacturer"
names(adni_scanning)[3] <- "magnetic field strength (T)"
names(adni_scanning)[4] <- "TR (ms)"
names(adni_scanning)[5] <- "TE (ms)"
names(adni_scanning)[6] <- "voxel_size"
#adni_scanning

adni_scanning_tab <- adni_scanning %>% gt() %>%
tab_header(
  title = html("<b>Supplementary Table 18</b>"),
  subtitle = html("<i>Scanning parameters of the healthy older adult participants<i/>")) %>%
 
  cols_label(
    voxel_size = html("voxel size (mm<sup>3</sup>)") 
    ) %>%
tab_source_note(html("<i>Note.</i> This table illustrates the different scanning parameters used for each of our randomly-selected, healthy older adult participants from the Alzheimer's Disease Neuroimaging Initiative (ADNI) online database (http://adni.loni.usc.edu). For each different set of parameters, the number of participants, scanner manufacturer, magnetic field strength in Teslas (T), repetition time (TR) in ms, time to echo (TE) in ms, and voxel size in mm<sup>3</sup> are provided.")) %>%
  tab_options(table.font.size = 20,
    heading.title.font.size = 20,
    heading.subtitle.font.size = 20,
    heading.align = "left",
    heading.border.bottom.color = 'black',
    table.border.top.color = "white",
    #column_labels.border.top.width = 3,
    column_labels.border.top.color = "black",
    #column_labels.border.bottom.width = 3,
    column_labels.border.bottom.color = "black",
    column_labels.vlines.color = "black",
    row_group.border.bottom.color = "black",
    row_group.border.top.color = "black",
    row_group.border.right.color = "black",
    stub.border.color = "black",
    table_body.border.bottom.color = "black",
    table_body.hlines.color = "black",
    table_body.vlines.color = "black",
    table.border.bottom.color = "white",
    table.width = pct(100),
    table.background.color = "white"
  ) %>%
  cols_align(align="center", columns = 1:6) %>%
  tab_style(
    style = list(
      cell_borders(
        sides = c("top", "bottom"),
        color = "white",
        weight = px(1)
      ),
      cell_text(
        align="center"
      ),
      cell_fill(color = "white", alpha = NULL)
    ),
    locations = cells_body(
      columns = everything(),
      rows = everything()
    )
  ) %>%
  opt_table_font(font = google_font(name = "Times"))
#adni_scanning_tab #unmark to view

#gtsave(adni_scanning_tab, file = "Supp_Table_18_ADNI.png")
```

